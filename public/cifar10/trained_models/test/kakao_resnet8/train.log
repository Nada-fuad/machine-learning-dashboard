[2024-05-16 18:06:40,371][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:06:40,469][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:06:40,470][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:06:40,472][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:06:40,472][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:06:40,472][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:06:40,473][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:06:40,473][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:06:40,473][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:06:40,473][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:06:40,474][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:06:40,474][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8
[2024-05-16 18:06:40,474][hannah.utils.utils][INFO] -   
[2024-05-16 18:06:40,475][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:06:40,476][root][INFO] - Configuration: 
[2024-05-16 18:06:40,480][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 2048
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:06:40,480][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:06:40,996][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:06:40,996][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:06:41,051][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:06:41,075][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:06:41,082][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:06:41,082][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:06:41,082][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:06:41,082][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:06:41,082][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:06:41,082][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:06:41,082][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:06:41,082][root][INFO] - Starting training
[2024-05-16 18:06:46,352][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:06:46,352][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:06:46,830][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 50000
[2024-05-16 18:06:46,830][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:06:46,900][hannah.modules.vision.base][INFO] -   Dev Set: 10000
[2024-05-16 18:06:46,969][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:06:47,961][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:06:47,982][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.4914, 0.4822, 0.4465), std: (0.2023, 0.1994, 0.201)
[2024-05-16 18:06:47,988][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:06:47,994][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:06:48,005][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:06:49,218][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (24) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.

[2024-05-16 18:06:49,405][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:06:50,893][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:06:50,893][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:06:50,893][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:06:50,893][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:06:50,893][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:06:51,469][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:07:01,306][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 24: 'val_error' reached 0.78772 (best 0.78772), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=24.ckpt' as top 1
[2024-05-16 18:07:01,768][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:07:11,628][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 48: 'val_error' reached 0.64014 (best 0.64014), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=1-step=48.ckpt' as top 1
[2024-05-16 18:07:12,102][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:07:22,153][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 72: 'val_error' reached 0.57617 (best 0.57617), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=2-step=72.ckpt' as top 1
[2024-05-16 18:07:22,628][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:07:32,466][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 96: 'val_error' was not in top 1
[2024-05-16 18:07:32,910][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:07:43,002][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 120: 'val_error' reached 0.44641 (best 0.44641), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=4-step=120.ckpt' as top 1
[2024-05-16 18:07:43,475][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:07:53,289][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 144: 'val_error' reached 0.38049 (best 0.38049), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=5-step=144.ckpt' as top 1
[2024-05-16 18:07:53,759][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:07:59,171][root][ERROR] - Exception Message: 'NoneType' object has no attribute '_invalidate_flags_cache'
    full_key: 
    object_type=None
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
    self.fit_loop.run()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
    self.advance()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
    self.advance(data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 250, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 190, in run
    self._optimizer_step(batch_idx, closure)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 268, in _optimizer_step
    call._call_lightning_module_hook(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/core/module.py", line 1303, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/core/optimizer.py", line 152, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 239, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/plugins/precision/amp.py", line 80, in optimizer_step
    closure_result = closure()
                     ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 144, in __call__
    self._result = self.closure(*args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 129, in closure
    step_output = self._step_fn()
                  ^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 318, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 391, in training_step
    return self.lightning_module.training_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/image_classifier.py", line 115, in training_step
    loss, _, _, _ = self.common_step("train", batch_labeled, batch_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/image_classifier.py", line 59, in common_step
    augmented_data, x = self.augment(x, labels, boxes, batch_idx)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 248, in augment
    augmented_data = self.default_augmentation(images)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/augmentation/batch_augmentation.py", line 57, in forward
    result = self.transforms(x)
             ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/base.py", line 210, in forward
    output = self.apply_func(in_tensor, params, flags)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/_2d/base.py", line 129, in apply_func
    output = self.transform_inputs(in_tensor, params, flags, trans_matrix)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/base.py", line 261, in transform_inputs
    output = self.apply_transform(in_tensor, params, flags, transform=transform)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/_2d/geometric/crop.py", line 203, in apply_transform
    return crop_by_indices(input, params["src"], flags["size"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/geometry/transform/crop2d.py", line 344, in crop_by_indices
    if _out.shape[-2:] != size:
       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 523, in __ne__
    x = self.__eq__(other)
        ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 514, in __eq__
    other = ListConfig(other, flags={"allow_objects": True})
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 82, in __init__
    format_and_raise(node=None, key=key, value=None, cause=ex, msg=str(ex))
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/_utils.py", line 899, in format_and_raise
    _raise(ex, cause)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/_utils.py", line 797, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set env var OC_CAUSE=1 for full trace
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 80, in __init__
    self._set_value(value=content, flags=flags)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 618, in _set_value
    raise e
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 614, in _set_value
    self._set_value_impl(value, flags)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 657, in _set_value_impl
    with flag_override(self, ["struct", "readonly"], False):
  File "/usr/lib64/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/omegaconf.py", line 968, in flag_override
    config._set_flag(names, prev_states)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/base.py", line 178, in _set_flag
    self._invalidate_flags_cache()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/base.py", line 790, in _invalidate_flags_cache
    item._invalidate_flags_cache()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute '_invalidate_flags_cache'
    full_key: 
    object_type=None
[2024-05-16 18:08:20,590][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:08:20,686][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:08:20,686][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:08:20,689][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:08:20,689][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:08:20,689][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:08:20,689][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:08:20,689][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:08:20,690][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:08:20,690][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:08:20,691][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:08:20,691][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1]
[2024-05-16 18:08:20,691][hannah.utils.utils][INFO] -   
[2024-05-16 18:08:20,692][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:08:20,699][root][INFO] - Configuration: 
[2024-05-16 18:08:20,702][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 2048
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:08:20,702][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:08:21,217][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:08:21,217][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:08:21,272][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:08:21,296][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:08:21,303][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:08:21,303][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:08:21,303][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:08:21,303][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:08:21,303][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:08:21,303][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:08:21,303][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:08:21,303][root][INFO] - Starting training
[2024-05-16 18:08:26,742][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:08:26,742][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:08:27,218][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 50000
[2024-05-16 18:08:27,218][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:08:27,288][hannah.modules.vision.base][INFO] -   Dev Set: 10000
[2024-05-16 18:08:27,356][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:08:28,137][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:08:28,152][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.4914, 0.4822, 0.4465), std: (0.2023, 0.1994, 0.201)
[2024-05-16 18:08:28,158][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:08:28,165][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:08:28,176][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:08:29,631][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (24) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.

[2024-05-16 18:08:29,774][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:08:31,237][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:08:31,237][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:08:31,237][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:08:31,237][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:08:31,237][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:08:31,823][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:08:41,841][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 24: 'val_error' reached 0.78772 (best 0.78772), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=24.ckpt' as top 1
[2024-05-16 18:08:42,311][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:08:52,336][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 48: 'val_error' reached 0.64014 (best 0.64014), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=1-step=48.ckpt' as top 1
[2024-05-16 18:08:52,819][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:09:03,053][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 72: 'val_error' reached 0.57617 (best 0.57617), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=2-step=72.ckpt' as top 1
[2024-05-16 18:09:03,532][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:09:08,061][root][ERROR] - Exception Message: 'NoneType' object has no attribute '_invalidate_flags_cache'
    full_key: 
    object_type=None
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
    self.fit_loop.run()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
    self.advance()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
    self.advance(data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 250, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 190, in run
    self._optimizer_step(batch_idx, closure)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 268, in _optimizer_step
    call._call_lightning_module_hook(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/core/module.py", line 1303, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/core/optimizer.py", line 152, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 239, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/plugins/precision/amp.py", line 80, in optimizer_step
    closure_result = closure()
                     ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 144, in __call__
    self._result = self.closure(*args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 129, in closure
    step_output = self._step_fn()
                  ^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 318, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 391, in training_step
    return self.lightning_module.training_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/image_classifier.py", line 115, in training_step
    loss, _, _, _ = self.common_step("train", batch_labeled, batch_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/image_classifier.py", line 59, in common_step
    augmented_data, x = self.augment(x, labels, boxes, batch_idx)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 248, in augment
    augmented_data = self.default_augmentation(images)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/augmentation/batch_augmentation.py", line 57, in forward
    result = self.transforms(x)
             ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/base.py", line 210, in forward
    output = self.apply_func(in_tensor, params, flags)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/_2d/base.py", line 129, in apply_func
    output = self.transform_inputs(in_tensor, params, flags, trans_matrix)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/base.py", line 261, in transform_inputs
    output = self.apply_transform(in_tensor, params, flags, transform=transform)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/_2d/geometric/crop.py", line 203, in apply_transform
    return crop_by_indices(input, params["src"], flags["size"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/geometry/transform/crop2d.py", line 344, in crop_by_indices
    if _out.shape[-2:] != size:
       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 523, in __ne__
    x = self.__eq__(other)
        ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 514, in __eq__
    other = ListConfig(other, flags={"allow_objects": True})
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 82, in __init__
    format_and_raise(node=None, key=key, value=None, cause=ex, msg=str(ex))
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/_utils.py", line 899, in format_and_raise
    _raise(ex, cause)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/_utils.py", line 797, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set env var OC_CAUSE=1 for full trace
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 80, in __init__
    self._set_value(value=content, flags=flags)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 618, in _set_value
    raise e
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 614, in _set_value
    self._set_value_impl(value, flags)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 657, in _set_value_impl
    with flag_override(self, ["struct", "readonly"], False):
  File "/usr/lib64/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/omegaconf.py", line 968, in flag_override
    config._set_flag(names, prev_states)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/base.py", line 178, in _set_flag
    self._invalidate_flags_cache()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/base.py", line 790, in _invalidate_flags_cache
    item._invalidate_flags_cache()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute '_invalidate_flags_cache'
    full_key: 
    object_type=None
[2024-05-16 18:09:24,070][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:09:24,164][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:09:24,164][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:09:24,167][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:09:24,167][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:09:24,167][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:09:24,167][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:09:24,168][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:09:24,168][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:09:24,168][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:09:24,169][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:09:24,169][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000
[2024-05-16 18:09:24,169][hannah.utils.utils][INFO] -   
[2024-05-16 18:09:24,170][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:09:24,177][root][INFO] - Configuration: 
[2024-05-16 18:09:24,181][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:09:24,181][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:09:24,700][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:09:24,700][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:09:24,755][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:09:24,779][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:09:24,786][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:09:24,786][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:09:24,786][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:09:24,786][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:09:24,786][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:09:24,786][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:09:24,786][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:09:24,786][root][INFO] - Starting training
[2024-05-16 18:09:30,250][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:09:30,251][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:09:30,731][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 50000
[2024-05-16 18:09:30,731][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:09:30,801][hannah.modules.vision.base][INFO] -   Dev Set: 10000
[2024-05-16 18:09:30,870][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:09:31,642][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:09:31,659][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.4914, 0.4822, 0.4465), std: (0.2023, 0.1994, 0.201)
[2024-05-16 18:09:31,665][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:09:31,672][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:09:31,683][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:09:33,264][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:09:34,727][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:09:34,727][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:09:34,727][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:09:34,727][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:09:34,727][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:09:35,119][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:09:45,914][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 50: 'val_error' reached 0.64660 (best 0.64660), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt' as top 1
[2024-05-16 18:09:46,192][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:09:56,980][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 100: 'val_error' reached 0.58410 (best 0.58410), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=1-step=100.ckpt' as top 1
[2024-05-16 18:09:57,261][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:10:08,237][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 150: 'val_error' reached 0.48730 (best 0.48730), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=2-step=150.ckpt' as top 1
[2024-05-16 18:10:08,518][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:10:12,241][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:10:12,247][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:10:12,248][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:10:12,478][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=2-step=150.ckpt
[2024-05-16 18:10:12,491][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:10:12,666][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=2-step=150.ckpt
[2024-05-16 18:10:12,956][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:10:12,962][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:10:12,963][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:10:12,997][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 1.34281  |     0 |       1 |
| val_accuracy        | 0.5127   |     0 |       1 |
| val_error           | 0.4873   |     0 |       1 |
| val_f1              | 0.498229 |     0 |       1 |
| val_precision       | 0.558853 |     0 |       1 |
| val_recall          | 0.5127   |     0 |       1 |
| val_loss            | 1.34281  |     0 |       1 |
[2024-05-16 18:10:19,401][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:10:19,495][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:10:19,496][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:10:19,499][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:10:19,499][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:10:19,499][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:10:19,499][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:10:19,499][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:10:19,499][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:10:19,499][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:10:19,501][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:10:19,501][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1] module.batch_size=10000
[2024-05-16 18:10:19,501][hannah.utils.utils][INFO] -   
[2024-05-16 18:10:19,502][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:10:19,510][root][INFO] - Configuration: 
[2024-05-16 18:10:19,513][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 10000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:10:19,513][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:10:20,030][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:10:20,030][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:10:20,097][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:10:20,121][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:10:20,128][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:10:20,128][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:10:20,128][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:10:20,128][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:10:20,128][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:10:20,128][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:10:20,128][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:10:20,128][root][INFO] - Starting training
[2024-05-16 18:10:25,553][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:10:25,553][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:10:26,029][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 50000
[2024-05-16 18:10:26,029][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:10:26,099][hannah.modules.vision.base][INFO] -   Dev Set: 10000
[2024-05-16 18:10:26,168][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:10:27,161][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:10:27,184][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.4914, 0.4822, 0.4465), std: (0.2023, 0.1994, 0.201)
[2024-05-16 18:10:27,190][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:10:27,196][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:10:27,207][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:10:28,653][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (5) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.

[2024-05-16 18:10:28,805][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:10:30,518][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:10:30,518][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:10:30,518][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:10:30,518][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:10:30,519][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:10:32,674][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:10:40,962][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 5: 'val_error' reached 0.86850 (best 0.86850), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=5.ckpt' as top 1
[2024-05-16 18:10:42,948][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:10:51,512][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 10: 'val_error' reached 0.84970 (best 0.84970), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=1-step=10.ckpt' as top 1
[2024-05-16 18:10:53,489][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:11:01,806][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 15: 'val_error' reached 0.81400 (best 0.81400), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=2-step=15.ckpt' as top 1
[2024-05-16 18:11:03,789][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:11:12,331][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 20: 'val_error' reached 0.78330 (best 0.78330), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=3-step=20.ckpt' as top 1
[2024-05-16 18:11:14,301][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:11:22,596][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 25: 'val_error' reached 0.73690 (best 0.73690), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=4-step=25.ckpt' as top 1
[2024-05-16 18:11:24,580][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:11:33,140][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 30: 'val_error' reached 0.69520 (best 0.69520), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=5-step=30.ckpt' as top 1
[2024-05-16 18:11:35,107][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:11:38,588][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:11:38,594][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:11:38,594][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:11:38,822][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=5-step=30.ckpt
[2024-05-16 18:11:38,849][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:11:39,023][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=5-step=30.ckpt
[2024-05-16 18:11:39,106][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:11:47,656][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:11:47,749][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:11:47,750][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:11:47,753][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:11:47,753][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:11:47,753][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:11:47,753][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:11:47,753][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:11:47,753][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:11:47,753][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:11:47,755][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:11:47,755][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10 model=kakao_resnet8 trainer.devices=[1] module.batch_size=10000
[2024-05-16 18:11:47,755][hannah.utils.utils][INFO] -   
[2024-05-16 18:11:47,756][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:11:47,764][root][INFO] - Configuration: 
[2024-05-16 18:11:47,767][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10Dataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 10000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:11:47,767][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:11:48,287][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:11:48,287][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:11:48,342][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:11:48,366][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:11:48,373][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:11:48,373][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:11:48,373][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:11:48,373][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:11:48,373][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:11:48,374][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:11:48,374][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:11:48,374][root][INFO] - Starting training
[2024-05-16 18:11:53,841][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:11:53,842][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:11:53,842][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 45000
[2024-05-16 18:11:53,842][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:11:53,842][hannah.modules.vision.base][INFO] -   Dev Set: 5000
[2024-05-16 18:11:53,842][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:11:53,843][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:11:53,854][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.491, 0.482, 0.446), std: (0.247, 0.243, 0.261)
[2024-05-16 18:11:53,861][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:11:53,870][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:11:53,879][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:11:53,880][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-16 18:11:53,887][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (4) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.

[2024-05-16 18:11:54,050][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:11:54,303][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-16 18:11:54,303][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/utilities/data.py:104: Total length of `DataLoader` across ranks is zero. Please make sure this was your intention.

[2024-05-16 18:11:54,310][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:11:54,310][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:11:54,310][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:11:54,310][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:11:54,310][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:11:57,117][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:12:04,745][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:383: `ModelCheckpoint(monitor='val_error')` could not find the monitored key in the returned metrics: ['train_classifier_loss', 'train_accuracy', 'train_error', 'train_f1', 'train_precision', 'train_recall', 'train_loss', 'epoch', 'step']. HINT: Did you call `log('val_error', value)` in the `LightningModule`?

[2024-05-16 18:12:04,745][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 4: 'val_error' was not in top 1
[2024-05-16 18:12:14,705][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 8: 'val_error' was not in top 1
[2024-05-16 18:12:24,681][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 12: 'val_error' was not in top 1
[2024-05-16 18:12:34,680][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 16: 'val_error' was not in top 1
[2024-05-16 18:12:44,702][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 20: 'val_error' was not in top 1
[2024-05-16 18:12:54,676][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 24: 'val_error' was not in top 1
[2024-05-16 18:13:04,711][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 28: 'val_error' was not in top 1
[2024-05-16 18:13:14,891][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 32: 'val_error' was not in top 1
[2024-05-16 18:13:24,839][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 36: 'val_error' was not in top 1
[2024-05-16 18:13:34,783][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 40: 'val_error' was not in top 1
[2024-05-16 18:13:44,750][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 44: 'val_error' was not in top 1
[2024-05-16 18:13:54,699][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 48: 'val_error' was not in top 1
[2024-05-16 18:14:04,671][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:383: `ModelCheckpoint(monitor='val_error')` could not find the monitored key in the returned metrics: ['train_classifier_loss', 'train_accuracy', 'train_error', 'train_f1', 'train_precision', 'train_recall', 'train_loss', 'lr-SGD', 'epoch', 'step']. HINT: Did you call `log('val_error', value)` in the `LightningModule`?

[2024-05-16 18:14:04,671][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 52: 'val_error' was not in top 1
[2024-05-16 18:14:14,650][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 56: 'val_error' was not in top 1
[2024-05-16 18:14:24,658][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 60: 'val_error' was not in top 1
[2024-05-16 18:14:34,611][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 64: 'val_error' was not in top 1
[2024-05-16 18:14:44,567][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 68: 'val_error' was not in top 1
[2024-05-16 18:14:54,530][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 72: 'val_error' was not in top 1
[2024-05-16 18:14:58,778][root][ERROR] - Exception Message: 'NoneType' object has no attribute '_invalidate_flags_cache'
    full_key: 
    object_type=None
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
    self.fit_loop.run()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
    self.advance()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
    self.advance(data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 250, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 190, in run
    self._optimizer_step(batch_idx, closure)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 268, in _optimizer_step
    call._call_lightning_module_hook(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/core/module.py", line 1303, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/core/optimizer.py", line 152, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 239, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/plugins/precision/amp.py", line 80, in optimizer_step
    closure_result = closure()
                     ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 144, in __call__
    self._result = self.closure(*args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 129, in closure
    step_output = self._step_fn()
                  ^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 318, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 391, in training_step
    return self.lightning_module.training_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/image_classifier.py", line 115, in training_step
    loss, _, _, _ = self.common_step("train", batch_labeled, batch_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/image_classifier.py", line 59, in common_step
    augmented_data, x = self.augment(x, labels, boxes, batch_idx)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 248, in augment
    augmented_data = self.default_augmentation(images)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/augmentation/batch_augmentation.py", line 57, in forward
    result = self.transforms(x)
             ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/base.py", line 210, in forward
    output = self.apply_func(in_tensor, params, flags)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/_2d/base.py", line 129, in apply_func
    output = self.transform_inputs(in_tensor, params, flags, trans_matrix)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/base.py", line 261, in transform_inputs
    output = self.apply_transform(in_tensor, params, flags, transform=transform)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/_2d/geometric/crop.py", line 203, in apply_transform
    return crop_by_indices(input, params["src"], flags["size"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/geometry/transform/crop2d.py", line 344, in crop_by_indices
    if _out.shape[-2:] != size:
       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 523, in __ne__
    x = self.__eq__(other)
        ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 514, in __eq__
    other = ListConfig(other, flags={"allow_objects": True})
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 82, in __init__
    format_and_raise(node=None, key=key, value=None, cause=ex, msg=str(ex))
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/_utils.py", line 899, in format_and_raise
    _raise(ex, cause)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/_utils.py", line 797, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set env var OC_CAUSE=1 for full trace
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 80, in __init__
    self._set_value(value=content, flags=flags)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 618, in _set_value
    raise e
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 614, in _set_value
    self._set_value_impl(value, flags)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 657, in _set_value_impl
    with flag_override(self, ["struct", "readonly"], False):
  File "/usr/lib64/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/omegaconf.py", line 968, in flag_override
    config._set_flag(names, prev_states)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/base.py", line 178, in _set_flag
    self._invalidate_flags_cache()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/base.py", line 790, in _invalidate_flags_cache
    item._invalidate_flags_cache()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute '_invalidate_flags_cache'
    full_key: 
    object_type=None
[2024-05-16 18:15:04,490][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:15:04,584][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:15:04,585][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:15:04,588][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:15:04,588][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:15:04,588][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:15:04,588][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:15:04,588][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:15:04,588][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:15:04,588][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:15:04,589][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:15:04,590][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10 model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000
[2024-05-16 18:15:04,590][hannah.utils.utils][INFO] -   
[2024-05-16 18:15:04,591][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:15:04,595][root][INFO] - Configuration: 
[2024-05-16 18:15:04,599][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10Dataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:15:04,599][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:15:05,111][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:15:05,111][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:15:05,165][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:15:05,189][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:15:05,195][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:15:05,195][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:15:05,195][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:15:05,196][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:15:05,196][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:15:05,196][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:15:05,196][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:15:05,196][root][INFO] - Starting training
[2024-05-16 18:15:10,624][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:15:10,624][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:15:10,624][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 45000
[2024-05-16 18:15:10,624][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:15:10,624][hannah.modules.vision.base][INFO] -   Dev Set: 5000
[2024-05-16 18:15:10,624][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:15:10,625][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:15:10,637][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.491, 0.482, 0.446), std: (0.247, 0.243, 0.261)
[2024-05-16 18:15:10,643][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:15:10,653][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:15:10,662][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:15:10,663][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-16 18:15:10,670][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (45) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.

[2024-05-16 18:15:10,833][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:15:11,082][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-16 18:15:11,403][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:15:11,403][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:15:11,403][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:15:11,403][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:15:11,403][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:15:11,810][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:15:23,112][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 45: 'val_error' reached 0.64840 (best 0.64840), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=45.ckpt' as top 1
[2024-05-16 18:15:23,406][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:15:34,938][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 90: 'val_error' reached 0.64520 (best 0.64520), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=1-step=90.ckpt' as top 1
[2024-05-16 18:15:35,240][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:15:46,583][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 135: 'val_error' was not in top 1
[2024-05-16 18:15:46,857][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:15:58,437][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 180: 'val_error' reached 0.49200 (best 0.49200), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=3-step=180.ckpt' as top 1
[2024-05-16 18:15:58,742][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:16:10,117][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 225: 'val_error' reached 0.37700 (best 0.37700), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=4-step=225.ckpt' as top 1
[2024-05-16 18:16:10,422][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:16:21,799][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 270: 'val_error' was not in top 1
[2024-05-16 18:16:22,074][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:16:33,580][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 315: 'val_error' reached 0.34920 (best 0.34920), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=6-step=315.ckpt' as top 1
[2024-05-16 18:16:33,883][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:16:45,407][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 360: 'val_error' reached 0.30180 (best 0.30180), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=7-step=360.ckpt' as top 1
[2024-05-16 18:16:45,712][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:16:57,075][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 405: 'val_error' reached 0.24860 (best 0.24860), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=8-step=405.ckpt' as top 1
[2024-05-16 18:16:57,377][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:16:59,319][root][ERROR] - Exception Message: 'NoneType' object has no attribute '_invalidate_flags_cache'
    full_key: 
    object_type=None
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
    self.fit_loop.run()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
    self.advance()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
    self.advance(data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 250, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 190, in run
    self._optimizer_step(batch_idx, closure)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 268, in _optimizer_step
    call._call_lightning_module_hook(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/core/module.py", line 1303, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/core/optimizer.py", line 152, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 239, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/plugins/precision/amp.py", line 80, in optimizer_step
    closure_result = closure()
                     ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 144, in __call__
    self._result = self.closure(*args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 129, in closure
    step_output = self._step_fn()
                  ^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 318, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 391, in training_step
    return self.lightning_module.training_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/image_classifier.py", line 115, in training_step
    loss, _, _, _ = self.common_step("train", batch_labeled, batch_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/image_classifier.py", line 59, in common_step
    augmented_data, x = self.augment(x, labels, boxes, batch_idx)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 248, in augment
    augmented_data = self.default_augmentation(images)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/augmentation/batch_augmentation.py", line 57, in forward
    result = self.transforms(x)
             ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/base.py", line 210, in forward
    output = self.apply_func(in_tensor, params, flags)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/_2d/base.py", line 129, in apply_func
    output = self.transform_inputs(in_tensor, params, flags, trans_matrix)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/base.py", line 261, in transform_inputs
    output = self.apply_transform(in_tensor, params, flags, transform=transform)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/_2d/geometric/crop.py", line 203, in apply_transform
    return crop_by_indices(input, params["src"], flags["size"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/geometry/transform/crop2d.py", line 344, in crop_by_indices
    if _out.shape[-2:] != size:
       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 523, in __ne__
    x = self.__eq__(other)
        ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 514, in __eq__
    other = ListConfig(other, flags={"allow_objects": True})
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 82, in __init__
    format_and_raise(node=None, key=key, value=None, cause=ex, msg=str(ex))
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/_utils.py", line 899, in format_and_raise
    _raise(ex, cause)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/_utils.py", line 797, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set env var OC_CAUSE=1 for full trace
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 80, in __init__
    self._set_value(value=content, flags=flags)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 618, in _set_value
    raise e
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 614, in _set_value
    self._set_value_impl(value, flags)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 657, in _set_value_impl
    with flag_override(self, ["struct", "readonly"], False):
  File "/usr/lib64/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/omegaconf.py", line 968, in flag_override
    config._set_flag(names, prev_states)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/base.py", line 178, in _set_flag
    self._invalidate_flags_cache()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/base.py", line 790, in _invalidate_flags_cache
    item._invalidate_flags_cache()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute '_invalidate_flags_cache'
    full_key: 
    object_type=None
[2024-05-16 18:17:18,617][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:17:18,712][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:17:18,713][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:17:18,716][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:17:18,716][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:17:18,716][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:17:18,716][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:17:18,716][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:17:18,716][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:17:18,716][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:17:18,718][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:17:18,718][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000
[2024-05-16 18:17:18,718][hannah.utils.utils][INFO] -   
[2024-05-16 18:17:18,719][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:17:18,726][root][INFO] - Configuration: 
[2024-05-16 18:17:18,729][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:17:18,730][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:17:19,245][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:17:19,245][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:17:19,300][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:17:19,324][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:17:19,331][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:17:19,331][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:17:19,331][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:17:19,331][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:17:19,331][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:17:19,331][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:17:19,331][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:17:19,331][root][INFO] - Starting training
[2024-05-16 18:17:24,758][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:17:24,758][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:17:25,235][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 50000
[2024-05-16 18:17:25,235][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:17:25,305][hannah.modules.vision.base][INFO] -   Dev Set: 10000
[2024-05-16 18:17:25,374][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:17:26,374][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:17:26,397][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.4914, 0.4822, 0.4465), std: (0.2023, 0.1994, 0.201)
[2024-05-16 18:17:26,403][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:17:26,409][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:17:26,420][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:17:27,794][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:17:29,269][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:17:29,269][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:17:29,270][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:17:29,270][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:17:29,270][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:17:29,662][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:17:40,509][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 50: 'val_error' reached 0.64660 (best 0.64660), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt' as top 1
[2024-05-16 18:17:40,790][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:17:51,631][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 100: 'val_error' reached 0.58410 (best 0.58410), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=1-step=100.ckpt' as top 1
[2024-05-16 18:17:51,908][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:18:02,976][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 150: 'val_error' reached 0.48730 (best 0.48730), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=2-step=150.ckpt' as top 1
[2024-05-16 18:18:03,262][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:18:14,118][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 200: 'val_error' was not in top 1
[2024-05-16 18:18:14,379][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:18:17,156][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:18:17,162][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:18:17,162][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:18:17,610][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=2-step=150.ckpt
[2024-05-16 18:18:17,623][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:18:17,649][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:18:17,655][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:18:17,656][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:18:17,887][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=2-step=150.ckpt
[2024-05-16 18:18:17,905][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:18:18,077][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=2-step=150.ckpt
[2024-05-16 18:18:18,145][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:18:18,160][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 1.62739  |     0 |       1 |
| val_accuracy        | 0.4809   |     0 |       1 |
| val_error           | 0.5191   |     0 |       1 |
| val_f1              | 0.466231 |     0 |       1 |
| val_precision       | 0.575519 |     0 |       1 |
| val_recall          | 0.4809   |     0 |       1 |
| val_loss            | 1.62739  |     0 |       1 |
[2024-05-16 18:19:38,504][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:19:38,597][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:19:38,598][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:19:38,601][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:19:38,601][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:19:38,601][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:19:38,601][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:19:38,601][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:19:38,601][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:19:38,601][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:19:38,603][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:19:38,603][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000
[2024-05-16 18:19:38,603][hannah.utils.utils][INFO] -   
[2024-05-16 18:19:38,604][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:19:38,611][root][INFO] - Configuration: 
[2024-05-16 18:19:38,614][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:19:38,614][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:19:39,132][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:19:39,132][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:19:39,187][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:19:39,211][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:19:39,218][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:19:39,218][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:19:39,218][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:19:39,218][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:19:39,218][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:19:39,218][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:19:39,218][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:19:39,218][root][INFO] - Starting training
[2024-05-16 18:19:39,543][hydra.utils][ERROR] - Error getting class at hannah.datasets.vision.Cifar10FFCVDataset: Error loading 'hannah.datasets.vision.Cifar10FFCVDataset':
SyntaxError('invalid syntax. Perhaps you forgot a comma?', ('/local/gerum/hannah/hannah/datasets/vision/cifar10_ffcv.py', 156, 13, '            ToDevice("cuda:1")\n', 157, 26))
[2024-05-16 18:19:39,543][root][ERROR] - Exception Message: Error loading 'hannah.datasets.vision.Cifar10FFCVDataset':
SyntaxError('invalid syntax. Perhaps you forgot a comma?', ('/local/gerum/hannah/hannah/datasets/vision/cifar10_ffcv.py', 156, 13, '            ToDevice("cuda:1")\n', 157, 26))
Traceback (most recent call last):
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
          ^^^^^^^^^^^^^^^^^^
AttributeError: module 'hannah.datasets' has no attribute 'vision'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
          ^^^^^^^^^^^^^^^^^^
  File "/usr/lib64/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/local/gerum/hannah/hannah/datasets/vision/__init__.py", line 20, in <module>
    from .cifar10_ffcv import Cifar10FFCVDataset
  File "/local/gerum/hannah/hannah/datasets/vision/cifar10_ffcv.py", line 156
    ToDevice("cuda:1")
    ^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 947, in _run
    self._data_connector.prepare_data()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py", line 100, in prepare_data
    call._call_lightning_module_hook(trainer, "prepare_data")
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 216, in prepare_data
    get_class(self.hparams.dataset.cls).prepare(self.hparams.dataset)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/hydra/utils.py", line 40, in get_class
    raise e
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/hydra/utils.py", line 31, in get_class
    cls = _locate(path)
          ^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/hydra/_internal/utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'hannah.datasets.vision.Cifar10FFCVDataset':
SyntaxError('invalid syntax. Perhaps you forgot a comma?', ('/local/gerum/hannah/hannah/datasets/vision/cifar10_ffcv.py', 156, 13, '            ToDevice("cuda:1")\n', 157, 26))
[2024-05-16 18:19:59,886][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:19:59,984][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:19:59,985][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:19:59,987][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:19:59,988][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:19:59,988][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:19:59,988][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:19:59,988][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:19:59,988][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:19:59,988][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:19:59,989][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:19:59,990][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000
[2024-05-16 18:19:59,990][hannah.utils.utils][INFO] -   
[2024-05-16 18:19:59,991][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:19:59,992][root][INFO] - Configuration: 
[2024-05-16 18:19:59,995][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:19:59,995][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:20:00,514][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:20:00,514][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:20:00,581][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:20:00,605][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:20:00,612][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:20:00,612][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:20:00,612][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:20:00,612][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:20:00,612][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:20:00,612][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:20:00,612][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:20:00,612][root][INFO] - Starting training
[2024-05-16 18:20:06,079][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:20:06,079][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:20:06,563][root][ERROR] - Exception Message: 'str' object has no attribute 'type'
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 949, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 94, in _call_setup_hook
    _call_lightning_module_hook(trainer, "setup", stage=fn)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 86, in setup
    msglogger.info("  Train Set (Labeled): %d", len(self.train_set))
                                                ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/cifar10_ffcv.py", line 67, in __len__
    return len(self.loader(1, shuffle=False))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/cifar10_ffcv.py", line 105, in loader
    return Loader(
           ^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/ffcv/loader/loader.py", line 210, in __init__
    self.generate_code()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/ffcv/loader/loader.py", line 275, in generate_code
    queries, code = self.graph.collect_requirements()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/ffcv/pipeline/graph.py", line 352, in collect_requirements
    self.collect_requirements(next_state, node, allocations, code, source_field=source_field)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/ffcv/pipeline/graph.py", line 352, in collect_requirements
    self.collect_requirements(next_state, node, allocations, code, source_field=source_field)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/ffcv/pipeline/graph.py", line 352, in collect_requirements
    self.collect_requirements(next_state, node, allocations, code, source_field=source_field)
  [Previous line repeated 1 more time]
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/ffcv/pipeline/graph.py", line 333, in collect_requirements
    if next_state.device.type != 'cuda' and isinstance(operation,
       ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'type'
[2024-05-16 18:21:39,977][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:21:40,085][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:21:40,086][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:21:40,088][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:21:40,088][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:21:40,088][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:21:40,088][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:21:40,089][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:21:40,089][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:21:40,089][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:21:40,090][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:21:40,090][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000
[2024-05-16 18:21:40,090][hannah.utils.utils][INFO] -   
[2024-05-16 18:21:40,091][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:21:40,093][root][INFO] - Configuration: 
[2024-05-16 18:21:40,096][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:21:40,096][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:21:40,613][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:21:40,613][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:21:40,668][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:21:40,692][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:21:40,699][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:21:40,699][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:21:40,699][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:21:40,699][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:21:40,699][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:21:40,699][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:21:40,700][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:21:40,700][root][INFO] - Starting training
[2024-05-16 18:21:46,195][root][ERROR] - Exception Message: 'module' object is not callable
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 949, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 94, in _call_setup_hook
    _call_lightning_module_hook(trainer, "setup", stage=fn)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 63, in setup
    data_splits: Tuple[Any] = dataset_cls.splits(self.hparams.dataset)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/cifar10_ffcv.py", line 151, in splits
    label_pipeline = [IntDecoder(), ToTensor(), ToDevice(torch.cuda(1)), Squeeze()]
                                                         ^^^^^^^^^^^^^
TypeError: 'module' object is not callable
[2024-05-16 18:23:16,744][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:23:16,841][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:23:16,842][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:23:16,845][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:23:16,845][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:23:16,845][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:23:16,845][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:23:16,845][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:23:16,845][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:23:16,845][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:23:16,846][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:23:16,847][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000
[2024-05-16 18:23:16,847][hannah.utils.utils][INFO] -   
[2024-05-16 18:23:16,848][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:23:16,849][root][INFO] - Configuration: 
[2024-05-16 18:23:16,852][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:23:16,852][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:23:17,371][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:23:17,371][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:23:17,426][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:23:17,450][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:23:17,457][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:23:17,457][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:23:17,457][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:23:17,457][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:23:17,457][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:23:17,457][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:23:17,457][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:23:17,457][root][INFO] - Starting training
[2024-05-16 18:23:22,922][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:23:22,923][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:23:23,400][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 50000
[2024-05-16 18:23:23,401][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:23:23,471][hannah.modules.vision.base][INFO] -   Dev Set: 10000
[2024-05-16 18:23:23,540][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:23:24,594][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:23:24,617][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.4914, 0.4822, 0.4465), std: (0.2023, 0.1994, 0.201)
[2024-05-16 18:23:24,623][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:23:24,640][root][ERROR] - Exception Message: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 949, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 94, in _call_setup_hook
    _call_lightning_module_hook(trainer, "setup", stage=fn)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 198, in setup
    self(self.example_input_array)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 219, in forward
    return self.model(x)
           ^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
[2024-05-16 18:28:12,023][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:28:12,120][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:28:12,121][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:28:12,123][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:28:12,123][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:28:12,123][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:28:12,123][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:28:12,124][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:28:12,124][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:28:12,124][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:28:12,125][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:28:12,125][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000
[2024-05-16 18:28:12,125][hannah.utils.utils][INFO] -   
[2024-05-16 18:28:12,126][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:28:12,128][root][INFO] - Configuration: 
[2024-05-16 18:28:12,131][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:28:12,131][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:28:12,653][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:28:12,653][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:28:12,708][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:28:12,732][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:28:12,739][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:28:12,739][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:28:12,739][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:28:12,739][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:28:12,739][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:28:12,739][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:28:12,740][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:28:12,740][root][INFO] - Starting training
[2024-05-16 18:28:18,209][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:28:18,209][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:28:18,689][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 50000
[2024-05-16 18:28:18,689][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:28:18,759][hannah.modules.vision.base][INFO] -   Dev Set: 10000
[2024-05-16 18:28:18,829][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:28:19,673][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:28:19,688][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.4914, 0.4822, 0.4465), std: (0.2023, 0.1994, 0.201)
[2024-05-16 18:28:19,694][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:28:19,701][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:28:19,707][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:28:21,396][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:28:22,868][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:28:22,868][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:28:22,868][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:28:22,868][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:28:22,868][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:28:23,251][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:28:33,953][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 50: 'val_error' reached 0.63820 (best 0.63820), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt' as top 1
[2024-05-16 18:28:34,269][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:28:45,033][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 100: 'val_error' reached 0.62860 (best 0.62860), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=1-step=100.ckpt' as top 1
[2024-05-16 18:28:45,347][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:28:49,492][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:28:49,498][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:28:49,499][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:28:49,728][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=1-step=100.ckpt
[2024-05-16 18:28:49,746][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:28:49,925][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=1-step=100.ckpt
[2024-05-16 18:28:50,000][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:28:50,006][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:28:50,007][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:28:50,033][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 1.73904  |     0 |       1 |
| val_accuracy        | 0.3714   |     0 |       1 |
| val_error           | 0.6286   |     0 |       1 |
| val_f1              | 0.343297 |     0 |       1 |
| val_precision       | 0.467332 |     0 |       1 |
| val_recall          | 0.3714   |     0 |       1 |
| val_loss            | 1.73904  |     0 |       1 |
[2024-05-16 18:28:59,463][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:28:59,557][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:28:59,558][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:28:59,561][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:28:59,561][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:28:59,561][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:28:59,561][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:28:59,561][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:28:59,561][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:28:59,562][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:28:59,563][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:28:59,563][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000 profiler=advanced
[2024-05-16 18:28:59,563][hannah.utils.utils][INFO] -   
[2024-05-16 18:28:59,564][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:28:59,572][root][INFO] - Configuration: 
[2024-05-16 18:28:59,575][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
profiler:
  _target_: pytorch_lightning.profilers.AdvancedProfiler
  filename: null
  line_count_restriction: 20
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:28:59,575][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:29:00,095][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:29:00,095][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:29:00,150][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:29:00,174][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:29:00,181][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:29:00,181][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:29:00,181][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:29:00,181][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:29:00,182][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:29:00,182][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:29:00,182][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:29:00,182][root][INFO] - Starting training
[2024-05-16 18:29:07,630][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:29:07,630][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:29:08,520][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 50000
[2024-05-16 18:29:08,520][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:29:08,644][hannah.modules.vision.base][INFO] -   Dev Set: 10000
[2024-05-16 18:29:08,767][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:29:09,657][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:29:09,675][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.4914, 0.4822, 0.4465), std: (0.2023, 0.1994, 0.201)
[2024-05-16 18:29:09,686][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:29:09,694][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:29:09,702][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:29:12,202][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:29:13,803][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:29:13,803][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:29:13,803][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:29:13,804][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:29:13,804][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:29:14,443][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:29:37,181][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 50: 'val_error' reached 0.63820 (best 0.63820), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt' as top 1
[2024-05-16 18:29:37,748][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:29:42,581][root][ERROR] - Exception Message: 'NoneType' object has no attribute '_invalidate_flags_cache'
    full_key: 
    object_type=None
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
    self.fit_loop.run()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
    self.advance()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
    self.advance(data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 250, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 190, in run
    self._optimizer_step(batch_idx, closure)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 268, in _optimizer_step
    call._call_lightning_module_hook(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/core/module.py", line 1303, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/core/optimizer.py", line 152, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 239, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/plugins/precision/amp.py", line 80, in optimizer_step
    closure_result = closure()
                     ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 144, in __call__
    self._result = self.closure(*args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 129, in closure
    step_output = self._step_fn()
                  ^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 318, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 391, in training_step
    return self.lightning_module.training_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/image_classifier.py", line 115, in training_step
    loss, _, _, _ = self.common_step("train", batch_labeled, batch_idx)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/image_classifier.py", line 59, in common_step
    augmented_data, x = self.augment(x, labels, boxes, batch_idx)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 248, in augment
    augmented_data = self.default_augmentation(images)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/augmentation/batch_augmentation.py", line 57, in forward
    result = self.transforms(x)
             ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/base.py", line 210, in forward
    output = self.apply_func(in_tensor, params, flags)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/_2d/base.py", line 129, in apply_func
    output = self.transform_inputs(in_tensor, params, flags, trans_matrix)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/base.py", line 261, in transform_inputs
    output = self.apply_transform(in_tensor, params, flags, transform=transform)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/augmentation/_2d/geometric/crop.py", line 203, in apply_transform
    return crop_by_indices(input, params["src"], flags["size"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/kornia/geometry/transform/crop2d.py", line 344, in crop_by_indices
    if _out.shape[-2:] != size:
       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 523, in __ne__
    x = self.__eq__(other)
        ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 514, in __eq__
    other = ListConfig(other, flags={"allow_objects": True})
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 82, in __init__
    format_and_raise(node=None, key=key, value=None, cause=ex, msg=str(ex))
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/_utils.py", line 899, in format_and_raise
    _raise(ex, cause)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/_utils.py", line 797, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set env var OC_CAUSE=1 for full trace
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 80, in __init__
    self._set_value(value=content, flags=flags)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 618, in _set_value
    raise e
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 614, in _set_value
    self._set_value_impl(value, flags)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/listconfig.py", line 657, in _set_value_impl
    with flag_override(self, ["struct", "readonly"], False):
  File "/usr/lib64/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/omegaconf.py", line 968, in flag_override
    config._set_flag(names, prev_states)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/base.py", line 178, in _set_flag
    self._invalidate_flags_cache()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/omegaconf/base.py", line 790, in _invalidate_flags_cache
    item._invalidate_flags_cache()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute '_invalidate_flags_cache'
    full_key: 
    object_type=None
[2024-05-16 18:29:54,249][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:29:54,344][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:29:54,345][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:29:54,348][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:29:54,348][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:29:54,348][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:29:54,348][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:29:54,348][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:29:54,348][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:29:54,348][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:29:54,350][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:29:54,350][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000 profiler=advanced trainer.max_epochs=1
[2024-05-16 18:29:54,350][hannah.utils.utils][INFO] -   
[2024-05-16 18:29:54,351][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:29:54,360][root][INFO] - Configuration: 
[2024-05-16 18:29:54,363][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 1
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
profiler:
  _target_: pytorch_lightning.profilers.AdvancedProfiler
  filename: null
  line_count_restriction: 20
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:29:54,363][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:29:54,879][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:29:54,880][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:29:54,935][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:29:54,958][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:29:54,965][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:29:54,965][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:29:54,965][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:29:54,965][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:29:54,965][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:29:54,965][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:29:54,965][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:29:54,965][root][INFO] - Starting training
[2024-05-16 18:30:02,394][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:30:02,395][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:30:03,279][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 50000
[2024-05-16 18:30:03,280][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:30:03,402][hannah.modules.vision.base][INFO] -   Dev Set: 10000
[2024-05-16 18:30:03,524][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:30:04,416][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:30:04,434][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.4914, 0.4822, 0.4465), std: (0.2023, 0.1994, 0.201)
[2024-05-16 18:30:04,445][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:30:04,453][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:30:04,461][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:30:06,963][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:30:08,497][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:30:08,498][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:30:08,498][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:30:08,498][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:30:08,498][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:30:09,126][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:30:31,713][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 50: 'val_error' reached 0.57230 (best 0.57230), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt' as top 1
[2024-05-16 18:30:31,767][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer.fit` stopped: `max_epochs=1` reached.
[2024-05-16 18:30:32,162][pytorch_lightning.profilers.profiler][INFO] - FIT Profiler Report
Profile stats for: [LightningModule]ImageClassifierModule.configure_callbacks
         7 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 module.py:923(configure_callbacks)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.prepare_data
         8477941 function calls (8013440 primitive calls) in 7.088 seconds

   Ordered by: cumulative time
   List reduced from 4223 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       35    0.000    0.000   23.769    0.679 __init__.py:1(<module>)
        1    0.001    0.001    7.091    7.091 base.py:213(prepare_data)
        1    0.000    0.000    5.901    5.901 utils.py:21(get_class)
        1    0.000    0.000    5.901    5.901 utils.py:614(_locate)
    400/2    0.001    0.000    5.901    2.951 __init__.py:108(import_module)
    401/2    0.000    0.000    5.901    2.951 <frozen importlib._bootstrap>:1192(_gcd_import)
    668/2    0.001    0.000    5.901    2.951 <frozen importlib._bootstrap>:1165(_find_and_load)
    279/1    0.001    0.000    5.901    5.901 <frozen importlib._bootstrap>:1120(_find_and_load_unlocked)
    265/1    0.001    0.000    5.901    5.901 <frozen importlib._bootstrap>:666(_load_unlocked)
    255/1    0.000    0.000    5.901    5.901 <frozen importlib._bootstrap_external>:934(exec_module)
    628/2    0.000    0.000    5.901    2.950 <frozen importlib._bootstrap>:233(_call_with_frames_removed)
    273/1    0.002    0.000    5.901    5.901 {built-in method builtins.exec}
    105/7    0.000    0.000    5.680    0.811 {built-in method builtins.__import__}
        1    0.000    0.000    5.627    5.627 cifar10_ffcv.py:1(<module>)
        1    0.000    0.000    5.624    5.624 loader.py:1(<module>)
        1    0.000    0.000    5.521    5.521 rgb_image.py:1(<module>)
        2    0.000    0.000    5.515    2.758 typeddict.py:182(__setitem__)
        2    0.000    0.000    5.515    2.757 dispatcher.py:388(_compile_for_args)
    188/2    0.002    0.000    5.499    2.750 dispatcher.py:907(compile)
     52/2    0.000    0.000    5.499    2.749 dispatcher.py:124(compile)



Profile stats for: [Callback]LearningRateMonitor.setup
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:58(setup)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.setup
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 callback.py:58(setup)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.setup
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 callback.py:58(setup)



Profile stats for: [Callback]PredictionLogger.setup
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 prediction_logger.py:24(setup)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.setup
         13 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 progress_bar.py:171(setup)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 trainer.py:1252(is_global_zero)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 single_device.py:81(is_global_zero)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelSummary.setup
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:58(setup)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup
         1174 function calls in 0.001 seconds

   Ordered by: cumulative time
   List reduced from 90 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 model_checkpoint.py:268(setup)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:651(__warn_if_dir_not_empty)
        1    0.000    0.000    0.000    0.000 cloud_io.py:105(_is_dir)
        1    0.000    0.000    0.000    0.000 cloud_io.py:83(_is_object_storage)
        3    0.000    0.000    0.000    0.000 imports.py:45(module_available)
        3    0.000    0.000    0.000    0.000 imports.py:29(package_available)
        3    0.000    0.000    0.000    0.000 <frozen importlib.util>:73(find_spec)
        3    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1054(_find_spec)
        3    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:1496(find_spec)
        3    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:1464(_get_spec)
       24    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:1604(find_spec)
      120    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:126(_path_join)
       24    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:140(_path_stat)
        1    0.000    0.000    0.000    0.000 cloud_io.py:60(get_filesystem)
       25    0.000    0.000    0.000    0.000 {built-in method posix.stat}
        1    0.000    0.000    0.000    0.000 core.py:346(url_to_fs)
      120    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:128(<listcomp>)
        1    0.000    0.000    0.000    0.000 spec.py:60(__call__)
      120    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:244(_verbose_message)
      242    0.000    0.000    0.000    0.000 {method 'rstrip' of 'str' objects}



Profile stats for: [LightningModule]ImageClassifierModule.setup
         2488487 function calls (2306423 primitive calls) in 2.060 seconds

   Ordered by: cumulative time
   List reduced from 3204 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    2.061    2.061 base.py:52(setup)
        4    0.000    0.000    1.250    0.313 cifar10_ffcv.py:104(loader)
        4    0.000    0.000    1.250    0.313 loader.py:89(__init__)
     40/5    0.001    0.000    1.158    0.232 dispatcher.py:907(compile)
     13/5    0.000    0.000    1.157    0.231 dispatcher.py:124(compile)
     13/5    0.000    0.000    1.157    0.231 dispatcher.py:131(_compile_cached)
     13/5    0.000    0.000    1.157    0.231 dispatcher.py:146(_compile_core)
     13/5    0.000    0.000    1.156    0.231 compiler.py:725(compile_extra)
     13/5    0.000    0.000    1.153    0.231 compiler.py:439(compile_extra)
     13/5    0.000    0.000    1.152    0.230 compiler.py:508(_compile_bytecode)
     13/5    0.000    0.000    1.152    0.230 compiler.py:462(_compile_core)
     14/5    0.001    0.000    1.150    0.230 compiler_machinery.py:342(run)
  391/135    0.001    0.000    1.149    0.009 compiler_lock.py:32(_acquire_compile_lock)
  342/130    0.006    0.000    1.147    0.009 compiler_machinery.py:268(_runPass)
43503/3540    0.003    0.000    1.129    0.000 {built-in method builtins.len}
        3    0.000    0.000    1.128    0.376 cifar10_ffcv.py:66(__len__)
 1026/390    0.001    0.000    1.101    0.003 compiler_machinery.py:272(check)
       30    0.000    0.000    0.946    0.032 compiler.py:23(compile)
    38/31    0.000    0.000    0.946    0.031 decorators.py:206(wrapper)
        4    0.000    0.000    0.943    0.236 os_cache.py:55(compile_reader)



Profile stats for: [LightningModule]ImageClassifierModule.configure_optimizers
         8997 function calls (8251 primitive calls) in 2.301 seconds

   Ordered by: cumulative time
   List reduced from 368 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    2.301    2.301 base.py:221(configure_optimizers)
        1    0.000    0.000    2.297    2.297 base.py:242(total_training_steps)
        1    0.000    0.000    2.297    2.297 trainer.py:1664(estimated_stepping_batches)
       37    0.000    0.000    2.297    0.062 {built-in method builtins.next}
       20    0.000    0.000    2.297    0.115 contextlib.py:132(__enter__)
        1    0.000    0.000    2.297    2.297 fit_loop.py:213(setup_data)
        1    0.000    0.000    2.297    2.297 data_connector.py:330(_request_dataloader)
        1    0.000    0.000    2.297    2.297 data_connector.py:299(dataloader)
        1    0.000    0.000    2.297    2.297 call.py:135(_call_lightning_module_hook)
        1    0.000    0.000    2.297    2.297 profiler.py:55(profile)
        1    0.000    0.000    2.297    2.297 advanced.py:65(start)
        1    2.297    2.297    2.297    2.297 {method 'enable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.003    0.003 _instantiate2.py:148(instantiate)
      7/1    0.000    0.000    0.001    0.001 _instantiate2.py:278(instantiate_node)
        1    0.000    0.000    0.001    0.001 omegaconf.py:250(merge)
    303/3    0.000    0.000    0.001    0.000 copy.py:128(deepcopy)
        2    0.000    0.000    0.001    0.000 dictconfig.py:113(__deepcopy__)
        1    0.000    0.000    0.001    0.001 _instantiate2.py:50(_call_target)
        1    0.000    0.000    0.001    0.001 sgd.py:11(__init__)
        1    0.000    0.000    0.001    0.001 optimizer.py:245(__init__)



Profile stats for: [LightningModule]ImageClassifierModule.train_dataloader
         3387576 function calls (3195902 primitive calls) in 2.162 seconds

   Ordered by: cumulative time
   List reduced from 2707 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    2.163    2.163 base.py:141(train_dataloader)
        1    0.000    0.000    2.163    2.163 base.py:152(_get_dataloader)
        1    0.000    0.000    2.163    2.163 cifar10_ffcv.py:104(loader)
        1    0.000    0.000    2.163    2.163 loader.py:89(__init__)
     72/2    0.001    0.000    1.864    0.932 dispatcher.py:907(compile)
     20/2    0.000    0.000    1.863    0.932 dispatcher.py:124(compile)
     20/2    0.000    0.000    1.863    0.932 dispatcher.py:131(_compile_cached)
     20/2    0.000    0.000    1.863    0.932 dispatcher.py:146(_compile_core)
     20/2    0.000    0.000    1.863    0.931 compiler.py:725(compile_extra)
     21/2    0.000    0.000    1.862    0.931 compiler.py:439(compile_extra)
     21/2    0.000    0.000    1.860    0.930 compiler.py:508(_compile_bytecode)
     21/2    0.000    0.000    1.860    0.930 compiler.py:462(_compile_core)
     21/2    0.001    0.000    1.859    0.930 compiler_machinery.py:342(run)
   625/54    0.001    0.000    1.859    0.034 compiler_lock.py:32(_acquire_compile_lock)
   546/52    0.010    0.000    1.858    0.036 compiler_machinery.py:268(_runPass)
 1638/156    0.001    0.000    1.839    0.012 compiler_machinery.py:272(check)
        1    0.000    0.000    1.757    1.757 loader.py:213(next_traversal_order)
        1    0.000    0.000    1.757    1.757 quasi_random.py:78(sample_order)
        1    0.000    0.000    1.755    1.755 dispatcher.py:388(_compile_for_args)
     21/2    0.000    0.000    1.331    0.666 typed_passes.py:105(run_pass)



Profile stats for: [Callback]LearningRateMonitor.on_fit_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:64(on_fit_start)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_fit_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:64(on_fit_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_fit_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:64(on_fit_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_fit_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:64(on_fit_start)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_fit_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 callback.py:64(on_fit_start)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelSummary.on_fit_start
         246 function calls (245 primitive calls) in 0.204 seconds

   Ordered by: cumulative time
   List reduced from 48 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.204    0.204 model_summary.py:59(on_fit_start)
        1    0.000    0.000    0.204    0.204 model_summary.py:73(_summary)
        1    0.000    0.000    0.204    0.204 model_summary.py:462(summarize)
        1    0.000    0.000    0.204    0.204 model_summary.py:203(__init__)
        1    0.000    0.000    0.204    0.204 model_summary.py:268(summarize)
        1    0.000    0.000    0.204    0.204 model_summary.py:282(_forward_example_input)
        1    0.000    0.000    0.204    0.204 module.py:340(_on_before_batch_transfer)
        1    0.000    0.000    0.204    0.204 module.py:325(_call_batch_hook)
        1    0.000    0.000    0.204    0.204 call.py:135(_call_lightning_module_hook)
        1    0.000    0.000    0.204    0.204 contextlib.py:132(__enter__)
        1    0.000    0.000    0.204    0.204 {built-in method builtins.next}
        1    0.000    0.000    0.204    0.204 profiler.py:55(profile)
        1    0.000    0.000    0.204    0.204 advanced.py:65(start)
        1    0.204    0.204    0.204    0.204 {method 'enable' of '_lsprof.Profiler' objects}
       12    0.000    0.000    0.000    0.000 model_summary.py:269(<genexpr>)
       11    0.000    0.000    0.000    0.000 model_summary.py:72(__init__)
       11    0.000    0.000    0.000    0.000 model_summary.py:82(_register_hook)
       11    0.000    0.000    0.000    0.000 module.py:1421(register_forward_hook)
        1    0.000    0.000    0.000    0.000 model_summary.py:217(named_modules)
       12    0.000    0.000    0.000    0.000 module.py:2286(named_children)



Profile stats for: [LightningModule]ImageClassifierModule.on_before_batch_transfer
         448 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       64    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       64    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       64    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       64    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       64    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       64    0.000    0.000    0.000    0.000 hooks.py:615(on_before_batch_transfer)
       64    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.transfer_batch_to_device
         2152 function calls in 0.002 seconds

   Ordered by: cumulative time
   List reduced from 22 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       64    0.000    0.000    0.002    0.000 hooks.py:562(transfer_batch_to_device)
       64    0.000    0.000    0.002    0.000 apply_func.py:71(move_data_to_device)
       64    0.000    0.000    0.002    0.000 apply_func.py:23(apply_to_collection)
      126    0.000    0.000    0.001    0.000 apply_func.py:91(batch_to)
      186    0.000    0.000    0.001    0.000 apply_func.py:68(<genexpr>)
      126    0.001    0.000    0.001    0.000 {method 'to' of 'torch._C.TensorBase' objects}
      504    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       62    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      188    0.000    0.000    0.000    0.000 <frozen abc>:117(__instancecheck__)
      186    0.000    0.000    0.000    0.000 apply_func.py:67(<genexpr>)
       64    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
      188    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       64    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       64    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       64    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 <frozen abc>:121(__subclasscheck__)
        2    0.000    0.000    0.000    0.000 {built-in method _abc._abc_subclasscheck}
       64    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 apply_func.py:63(__subclasshook__)
       64    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_after_batch_transfer
         448 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       64    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       64    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       64    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       64    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       64    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       64    0.000    0.000    0.000    0.000 hooks.py:643(on_after_batch_transfer)
       64    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:64(on_fit_start)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_fit_start
         7 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 hooks.py:31(on_fit_start)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]LearningRateMonitor.on_sanity_check_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 callback.py:70(on_sanity_check_start)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_sanity_check_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:70(on_sanity_check_start)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_sanity_check_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:70(on_sanity_check_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_sanity_check_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 callback.py:70(on_sanity_check_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_sanity_check_start
         1226 function calls in 0.001 seconds

   Ordered by: cumulative time
   List reduced from 158 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 tqdm_progress.py:249(on_sanity_check_start)
        1    0.000    0.000    0.001    0.001 tqdm_progress.py:185(init_sanity_tqdm)
        2    0.000    0.000    0.001    0.000 std.py:663(__new__)
        2    0.000    0.000    0.000    0.000 tqdm_progress.py:40(__init__)
        2    0.000    0.000    0.000    0.000 asyncio.py:23(__init__)
        2    0.000    0.000    0.000    0.000 std.py:952(__init__)
        1    0.000    0.000    0.000    0.000 _monitor.py:30(__init__)
        1    0.000    0.000    0.000    0.000 threading.py:938(start)
        1    0.000    0.000    0.000    0.000 std.py:1325(refresh)
        1    0.000    0.000    0.000    0.000 std.py:1464(display)
        1    0.000    0.000    0.000    0.000 threading.py:604(wait)
        1    0.000    0.000    0.000    0.000 threading.py:288(wait)
        4    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.lock' objects}
        1    0.000    0.000    0.000    0.000 std.py:1150(__str__)
        1    0.000    0.000    0.000    0.000 std.py:464(format_meter)
        1    0.000    0.000    0.000    0.000 {built-in method _thread.start_new_thread}
        3    0.000    0.000    0.000    0.000 utils.py:378(disp_len)
        2    0.000    0.000    0.000    0.000 std.py:760(get_lock)
        3    0.000    0.000    0.000    0.000 utils.py:374(_text_width)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.sum}



Profile stats for: [Callback]ModelSummary.on_sanity_check_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 callback.py:70(on_sanity_check_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 callback.py:70(on_sanity_check_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.val_dataloader
         221217 function calls (207717 primitive calls) in 0.210 seconds

   Ordered by: cumulative time
   List reduced from 2081 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.210    0.210 base.py:149(val_dataloader)
        1    0.000    0.000    0.210    0.210 base.py:152(_get_dataloader)
        1    0.000    0.000    0.210    0.210 cifar10_ffcv.py:104(loader)
        1    0.000    0.000    0.210    0.210 loader.py:89(__init__)
        7    0.000    0.000    0.195    0.028 compiler.py:23(compile)
        7    0.000    0.000    0.195    0.028 decorators.py:206(wrapper)
        1    0.000    0.000    0.195    0.195 os_cache.py:55(compile_reader)
      3/1    0.000    0.000    0.194    0.194 dispatcher.py:907(compile)
        1    0.000    0.000    0.112    0.112 dispatcher.py:124(compile)
        1    0.000    0.000    0.112    0.112 dispatcher.py:131(_compile_cached)
        1    0.000    0.000    0.112    0.112 dispatcher.py:146(_compile_core)
        1    0.000    0.000    0.112    0.112 compiler.py:725(compile_extra)
        1    0.000    0.000    0.112    0.112 compiler.py:439(compile_extra)
        1    0.000    0.000    0.111    0.111 compiler.py:508(_compile_bytecode)
        1    0.000    0.000    0.111    0.111 compiler.py:462(_compile_core)
        1    0.000    0.000    0.110    0.110 compiler_machinery.py:342(run)
    34/27    0.000    0.000    0.110    0.004 compiler_lock.py:32(_acquire_compile_lock)
       26    0.001    0.000    0.110    0.004 compiler_machinery.py:268(_runPass)
       78    0.000    0.000    0.100    0.001 compiler_machinery.py:272(check)
        1    0.000    0.000    0.082    0.082 typed_passes.py:437(run_pass)



Profile stats for: [LightningModule]ImageClassifierModule.on_validation_model_eval
         4502 function calls (4184 primitive calls) in 0.001 seconds

   Ordered by: cumulative time
   List reduced from 29 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.001    0.001 hooks.py:160(on_validation_model_eval)
        2    0.000    0.000    0.001    0.001 module.py:2397(eval)
    160/2    0.000    0.000    0.001    0.001 module.py:2375(train)
      318    0.000    0.000    0.001    0.000 module.py:2277(children)
      318    0.000    0.000    0.001    0.000 module.py:2286(named_children)
      160    0.000    0.000    0.000    0.000 module.py:1690(__setattr__)
       72    0.000    0.000    0.000    0.000 metric.py:944(__hash__)
      158    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
  892/732    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       36    0.000    0.000    0.000    0.000 metric.py:731(__setattr__)
      160    0.000    0.000    0.000    0.000 parameter.py:8(__instancecheck__)
       72    0.000    0.000    0.000    0.000 {built-in method builtins.hash}
      252    0.000    0.000    0.000    0.000 _tensor.py:1034(__hash__)
      482    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      252    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      252    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      324    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      252    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
      160    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x7ff50abdad40}
      160    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}



Profile stats for: [Callback]LearningRateMonitor.on_validation_start
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 callback.py:211(on_validation_start)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_validation_start
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 callback.py:211(on_validation_start)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_validation_start
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 callback.py:211(on_validation_start)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_validation_start
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 callback.py:211(on_validation_start)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_validation_start
         1100 function calls in 0.000 seconds

   Ordered by: cumulative time
   List reduced from 100 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 tqdm_progress.py:287(on_validation_start)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:223(init_validation_tqdm)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:40(__init__)
        1    0.000    0.000    0.000    0.000 asyncio.py:23(__init__)
        1    0.000    0.000    0.000    0.000 std.py:952(__init__)
        1    0.000    0.000    0.000    0.000 std.py:1325(refresh)
        1    0.000    0.000    0.000    0.000 std.py:1464(display)
        1    0.000    0.000    0.000    0.000 std.py:1150(__str__)
        3    0.000    0.000    0.000    0.000 utils.py:378(disp_len)
        3    0.000    0.000    0.000    0.000 utils.py:374(_text_width)
        1    0.000    0.000    0.000    0.000 std.py:464(format_meter)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
      456    0.000    0.000    0.000    0.000 utils.py:375(<genexpr>)
        1    0.000    0.000    0.000    0.000 std.py:457(print_status)
        1    0.000    0.000    0.000    0.000 utils.py:386(disp_trim)
        2    0.000    0.000    0.000    0.000 utils.py:333(_screen_shape_linux)
        1    0.000    0.000    0.000    0.000 std.py:663(__new__)
      453    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
        2    0.000    0.000    0.000    0.000 std.py:1441(moveto)
        6    0.000    0.000    0.000    0.000 utils.py:194(inner)



Profile stats for: [Callback]ModelSummary.on_validation_start
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 callback.py:211(on_validation_start)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 callback.py:211(on_validation_start)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_validation_start
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 hooks.py:51(on_validation_start)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Strategy]SingleDeviceStrategy.on_validation_start
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 strategy.py:551(on_validation_start)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]LearningRateMonitor.on_validation_epoch_start
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 callback.py:124(on_validation_epoch_start)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_validation_epoch_start
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 callback.py:124(on_validation_epoch_start)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_validation_epoch_start
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 callback.py:124(on_validation_epoch_start)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_validation_epoch_start
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 callback.py:124(on_validation_epoch_start)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_validation_epoch_start
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 callback.py:124(on_validation_epoch_start)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelSummary.on_validation_epoch_start
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 callback.py:124(on_validation_epoch_start)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 callback.py:124(on_validation_epoch_start)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_validation_epoch_start
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 hooks.py:239(on_validation_epoch_start)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [_EvaluationLoop].val_next
         450 function calls (426 primitive calls) in 0.687 seconds

   Ordered by: cumulative time
   List reduced from 38 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    36/12    0.000    0.000    0.687    0.057 {built-in method builtins.next}
       12    0.000    0.000    0.687    0.057 combined_loader.py:339(__next__)
       12    0.000    0.000    0.687    0.057 combined_loader.py:128(__next__)
       12    0.000    0.000    0.687    0.057 epoch_iterator.py:154(__next__)
       12    0.000    0.000    0.686    0.057 queue.py:154(get)
        2    0.000    0.000    0.686    0.343 threading.py:288(wait)
       20    0.686    0.034    0.686    0.034 {method 'acquire' of '_thread.lock' objects}
       12    0.000    0.000    0.001    0.000 streams.py:56(wait_stream)
       12    0.000    0.000    0.001    0.000 streams.py:39(wait_event)
       12    0.000    0.000    0.001    0.000 streams.py:186(wait)
       12    0.001    0.000    0.001    0.000 {function Event.wait at 0x7ff50adaefc0}
       12    0.000    0.000    0.000    0.000 streams.py:70(record_event)
       12    0.000    0.000    0.000    0.000 streams.py:176(record)
       12    0.000    0.000    0.000    0.000 {function Event.record at 0x7ff50adaef20}
       12    0.000    0.000    0.000    0.000 threading.py:359(notify)
       12    0.000    0.000    0.000    0.000 evaluation_loop.py:346(_on_after_fetch)
       12    0.000    0.000    0.000    0.000 streams.py:163(__new__)
       12    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x7ff671817aa0}
       12    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       10    0.000    0.000    0.000    0.000 {method 'release' of '_thread.lock' objects}



Profile stats for: [Strategy]SingleDeviceStrategy.batch_to_device
         1984 function calls (1922 primitive calls) in 0.004 seconds

   Ordered by: cumulative time
   List reduced from 25 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       62    0.000    0.000    0.004    0.000 strategy.py:263(batch_to_device)
       62    0.000    0.000    0.004    0.000 module.py:343(_apply_batch_transfer_handler)
       62    0.000    0.000    0.004    0.000 module.py:325(_call_batch_hook)
       62    0.000    0.000    0.004    0.000 call.py:135(_call_lightning_module_hook)
       62    0.000    0.000    0.003    0.000 contextlib.py:132(__enter__)
       62    0.000    0.000    0.003    0.000 {built-in method builtins.next}
       62    0.000    0.000    0.003    0.000 profiler.py:55(profile)
       62    0.000    0.000    0.003    0.000 advanced.py:65(start)
       62    0.003    0.000    0.003    0.000 {method 'enable' of '_lsprof.Profiler' objects}
       62    0.000    0.000    0.000    0.000 module.py:1690(__setattr__)
  248/186    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       62    0.000    0.000    0.000    0.000 contextlib.py:287(helper)
       62    0.000    0.000    0.000    0.000 parameter.py:8(__instancecheck__)
       62    0.000    0.000    0.000    0.000 contextlib.py:104(__init__)
       62    0.000    0.000    0.000    0.000 __init__.py:1467(debug)
       62    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       62    0.000    0.000    0.000    0.000 data_connector.py:366(get_instance)
       62    0.000    0.000    0.000    0.000 __init__.py:1734(isEnabledFor)
      124    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       62    0.000    0.000    0.000    0.000 single_device.py:71(root_device)



Profile stats for: [Callback]LearningRateMonitor.on_validation_batch_start
         120 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       12    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       12    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       12    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       12    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       12    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       12    0.000    0.000    0.000    0.000 callback.py:142(on_validation_batch_start)
       12    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_validation_batch_start
         120 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       12    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       12    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       12    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       12    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       12    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       12    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 callback.py:142(on_validation_batch_start)
       12    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_validation_batch_start
         120 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       12    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       12    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       12    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       12    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       12    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       12    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 callback.py:142(on_validation_batch_start)
       12    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_validation_batch_start
         120 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       12    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       12    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       12    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       12    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       12    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       12    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
       12    0.000    0.000    0.000    0.000 callback.py:142(on_validation_batch_start)



Profile stats for: [Callback]TQDMProgressBar.on_validation_batch_start
         4590 function calls in 0.001 seconds

   Ordered by: cumulative time
   List reduced from 82 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.001    0.000 tqdm_progress.py:292(on_validation_batch_start)
        4    0.000    0.000    0.001    0.000 std.py:1325(refresh)
        4    0.000    0.000    0.001    0.000 std.py:1464(display)
        4    0.000    0.000    0.001    0.000 std.py:1150(__str__)
        2    0.000    0.000    0.001    0.000 std.py:1360(reset)
       12    0.000    0.000    0.001    0.000 utils.py:378(disp_len)
        4    0.000    0.000    0.001    0.000 std.py:464(format_meter)
       12    0.000    0.000    0.001    0.000 utils.py:374(_text_width)
       12    0.000    0.000    0.001    0.000 {built-in method builtins.sum}
        2    0.000    0.000    0.000    0.000 std.py:1382(set_description)
     1878    0.000    0.000    0.000    0.000 utils.py:375(<genexpr>)
        4    0.000    0.000    0.000    0.000 std.py:457(print_status)
        4    0.000    0.000    0.000    0.000 utils.py:386(disp_trim)
        4    0.000    0.000    0.000    0.000 std.py:1446(format_dict)
       16    0.000    0.000    0.000    0.000 utils.py:194(inner)
        4    0.000    0.000    0.000    0.000 utils.py:333(_screen_shape_linux)
        8    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
     1866    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
        4    0.000    0.000    0.000    0.000 std.py:451(fp_write)
        4    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}



Profile stats for: [Callback]ModelSummary.on_validation_batch_start
         120 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       12    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       12    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       12    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       12    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       12    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       12    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 callback.py:142(on_validation_batch_start)
       12    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start
         120 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       12    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       12    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       12    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       12    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       12    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       12    0.000    0.000    0.000    0.000 callback.py:142(on_validation_batch_start)
       12    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_validation_batch_start
         84 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       12    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       12    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       12    0.000    0.000    0.000    0.000 hooks.py:90(on_validation_batch_start)
       12    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Strategy]SingleDeviceStrategy.validation_step
         104997 function calls (76488 primitive calls) in 0.297 seconds

   Ordered by: cumulative time
   List reduced from 520 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.297    0.025 strategy.py:401(validation_step)
       12    0.000    0.000    0.296    0.025 image_classifier.py:132(validation_step)
       12    0.000    0.000    0.296    0.025 image_classifier.py:46(common_step)
   576/24    0.001    0.000    0.208    0.009 module.py:1507(_wrapped_call_impl)
   576/24    0.001    0.000    0.208    0.009 module.py:1513(_call_impl)
       12    0.000    0.000    0.179    0.015 collections.py:190(forward)
       12    0.000    0.000    0.179    0.015 collections.py:314(_compute_and_reduce)
       60    0.000    0.000    0.177    0.003 metric.py:281(forward)
       60    0.001    0.000    0.177    0.003 metric.py:360(_forward_reduce_state_update)
       60    0.000    0.000    0.129    0.002 metric.py:610(wrapped_func)
       36    0.117    0.003    0.120    0.003 compute.py:63(_adjust_weights_safe_divide)
       12    0.000    0.000    0.119    0.010 f_beta.py:345(compute)
       12    0.001    0.000    0.119    0.010 f_beta.py:37(_fbeta_reduce)
      144    0.001    0.000    0.036    0.000 metric.py:476(wrapped_func)
       60    0.000    0.000    0.034    0.001 stat_scores.py:336(update)
      124    0.033    0.000    0.033    0.000 {built-in method torch.tensor}
       12    0.000    0.000    0.029    0.002 base.py:218(forward)
   132/12    0.001    0.000    0.029    0.002 container.py:215(forward)
       84    0.001    0.000    0.028    0.000 module.py:371(log)
       12    0.000    0.000    0.020    0.002 module.py:537(log_dict)



Profile stats for: [Callback]LearningRateMonitor.on_validation_batch_end
         120 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       12    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       12    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       12    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       12    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       12    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       12    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 callback.py:152(on_validation_batch_end)
       12    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_validation_batch_end
         120 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       12    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       12    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       12    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       12    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       12    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       12    0.000    0.000    0.000    0.000 callback.py:152(on_validation_batch_end)
       12    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_validation_batch_end
         120 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       12    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       12    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       12    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       12    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       12    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       12    0.000    0.000    0.000    0.000 callback.py:152(on_validation_batch_end)
       12    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_validation_batch_end
         156 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.000    0.000 prediction_logger.py:33(on_validation_batch_end)
       12    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       12    0.000    0.000    0.000    0.000 prediction_logger.py:47(_log)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       12    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       12    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       12    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       12    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
       12    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       12    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       12    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_validation_batch_end
         13716 function calls in 0.003 seconds

   Ordered by: cumulative time
   List reduced from 64 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.003    0.000 tqdm_progress.py:309(on_validation_batch_end)
       12    0.000    0.000    0.003    0.000 tqdm_progress.py:451(_update_n)
       12    0.000    0.000    0.003    0.000 std.py:1325(refresh)
       12    0.000    0.000    0.003    0.000 std.py:1464(display)
       12    0.000    0.000    0.002    0.000 std.py:1150(__str__)
       12    0.000    0.000    0.002    0.000 std.py:464(format_meter)
       36    0.000    0.000    0.002    0.000 utils.py:378(disp_len)
       36    0.000    0.000    0.002    0.000 utils.py:374(_text_width)
       36    0.000    0.000    0.002    0.000 {built-in method builtins.sum}
     5798    0.001    0.000    0.001    0.000 utils.py:375(<genexpr>)
       12    0.000    0.000    0.001    0.000 std.py:457(print_status)
       12    0.000    0.000    0.001    0.000 utils.py:386(disp_trim)
     5762    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
       12    0.000    0.000    0.000    0.000 std.py:1446(format_dict)
       64    0.000    0.000    0.000    0.000 utils.py:194(inner)
       12    0.000    0.000    0.000    0.000 utils.py:333(_screen_shape_linux)
       32    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
       20    0.000    0.000    0.000    0.000 std.py:1441(moveto)
       24    0.000    0.000    0.000    0.000 utils.py:273(_is_ascii)
       12    0.000    0.000    0.000    0.000 std.py:451(fp_write)



Profile stats for: [Callback]ModelSummary.on_validation_batch_end
         120 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       12    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       12    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       12    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       12    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       12    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       12    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 callback.py:152(on_validation_batch_end)
       12    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end
         120 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       12    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       12    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       12    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       12    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       12    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       12    0.000    0.000    0.000    0.000 callback.py:152(on_validation_batch_end)
       12    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_validation_batch_end
         84 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       12    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       12    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       12    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       12    0.000    0.000    0.000    0.000 hooks.py:100(on_validation_batch_end)
       12    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]LearningRateMonitor.on_validation_epoch_end
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 callback.py:127(on_validation_epoch_end)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_validation_epoch_end
         61543 function calls (53511 primitive calls) in 0.029 seconds

   Ordered by: cumulative time
   List reduced from 569 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.029    0.015 rank_zero.py:36(wrapped_fn)
        2    0.000    0.000    0.029    0.015 summaries.py:413(on_validation_epoch_end)
        2    0.000    0.000    0.024    0.012 summaries.py:310(_do_summary)
        2    0.000    0.000    0.014    0.007 tabulate.py:1280(tabulate)
        2    0.000    0.000    0.009    0.004 summaries.py:48(walk_model)
     84/2    0.000    0.000    0.006    0.003 module.py:1507(_wrapped_call_impl)
     84/2    0.000    0.000    0.006    0.003 module.py:1513(_call_impl)
     22/2    0.000    0.000    0.006    0.003 container.py:215(forward)
        8    0.000    0.000    0.005    0.001 module.py:371(log)
     1680    0.005    0.000    0.005    0.000 wcwidth.py:160(wcswidth)
        2    0.000    0.000    0.005    0.002 tabulate.py:1678(<listcomp>)
       20    0.000    0.000    0.005    0.000 tabulate.py:980(_column_type)
        8    0.000    0.000    0.004    0.001 result.py:357(log)
        2    0.000    0.000    0.004    0.002 tabulate.py:1707(<listcomp>)
       20    0.000    0.000    0.004    0.000 tabulate.py:910(_align_column)
       82    0.000    0.000    0.004    0.000 summaries.py:98(collect)
       20    0.000    0.000    0.004    0.000 tabulate.py:1002(<listcomp>)
        4    0.000    0.000    0.004    0.001 result.py:417(register_key)
      912    0.000    0.000    0.003    0.000 {built-in method builtins.max}
      820    0.001    0.000    0.003    0.000 tabulate.py:690(_type)



Profile stats for: [Callback]HydraOptCallback.on_validation_epoch_end
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 callback.py:127(on_validation_epoch_end)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_validation_epoch_end
         22 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 prediction_logger.py:28(on_validation_epoch_end)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 prediction_logger.py:55(_write_values)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_validation_epoch_end
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 callback.py:127(on_validation_epoch_end)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelSummary.on_validation_epoch_end
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 callback.py:127(on_validation_epoch_end)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 callback.py:127(on_validation_epoch_end)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_validation_epoch_end
         57 function calls (56 primitive calls) in 0.000 seconds

   Ordered by: cumulative time
   List reduced from 25 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 base.py:328(on_validation_epoch_end)
        1    0.000    0.000    0.000    0.000 collections.py:515(items)
        1    0.000    0.000    0.000    0.000 collections.py:289(_compute_groups_create_state_ref)
        2    0.000    0.000    0.000    0.000 trainer.py:1440(sanity_checking)
        1    0.000    0.000    0.000    0.000 module.py:1690(__setattr__)
        2    0.000    0.000    0.000    0.000 enums.py:81(__eq__)
      5/4    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 parameter.py:8(__instancecheck__)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        7    0.000    0.000    0.000    0.000 module.py:207(trainer)
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        4    0.000    0.000    0.000    0.000 enum.py:193(__get__)
        1    0.000    0.000    0.000    0.000 collections.py:493(_to_renamed_ordered_dict)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1144(global_rank)
        1    0.000    0.000    0.000    0.000 module.py:1675(__getattr__)
        5    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 enum.py:1249(value)
        4    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}



Profile stats for: [Callback]LearningRateMonitor.on_validation_end
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 callback.py:214(on_validation_end)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_validation_end
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 callback.py:214(on_validation_end)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_validation_end
         452 function calls in 0.000 seconds

   Ordered by: cumulative time
   List reduced from 46 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 optimization.py:144(on_validation_end)
        2    0.000    0.000    0.000    0.000 trainer.py:1617(callback_metrics)
        2    0.000    0.000    0.000    0.000 logger_connector.py:236(callback_metrics)
        2    0.000    0.000    0.000    0.000 logger_connector.py:229(metrics)
        2    0.000    0.000    0.000    0.000 result.py:478(metrics)
        6    0.000    0.000    0.000    0.000 trainer.py:1653(_results)
        6    0.000    0.000    0.000    0.000 trainer.py:1575(_active_loop)
        2    0.000    0.000    0.000    0.000 apply_func.py:113(convert_tensors_to_scalars)
        2    0.000    0.000    0.000    0.000 apply_func.py:23(apply_to_collection)
       22    0.000    0.000    0.000    0.000 result.py:432(_get_cache)
        2    0.000    0.000    0.000    0.000 apply_func.py:122(to_item)
        2    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C.TensorBase' objects}
       18    0.000    0.000    0.000    0.000 enums.py:81(__eq__)
       22    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C.TensorBase' objects}
       22    0.000    0.000    0.000    0.000 result.py:467(_forked_name)
        6    0.000    0.000    0.000    0.000 trainer.py:1392(training)
        2    0.000    0.000    0.000    0.000 trainer.py:1469(global_step)
        2    0.000    0.000    0.000    0.000 training_epoch_loop.py:99(global_step)
        6    0.000    0.000    0.000    0.000 trainer.py:1565(_evaluation_loop)
        6    0.000    0.000    0.000    0.000 trainer.py:1440(sanity_checking)



Profile stats for: [Callback]PredictionLogger.on_validation_end
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 callback.py:214(on_validation_end)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_validation_end
         1856 function calls (1840 primitive calls) in 0.001 seconds

   Ordered by: cumulative time
   List reduced from 133 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.001    0.000 tqdm_progress.py:323(on_validation_end)
        2    0.000    0.000    0.000    0.000 std.py:1402(set_postfix)
        3    0.000    0.000    0.000    0.000 std.py:1464(display)
        2    0.000    0.000    0.000    0.000 progress_bar.py:177(get_metrics)
        2    0.000    0.000    0.000    0.000 std.py:1325(refresh)
        2    0.000    0.000    0.000    0.000 trainer.py:1643(progress_bar_metrics)
        2    0.000    0.000    0.000    0.000 logger_connector.py:250(progress_bar_metrics)
        2    0.000    0.000    0.000    0.000 logger_connector.py:229(metrics)
        1    0.000    0.000    0.000    0.000 std.py:1150(__str__)
        2    0.000    0.000    0.000    0.000 std.py:1265(close)
        5    0.000    0.000    0.000    0.000 utils.py:378(disp_len)
        1    0.000    0.000    0.000    0.000 std.py:464(format_meter)
        5    0.000    0.000    0.000    0.000 utils.py:374(_text_width)
        2    0.000    0.000    0.000    0.000 result.py:478(metrics)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
      515    0.000    0.000    0.000    0.000 utils.py:375(<genexpr>)
        3    0.000    0.000    0.000    0.000 std.py:457(print_status)
        2    0.000    0.000    0.000    0.000 std.py:686(_decr_instances)
        1    0.000    0.000    0.000    0.000 utils.py:386(disp_trim)
        6    0.000    0.000    0.000    0.000 trainer.py:1653(_results)



Profile stats for: [Callback]ModelSummary.on_validation_end
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 callback.py:214(on_validation_end)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end
         68 function calls in 0.000 seconds

   Ordered by: cumulative time
   List reduced from 24 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 model_checkpoint.py:327(on_validation_end)
        2    0.000    0.000    0.000    0.000 model_checkpoint.py:414(_should_skip_saving_checkpoint)
        4    0.000    0.000    0.000    0.000 enums.py:81(__eq__)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:424(_should_save_on_train_epoch_end)
        2    0.000    0.000    0.000    0.000 trainer.py:1440(sanity_checking)
        2    0.000    0.000    0.000    0.000 trainer.py:1546(num_val_batches)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 trainer.py:1469(global_step)
        8    0.000    0.000    0.000    0.000 enum.py:193(__get__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 training_epoch_loop.py:99(global_step)
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        3    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        8    0.000    0.000    0.000    0.000 enum.py:1249(value)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        8    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 progress.py:274(optimizer_steps)
        3    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_validation_end
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 hooks.py:54(on_validation_end)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Strategy]SingleDeviceStrategy.on_validation_end
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 strategy.py:567(on_validation_end)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]LearningRateMonitor.on_sanity_check_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 callback.py:73(on_sanity_check_end)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_sanity_check_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:73(on_sanity_check_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_sanity_check_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 callback.py:73(on_sanity_check_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_sanity_check_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:73(on_sanity_check_end)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_sanity_check_end
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:254(on_sanity_check_end)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 std.py:1265(close)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:131(val_progress_bar)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:121(train_progress_bar)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelSummary.on_sanity_check_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:73(on_sanity_check_end)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 callback.py:73(on_sanity_check_end)



Profile stats for: [Callback]LearningRateMonitor.on_train_start
         39 function calls in 0.000 seconds

   Ordered by: cumulative time
   List reduced from 30 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:109(on_train_start)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:295(_find_names_from_schedulers)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:339(_check_duplicates_and_update_name)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:288(_duplicate_param_group_names)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:362(<listcomp>)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:289(<listcomp>)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 trainer.py:1194(optimizers)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:315(_find_names_from_optimizers)
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1202(lr_scheduler_configs)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:277(_add_suffix)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:269(_add_prefix)
        1    0.000    0.000    0.000    0.000 strategy.py:102(optimizers)
        3    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:160(<dictcomp>)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.len}



Profile stats for: [Callback]MacSummaryCallback.on_train_start
         30321 function calls (26896 primitive calls) in 0.013 seconds

   Ordered by: cumulative time
   List reduced from 499 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.013    0.013 rank_zero.py:36(wrapped_fn)
        1    0.000    0.000    0.013    0.013 summaries.py:380(on_train_start)
        1    0.000    0.000    0.012    0.012 summaries.py:310(_do_summary)
        1    0.000    0.000    0.007    0.007 tabulate.py:1280(tabulate)
        1    0.000    0.000    0.004    0.004 summaries.py:48(walk_model)
     42/1    0.000    0.000    0.003    0.003 module.py:1507(_wrapped_call_impl)
     42/1    0.000    0.000    0.003    0.003 module.py:1513(_call_impl)
     11/1    0.000    0.000    0.003    0.003 container.py:215(forward)
      840    0.002    0.000    0.002    0.000 wcwidth.py:160(wcswidth)
        1    0.000    0.000    0.002    0.002 tabulate.py:1678(<listcomp>)
       10    0.000    0.000    0.002    0.000 tabulate.py:980(_column_type)
        1    0.000    0.000    0.002    0.002 tabulate.py:1707(<listcomp>)
       41    0.000    0.000    0.002    0.000 summaries.py:98(collect)
       10    0.000    0.000    0.002    0.000 tabulate.py:910(_align_column)
      456    0.000    0.000    0.002    0.000 {built-in method builtins.max}
       10    0.000    0.000    0.002    0.000 tabulate.py:1002(<listcomp>)
        1    0.000    0.000    0.002    0.002 tabulate.py:1716(<listcomp>)
      410    0.000    0.000    0.002    0.000 tabulate.py:690(_type)
      420    0.000    0.000    0.002    0.000 tabulate.py:1717(<genexpr>)
       41    0.000    0.000    0.001    0.000 summaries.py:85(get_name_by_module)



Profile stats for: [Callback]HydraOptCallback.on_train_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 callback.py:205(on_train_start)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_train_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 callback.py:205(on_train_start)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_train_start
         1053 function calls in 0.000 seconds

   Ordered by: cumulative time
   List reduced from 92 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:259(on_train_start)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:197(init_train_tqdm)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:40(__init__)
        1    0.000    0.000    0.000    0.000 asyncio.py:23(__init__)
        1    0.000    0.000    0.000    0.000 std.py:952(__init__)
        1    0.000    0.000    0.000    0.000 std.py:1325(refresh)
        1    0.000    0.000    0.000    0.000 std.py:1464(display)
        3    0.000    0.000    0.000    0.000 utils.py:378(disp_len)
        1    0.000    0.000    0.000    0.000 std.py:1150(__str__)
        3    0.000    0.000    0.000    0.000 utils.py:374(_text_width)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
        1    0.000    0.000    0.000    0.000 std.py:464(format_meter)
      454    0.000    0.000    0.000    0.000 utils.py:375(<genexpr>)
        1    0.000    0.000    0.000    0.000 std.py:457(print_status)
        1    0.000    0.000    0.000    0.000 utils.py:386(disp_trim)
        2    0.000    0.000    0.000    0.000 utils.py:333(_screen_shape_linux)
      451    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
        1    0.000    0.000    0.000    0.000 std.py:663(__new__)
        2    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        1    0.000    0.000    0.000    0.000 std.py:1446(format_dict)



Profile stats for: [Callback]ModelSummary.on_train_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:205(on_train_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_start
         11 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:281(on_train_start)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {built-in method time.monotonic}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_train_start
         8 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 base.py:218(on_train_start)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 hooks.py:45(on_train_start)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Strategy]SingleDeviceStrategy.on_train_start
         7 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 strategy.py:547(on_train_start)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]LearningRateMonitor.on_train_epoch_start
         64 function calls in 0.000 seconds

   Ordered by: cumulative time
   List reduced from 41 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:177(on_train_epoch_start)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:187(_extract_stats)
        1    0.000    0.000    0.000    0.000 trainer.py:1617(callback_metrics)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:295(_find_names_from_schedulers)
        1    0.000    0.000    0.000    0.000 logger_connector.py:236(callback_metrics)
        1    0.000    0.000    0.000    0.000 trainer.py:1653(_results)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:339(_check_duplicates_and_update_name)
        2    0.000    0.000    0.000    0.000 trainer.py:1392(training)
        1    0.000    0.000    0.000    0.000 trainer.py:1575(_active_loop)
        2    0.000    0.000    0.000    0.000 enums.py:81(__eq__)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:288(_duplicate_param_group_names)
        1    0.000    0.000    0.000    0.000 fit_loop.py:140(_results)
        4    0.000    0.000    0.000    0.000 enum.py:193(__get__)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 lr_monitor.py:242(_remap_keys)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:362(<listcomp>)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 lr_monitor.py:289(<listcomp>)
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:315(_find_names_from_optimizers)



Profile stats for: [Callback]MacSummaryCallback.on_train_epoch_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:92(on_train_epoch_start)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_train_epoch_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:92(on_train_epoch_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_train_epoch_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:92(on_train_epoch_start)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_train_epoch_start
         2150 function calls in 0.000 seconds

   Ordered by: cumulative time
   List reduced from 68 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:263(on_train_epoch_start)
        2    0.000    0.000    0.000    0.000 std.py:1325(refresh)
        2    0.000    0.000    0.000    0.000 std.py:1464(display)
        2    0.000    0.000    0.000    0.000 std.py:1150(__str__)
        6    0.000    0.000    0.000    0.000 utils.py:378(disp_len)
        6    0.000    0.000    0.000    0.000 utils.py:374(_text_width)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
        2    0.000    0.000    0.000    0.000 std.py:464(format_meter)
        1    0.000    0.000    0.000    0.000 std.py:1360(reset)
        1    0.000    0.000    0.000    0.000 std.py:1382(set_description)
      917    0.000    0.000    0.000    0.000 utils.py:375(<genexpr>)
        2    0.000    0.000    0.000    0.000 std.py:457(print_status)
        2    0.000    0.000    0.000    0.000 utils.py:386(disp_trim)
      911    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
        4    0.000    0.000    0.000    0.000 utils.py:273(_is_ascii)
        2    0.000    0.000    0.000    0.000 std.py:1446(format_dict)
        2    0.000    0.000    0.000    0.000 utils.py:333(_screen_shape_linux)
        2    0.000    0.000    0.000    0.000 std.py:451(fp_write)
        4    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        4    0.000    0.000    0.000    0.000 utils.py:194(inner)



Profile stats for: [Callback]ModelSummary.on_train_epoch_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:92(on_train_epoch_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_start
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 callback.py:92(on_train_epoch_start)



Profile stats for: [LightningModule]ImageClassifierModule.on_train_epoch_start
         7 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 hooks.py:209(on_train_epoch_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: run_training_epoch
         64 function calls in 23.071 seconds

   Ordered by: cumulative time
   List reduced from 36 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000   23.071   23.071 training_epoch_loop.py:135(run)
        1    0.000    0.000   23.071   23.071 training_epoch_loop.py:192(advance)
        1    0.000    0.000   23.071   23.071 {built-in method builtins.next}
        1    0.000    0.000   23.071   23.071 fetchers.py:119(__next__)
        1    0.000    0.000   23.071   23.071 fetchers.py:55(__next__)
        1    0.000    0.000   23.071   23.071 training_epoch_loop.py:186(_on_before_fetch)
        1    0.000    0.000   23.071   23.071 advanced.py:65(start)
        1   23.071   23.071   23.071   23.071 {method 'enable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 training_epoch_loop.py:147(reset)
        1    0.000    0.000    0.000    0.000 loop.py:32(restarting)
        1    0.000    0.000    0.000    0.000 training_epoch_loop.py:116(done)
        4    0.000    0.000    0.000    0.000 progress.py:172(reset_on_run)
        1    0.000    0.000    0.000    0.000 training_epoch_loop.py:106(_is_training_done)
       18    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 progress.py:204(reset_on_run)
        1    0.000    0.000    0.000    0.000 progress.py:282(reset_on_run)
        2    0.000    0.000    0.000    0.000 progress.py:114(reset)
        1    0.000    0.000    0.000    0.000 progress.py:249(reset_on_run)
        3    0.000    0.000    0.000    0.000 progress.py:87(reset)
        1    0.000    0.000    0.000    0.000 training_epoch_loop.py:99(global_step)



Profile stats for: [_TrainingEpochLoop].train_dataloader_next
         2099 function calls (1999 primitive calls) in 0.004 seconds

   Ordered by: cumulative time
   List reduced from 38 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
   150/50    0.000    0.000    0.004    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.004    0.000 combined_loader.py:339(__next__)
       50    0.000    0.000    0.003    0.000 combined_loader.py:72(__next__)
       50    0.000    0.000    0.003    0.000 epoch_iterator.py:154(__next__)
       50    0.000    0.000    0.002    0.000 streams.py:56(wait_stream)
       50    0.000    0.000    0.001    0.000 streams.py:39(wait_event)
       50    0.000    0.000    0.001    0.000 streams.py:186(wait)
       50    0.000    0.000    0.001    0.000 queue.py:154(get)
       50    0.001    0.000    0.001    0.000 {function Event.wait at 0x7ff50adaefc0}
       50    0.000    0.000    0.001    0.000 streams.py:70(record_event)
       50    0.000    0.000    0.000    0.000 threading.py:359(notify)
       50    0.000    0.000    0.000    0.000 streams.py:176(record)
       50    0.000    0.000    0.000    0.000 {function Event.record at 0x7ff50adaef20}
       50    0.000    0.000    0.000    0.000 streams.py:163(__new__)
       50    0.000    0.000    0.000    0.000 _pytree.py:540(tree_unflatten)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       48    0.000    0.000    0.000    0.000 {method 'release' of '_thread.lock' objects}
       50    0.000    0.000    0.000    0.000 <frozen abc>:117(__instancecheck__)
       50    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x7ff671817aa0}
       50    0.000    0.000    0.000    0.000 threading.py:264(__enter__)



Profile stats for: [Callback]LearningRateMonitor.on_train_batch_start
         1418 function calls in 0.001 seconds

   Ordered by: cumulative time
   List reduced from 127 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.001    0.000 lr_monitor.py:164(on_train_batch_start)
       50    0.000    0.000    0.000    0.000 logger_connector.py:49(should_update_logs)
        3    0.000    0.000    0.000    0.000 rank_zero.py:36(wrapped_fn)
       53    0.000    0.000    0.000    0.000 trainer.py:1575(_active_loop)
       56    0.000    0.000    0.000    0.000 trainer.py:1392(training)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:187(_extract_stats)
       56    0.000    0.000    0.000    0.000 enums.py:81(__eq__)
        1    0.000    0.000    0.000    0.000 tensorboard.py:200(log_metrics)
        1    0.000    0.000    0.000    0.000 writer.py:353(add_scalar)
        1    0.000    0.000    0.000    0.000 trainer.py:1617(callback_metrics)
        1    0.000    0.000    0.000    0.000 logger_connector.py:236(callback_metrics)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 logger_connector.py:229(metrics)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 csv_logs.py:143(log_metrics)
        1    0.000    0.000    0.000    0.000 summary.py:352(scalar)
        1    0.000    0.000    0.000    0.000 result.py:478(metrics)
        1    0.000    0.000    0.000    0.000 csv_logs.py:213(log_metrics)
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        3    0.000    0.000    0.000    0.000 typing.py:352(inner)



Profile stats for: [Callback]MacSummaryCallback.on_train_batch_start
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 callback.py:76(on_train_batch_start)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_train_batch_start
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:76(on_train_batch_start)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_train_batch_start
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:76(on_train_batch_start)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_train_batch_start
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:76(on_train_batch_start)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelSummary.on_train_batch_start
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 callback.py:76(on_train_batch_start)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_start
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:76(on_train_batch_start)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_train_batch_start
         350 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 hooks.py:69(on_train_batch_start)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Strategy]SingleDeviceStrategy.on_train_batch_start
         350 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 strategy.py:579(on_train_batch_start)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: run_training_batch
         2950 function calls (2900 primitive calls) in 22.814 seconds

   Ordered by: cumulative time
   List reduced from 39 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000   22.813    0.456 automatic.py:161(run)
       50    0.000    0.000   22.813    0.456 automatic.py:243(_optimizer_step)
       50    0.000    0.000   22.812    0.456 call.py:135(_call_lightning_module_hook)
       50    0.000    0.000   22.812    0.456 contextlib.py:132(__enter__)
       50    0.000    0.000   22.812    0.456 {built-in method builtins.next}
       50    0.000    0.000   22.812    0.456 profiler.py:55(profile)
       50    0.000    0.000   22.812    0.456 advanced.py:65(start)
       50   22.812    0.456   22.812    0.456 {method 'enable' of '_lsprof.Profiler' objects}
       50    0.000    0.000    0.000    0.000 automatic.py:197(_make_closure)
      100    0.000    0.000    0.000    0.000 fit_loop.py:427(_should_accumulate)
      100    0.000    0.000    0.000    0.000 training_epoch_loop.py:336(_should_accumulate)
       50    0.000    0.000    0.000    0.000 module.py:1690(__setattr__)
       50    0.000    0.000    0.000    0.000 automatic.py:115(__init__)
       50    0.000    0.000    0.000    0.000 trainer.py:1194(optimizers)
  150/100    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      100    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
      100    0.000    0.000    0.000    0.000 training_epoch_loop.py:331(_num_ready_batches_reached)
       50    0.000    0.000    0.000    0.000 contextlib.py:287(helper)
       50    0.000    0.000    0.000    0.000 closure.py:41(__init__)
       50    0.000    0.000    0.000    0.000 parameter.py:8(__instancecheck__)



Profile stats for: [LightningModule]ImageClassifierModule.optimizer_step
         2400 function calls (2350 primitive calls) in 22.809 seconds

   Ordered by: cumulative time
   List reduced from 37 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000   22.809    0.456 module.py:1264(optimizer_step)
       50    0.000    0.000   22.809    0.456 optimizer.py:83(step)
       50    0.000    0.000   22.809    0.456 strategy.py:220(optimizer_step)
       50    0.000    0.000   22.808    0.456 amp.py:67(optimizer_step)
       50    0.000    0.000   22.808    0.456 automatic.py:142(__call__)
       50    0.000    0.000   22.808    0.456 _contextlib.py:112(decorate_context)
       50    0.000    0.000   22.808    0.456 automatic.py:126(closure)
       50    0.000    0.000   22.808    0.456 automatic.py:305(_training_step)
       50    0.000    0.000   22.808    0.456 call.py:292(_call_strategy_hook)
       50    0.000    0.000   22.807    0.456 contextlib.py:132(__enter__)
       50    0.000    0.000   22.807    0.456 {built-in method builtins.next}
       50    0.000    0.000   22.807    0.456 profiler.py:55(profile)
       50    0.000    0.000   22.807    0.456 advanced.py:65(start)
       50   22.807    0.456   22.807    0.456 {method 'enable' of '_lsprof.Profiler' objects}
       50    0.000    0.000    0.000    0.000 module.py:1690(__setattr__)
       50    0.000    0.000    0.000    0.000 grad_mode.py:134(__enter__)
       50    0.000    0.000    0.000    0.000 _contextlib.py:141(clone)
  250/200    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       50    0.000    0.000    0.000    0.000 contextlib.py:287(helper)
       50    0.000    0.000    0.000    0.000 parameter.py:8(__instancecheck__)



Profile stats for: [Strategy]SingleDeviceStrategy.training_step
         53242202 function calls (52768742 primitive calls) in 22.008 seconds

   Ordered by: cumulative time
   List reduced from 587 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000   22.058    0.441 strategy.py:380(training_step)
       50    0.001    0.000   22.054    0.441 image_classifier.py:108(training_step)
       50    0.003    0.000   22.054    0.441 image_classifier.py:46(common_step)
 2900/150    0.004    0.000   21.716    0.145 module.py:1507(_wrapped_call_impl)
 2900/150    0.007    0.000   21.716    0.145 module.py:1513(_call_impl)
  650/100    0.003    0.000   21.514    0.215 container.py:215(forward)
       50    0.001    0.000   21.411    0.428 base.py:226(augment)
       50    0.000    0.000   21.404    0.428 _contextlib.py:112(decorate_context)
       50    0.000    0.000   21.404    0.428 batch_augmentation.py:46(forward)
      200    0.002    0.000   21.401    0.107 base.py:184(forward)
      200    0.002    0.000   21.273    0.106 base.py:122(apply_func)
      200    0.019    0.000   21.041    0.105 base.py:242(transform_inputs)
       50    0.001    0.000   20.322    0.406 crop.py:172(apply_transform)
       50    3.125    0.062   20.233    0.405 crop2d.py:287(crop_by_indices)
    50000    0.029    0.000   17.065    0.000 listconfig.py:522(__ne__)
    50000    0.073    0.000   17.036    0.000 listconfig.py:512(__eq__)
    50000    0.119    0.000   12.777    0.000 listconfig.py:46(__init__)
    50000    0.028    0.000   12.305    0.000 listconfig.py:610(_set_value)
    50000    0.217    0.000   12.277    0.000 listconfig.py:620(_set_value_impl)
   100000    0.092    0.000   10.695    0.000 listconfig.py:293(append)



Profile stats for: [Callback]LearningRateMonitor.on_before_zero_grad
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 callback.py:285(on_before_zero_grad)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_before_zero_grad
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:285(on_before_zero_grad)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_before_zero_grad
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 callback.py:285(on_before_zero_grad)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_before_zero_grad
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 callback.py:285(on_before_zero_grad)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_before_zero_grad
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 callback.py:285(on_before_zero_grad)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelSummary.on_before_zero_grad
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 callback.py:285(on_before_zero_grad)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_zero_grad
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 callback.py:285(on_before_zero_grad)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_before_zero_grad
         350 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 hooks.py:257(on_before_zero_grad)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.optimizer_zero_grad
         8522 function calls (8520 primitive calls) in 0.013 seconds

   Ordered by: cumulative time
   List reduced from 101 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.013    0.000 module.py:1305(optimizer_zero_grad)
       50    0.000    0.000    0.013    0.000 _compile.py:20(inner)
       50    0.000    0.000    0.007    0.000 eval_frame.py:454(_fn)
       50    0.000    0.000    0.006    0.000 decorators.py:32(disable)
       50    0.002    0.000    0.005    0.000 optimizer.py:788(zero_grad)
       50    0.001    0.000    0.005    0.000 eval_frame.py:406(__call__)
       50    0.000    0.000    0.002    0.000 inspect.py:936(getsourcefile)
       50    0.000    0.000    0.002    0.000 profiler.py:604(__enter__)
       50    0.000    0.000    0.002    0.000 skipfiles.py:404(check)
       50    0.000    0.000    0.002    0.000 skipfiles.py:371(check_verbose)
       50    0.000    0.000    0.002    0.000 _ops.py:750(__call__)
       50    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
       50    0.000    0.000    0.001    0.000 <frozen genericpath>:16(exists)
       50    0.001    0.000    0.001    0.000 {built-in method posix.stat}
       50    0.000    0.000    0.001    0.000 profiler.py:610(__exit__)
      100    0.000    0.000    0.001    0.000 package_importer.py:695(_patched_getfile)
      100    0.000    0.000    0.001    0.000 inspect.py:896(getfile)
       50    0.000    0.000    0.001    0.000 skipfiles.py:304(check_file)
      150    0.000    0.000    0.001    0.000 {built-in method builtins.next}
      150    0.000    0.000    0.001    0.000 {built-in method builtins.any}



Profile stats for: [Strategy]SingleDeviceStrategy.backward
         1853 function calls (1803 primitive calls) in 0.174 seconds

   Ordered by: cumulative time
   List reduced from 31 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.174    0.003 strategy.py:192(backward)
       50    0.000    0.000    0.174    0.003 amp.py:61(pre_backward)
       50    0.000    0.000    0.173    0.003 precision.py:45(pre_backward)
       50    0.000    0.000    0.173    0.003 call.py:183(_call_callback_hooks)
       50    0.000    0.000    0.172    0.003 contextlib.py:132(__enter__)
       50    0.000    0.000    0.172    0.003 {built-in method builtins.next}
       50    0.000    0.000    0.172    0.003 profiler.py:55(profile)
       50    0.000    0.000    0.172    0.003 advanced.py:65(start)
       50    0.172    0.003    0.172    0.003 {method 'enable' of '_lsprof.Profiler' objects}
       50    0.001    0.000    0.001    0.000 grad_scaler.py:185(scale)
       50    0.000    0.000    0.000    0.000 module.py:1690(__setattr__)
       50    0.000    0.000    0.000    0.000 {method 'to' of 'torch._C.TensorBase' objects}
       50    0.000    0.000    0.000    0.000 __init__.py:1467(debug)
  200/150    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       50    0.000    0.000    0.000    0.000 contextlib.py:287(helper)
       50    0.000    0.000    0.000    0.000 module.py:207(trainer)
       50    0.000    0.000    0.000    0.000 parameter.py:8(__instancecheck__)
        1    0.000    0.000    0.000    0.000 grad_scaler.py:162(_lazy_init_scale_growth_tracker)
       50    0.000    0.000    0.000    0.000 contextlib.py:104(__init__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.full}



Profile stats for: [Callback]LearningRateMonitor.on_before_backward
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 callback.py:274(on_before_backward)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_before_backward
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:274(on_before_backward)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_before_backward
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:274(on_before_backward)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_before_backward
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:274(on_before_backward)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_before_backward
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:274(on_before_backward)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelSummary.on_before_backward
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:274(on_before_backward)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_backward
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:274(on_before_backward)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_before_backward
         350 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 hooks.py:278(on_before_backward)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]LearningRateMonitor.on_after_backward
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 callback.py:277(on_after_backward)
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_after_backward
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
       50    0.000    0.000    0.000    0.000 callback.py:277(on_after_backward)



Profile stats for: [Callback]HydraOptCallback.on_after_backward
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:277(on_after_backward)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_after_backward
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:277(on_after_backward)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_after_backward
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 callback.py:277(on_after_backward)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelSummary.on_after_backward
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:277(on_after_backward)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_after_backward
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:277(on_after_backward)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_after_backward
         350 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 hooks.py:287(on_after_backward)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]LearningRateMonitor.on_before_optimizer_step
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:280(on_before_optimizer_step)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_before_optimizer_step
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:280(on_before_optimizer_step)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_before_optimizer_step
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:280(on_before_optimizer_step)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_before_optimizer_step
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:280(on_before_optimizer_step)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_before_optimizer_step
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:280(on_before_optimizer_step)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelSummary.on_before_optimizer_step
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:280(on_before_optimizer_step)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_optimizer_step
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:280(on_before_optimizer_step)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_before_optimizer_step
         350 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 hooks.py:296(on_before_optimizer_step)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.configure_gradient_clipping
         1750 function calls in 0.001 seconds

   Ordered by: cumulative time
   List reduced from 26 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.001    0.000 module.py:1205(configure_gradient_clipping)
       50    0.000    0.000    0.001    0.000 module.py:1137(clip_gradients)
       50    0.000    0.000    0.001    0.000 enums.py:34(supported_type)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.any}
      150    0.000    0.000    0.000    0.000 enums.py:36(<genexpr>)
       50    0.000    0.000    0.000    0.000 amp.py:101(clip_gradients)
       50    0.000    0.000    0.000    0.000 enum.py:792(__iter__)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
      100    0.000    0.000    0.000    0.000 enum.py:193(__get__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      150    0.000    0.000    0.000    0.000 enum.py:796(<genexpr>)
       50    0.000    0.000    0.000    0.000 enum.py:686(__call__)
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
      200    0.000    0.000    0.000    0.000 module.py:207(trainer)
       50    0.000    0.000    0.000    0.000 trainer.py:1140(precision_plugin)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
      100    0.000    0.000    0.000    0.000 enum.py:1249(value)
       50    0.000    0.000    0.000    0.000 enum.py:1091(__new__)
       50    0.000    0.000    0.000    0.000 module.py:225(fabric)
       50    0.000    0.000    0.000    0.000 strategy.py:94(precision_plugin)



Profile stats for: [LightningModule]ImageClassifierModule.lr_scheduler_step
         938 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.001    0.000 module.py:1236(lr_scheduler_step)
       50    0.000    0.000    0.001    0.000 lr_scheduler.py:131(step)
       50    0.000    0.000    0.001    0.000 lr_scheduler.py:1759(get_lr)
      100    0.000    0.000    0.000    0.000 lr_scheduler.py:1748(_annealing_cos)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
      100    0.000    0.000    0.000    0.000 {built-in method math.cos}
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 lr_scheduler.py:181(__enter__)
       50    0.000    0.000    0.000    0.000 lr_scheduler.py:178(__init__)
       50    0.000    0.000    0.000    0.000 lr_scheduler.py:185(__exit__)
       50    0.000    0.000    0.000    0.000 lr_scheduler.py:167(<listcomp>)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       37    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       50    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}



Profile stats for: [Callback]LearningRateMonitor.on_train_batch_end
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:81(on_train_batch_end)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_train_batch_end
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:81(on_train_batch_end)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_train_batch_end
         8651 function calls in 0.009 seconds

   Ordered by: cumulative time
   List reduced from 39 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.001    0.000    0.009    0.000 optimization.py:97(on_train_batch_end)
       50    0.000    0.000    0.005    0.000 trainer.py:1617(callback_metrics)
       50    0.000    0.000    0.005    0.000 logger_connector.py:236(callback_metrics)
       50    0.000    0.000    0.004    0.000 logger_connector.py:229(metrics)
      400    0.004    0.000    0.004    0.000 {method 'item' of 'torch._C.TensorBase' objects}
       50    0.001    0.000    0.004    0.000 result.py:478(metrics)
       50    0.000    0.000    0.001    0.000 apply_func.py:113(convert_tensors_to_scalars)
       50    0.000    0.000    0.001    0.000 apply_func.py:23(apply_to_collection)
      150    0.000    0.000    0.001    0.000 trainer.py:1653(_results)
       50    0.000    0.000    0.001    0.000 apply_func.py:122(to_item)
      350    0.000    0.000    0.001    0.000 result.py:432(_get_cache)
      300    0.000    0.000    0.001    0.000 trainer.py:1392(training)
      300    0.000    0.000    0.001    0.000 enums.py:81(__eq__)
      350    0.001    0.000    0.001    0.000 {method 'detach' of 'torch._C.TensorBase' objects}
      150    0.000    0.000    0.001    0.000 trainer.py:1575(_active_loop)
      350    0.000    0.000    0.000    0.000 result.py:467(_forked_name)
      150    0.000    0.000    0.000    0.000 fit_loop.py:140(_results)
      400    0.000    0.000    0.000    0.000 result.py:465(<genexpr>)
      600    0.000    0.000    0.000    0.000 enum.py:193(__get__)
      350    0.000    0.000    0.000    0.000 result.py:158(forked_name)



Profile stats for: [Callback]PredictionLogger.on_train_batch_end
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:81(on_train_batch_end)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_train_batch_end
         124004 function calls in 0.034 seconds

   Ordered by: cumulative time
   List reduced from 109 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.034    0.001 tqdm_progress.py:269(on_train_batch_end)
      100    0.000    0.000    0.027    0.000 std.py:1325(refresh)
      100    0.000    0.000    0.026    0.000 std.py:1464(display)
      100    0.000    0.000    0.018    0.000 std.py:1150(__str__)
       50    0.000    0.000    0.016    0.000 tqdm_progress.py:451(_update_n)
      100    0.003    0.000    0.015    0.000 std.py:464(format_meter)
      300    0.000    0.000    0.014    0.000 utils.py:378(disp_len)
      300    0.000    0.000    0.014    0.000 utils.py:374(_text_width)
      300    0.003    0.000    0.013    0.000 {built-in method builtins.sum}
       50    0.000    0.000    0.012    0.000 std.py:1402(set_postfix)
    49652    0.008    0.000    0.010    0.000 utils.py:375(<genexpr>)
      100    0.000    0.000    0.008    0.000 std.py:457(print_status)
      100    0.000    0.000    0.006    0.000 utils.py:386(disp_trim)
       50    0.000    0.000    0.005    0.000 progress_bar.py:177(get_metrics)
       50    0.000    0.000    0.004    0.000 trainer.py:1643(progress_bar_metrics)
       50    0.000    0.000    0.004    0.000 logger_connector.py:250(progress_bar_metrics)
       50    0.000    0.000    0.003    0.000 logger_connector.py:229(metrics)
      100    0.001    0.000    0.003    0.000 std.py:1446(format_dict)
    49352    0.003    0.000    0.003    0.000 {built-in method unicodedata.east_asian_width}
       50    0.001    0.000    0.003    0.000 result.py:478(metrics)



Profile stats for: [Callback]ModelSummary.on_train_batch_end
         500 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
       50    0.000    0.000    0.000    0.000 callback.py:81(on_train_batch_end)
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_end
         1400 function calls in 0.001 seconds

   Ordered by: cumulative time
   List reduced from 22 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.001    0.000 model_checkpoint.py:285(on_train_batch_end)
       50    0.000    0.000    0.001    0.000 model_checkpoint.py:414(_should_skip_saving_checkpoint)
       50    0.000    0.000    0.000    0.000 trainer.py:1469(global_step)
       50    0.000    0.000    0.000    0.000 trainer.py:1440(sanity_checking)
       50    0.000    0.000    0.000    0.000 training_epoch_loop.py:99(global_step)
       50    0.000    0.000    0.000    0.000 enums.py:81(__eq__)
      100    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      100    0.000    0.000    0.000    0.000 enum.py:193(__get__)
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 progress.py:274(optimizer_steps)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
      100    0.000    0.000    0.000    0.000 enum.py:1249(value)
       50    0.000    0.000    0.000    0.000 {built-in method time.monotonic}
      100    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      100    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
       50    0.000    0.000    0.000    0.000 module.py:290(automatic_optimization)
      100    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)



Profile stats for: [LightningModule]ImageClassifierModule.on_train_batch_end
         350 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       50    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 profiler.py:55(profile)
       50    0.000    0.000    0.000    0.000 advanced.py:71(stop)
       50    0.000    0.000    0.000    0.000 hooks.py:80(on_train_batch_end)
       50    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       50    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_validation_model_zero_grad
         1795 function calls (1478 primitive calls) in 0.001 seconds

   Ordered by: cumulative time
   List reduced from 24 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 hooks.py:155(on_validation_model_zero_grad)
        1    0.000    0.000    0.001    0.001 module.py:2438(zero_grad)
       26    0.000    0.000    0.001    0.000 module.py:2171(parameters)
       26    0.000    0.000    0.001    0.000 module.py:2196(named_parameters)
       26    0.000    0.000    0.001    0.000 module.py:2157(_named_members)
   398/81    0.000    0.000    0.000    0.000 module.py:2333(named_modules)
       36    0.000    0.000    0.000    0.000 metric.py:944(__hash__)
      105    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
       80    0.000    0.000    0.000    0.000 module.py:2224(<lambda>)
       36    0.000    0.000    0.000    0.000 {built-in method builtins.hash}
      176    0.000    0.000    0.000    0.000 _tensor.py:1034(__hash__)
      127    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      212    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      126    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      160    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
      126    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
      126    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)



Profile stats for: [Callback]LearningRateMonitor.on_train_epoch_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 callback.py:95(on_train_epoch_end)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_train_epoch_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:95(on_train_epoch_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_train_epoch_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:95(on_train_epoch_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_train_epoch_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 callback.py:95(on_train_epoch_end)



Profile stats for: [Callback]TQDMProgressBar.on_train_epoch_end
         1339 function calls in 0.000 seconds

   Ordered by: cumulative time
   List reduced from 95 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:278(on_train_epoch_end)
        1    0.000    0.000    0.000    0.000 std.py:1402(set_postfix)
        1    0.000    0.000    0.000    0.000 std.py:1325(refresh)
        1    0.000    0.000    0.000    0.000 std.py:1464(display)
        1    0.000    0.000    0.000    0.000 std.py:1150(__str__)
        3    0.000    0.000    0.000    0.000 utils.py:378(disp_len)
        3    0.000    0.000    0.000    0.000 utils.py:374(_text_width)
        1    0.000    0.000    0.000    0.000 std.py:464(format_meter)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
      513    0.000    0.000    0.000    0.000 utils.py:375(<genexpr>)
        1    0.000    0.000    0.000    0.000 std.py:457(print_status)
        1    0.000    0.000    0.000    0.000 utils.py:386(disp_trim)
        1    0.000    0.000    0.000    0.000 progress_bar.py:177(get_metrics)
        1    0.000    0.000    0.000    0.000 trainer.py:1643(progress_bar_metrics)
        1    0.000    0.000    0.000    0.000 logger_connector.py:250(progress_bar_metrics)
        1    0.000    0.000    0.000    0.000 logger_connector.py:229(metrics)
      510    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
        3    0.000    0.000    0.000    0.000 trainer.py:1653(_results)
        1    0.000    0.000    0.000    0.000 std.py:1446(format_dict)
        1    0.000    0.000    0.000    0.000 result.py:478(metrics)



Profile stats for: [Callback]ModelSummary.on_train_epoch_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 callback.py:95(on_train_epoch_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_train_epoch_end
         9695 function calls (9044 primitive calls) in 0.139 seconds

   Ordered by: cumulative time
   List reduced from 119 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.139    0.139 base.py:221(on_train_epoch_end)
        1    0.000    0.000    0.138    0.138 rank_zero.py:36(wrapped_fn)
        1    0.000    0.000    0.138    0.138 base.py:250(_log_weight_distribution)
       25    0.000    0.000    0.137    0.005 writer.py:482(add_histogram)
       25    0.000    0.000    0.136    0.005 summary.py:465(histogram)
       25    0.002    0.000    0.108    0.004 summary.py:487(make_histogram)
       25    0.000    0.000    0.101    0.004 histograms.py:678(histogram)
       56    0.000    0.000    0.095    0.002 fromnumeric.py:865(sort)
       56    0.093    0.002    0.093    0.002 {method 'sort' of 'numpy.ndarray' objects}
       25    0.000    0.000    0.026    0.001 _convert_np.py:6(make_np)
       25    0.000    0.000    0.025    0.001 _convert_np.py:29(_prepare_pytorch)
       25    0.015    0.001    0.015    0.001 {method 'detach' of 'torch._C.TensorBase' objects}
       25    0.011    0.000    0.011    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}
       25    0.000    0.000    0.004    0.000 histograms.py:360(_get_bin_edges)
       25    0.003    0.000    0.003    0.000 {method 'dot' of 'numpy.ndarray' objects}
      100    0.003    0.000    0.003    0.000 {built-in method numpy.asarray}
       25    0.003    0.000    0.003    0.000 {method 'astype' of 'numpy.ndarray' objects}
       50    0.000    0.000    0.002    0.000 fromnumeric.py:3176(ndim)
       56    0.000    0.000    0.002    0.000 histograms.py:454(_search_sorted_inclusive)
       56    0.001    0.000    0.001    0.000 {method 'copy' of 'numpy.ndarray' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_end
         5155 function calls (4866 primitive calls) in 0.057 seconds

   Ordered by: cumulative time
   List reduced from 356 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.057    0.057 model_checkpoint.py:318(on_train_epoch_end)
        1    0.000    0.000    0.054    0.054 model_checkpoint.py:369(_save_topk_checkpoint)
        1    0.000    0.000    0.054    0.054 model_checkpoint.py:699(_save_monitor_checkpoint)
        1    0.000    0.000    0.054    0.054 model_checkpoint.py:719(_update_best_and_save)
        1    0.000    0.000    0.054    0.054 model_checkpoint.py:388(_save_checkpoint)
        1    0.000    0.000    0.054    0.054 trainer.py:1357(save_checkpoint)
        1    0.000    0.000    0.054    0.054 checkpoint_connector.py:404(dump_checkpoint)
        1    0.000    0.000    0.052    0.052 call.py:226(_call_callbacks_on_save_checkpoint)
        4    0.000    0.000    0.052    0.013 {built-in method builtins.next}
        2    0.000    0.000    0.052    0.026 contextlib.py:132(__enter__)
        1    0.000    0.000    0.052    0.052 profiler.py:55(profile)
        1    0.000    0.000    0.052    0.052 advanced.py:65(start)
        1    0.052    0.052    0.052    0.052 {method 'enable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.002    0.002 model_checkpoint.py:668(_monitor_candidates)
   147/71    0.000    0.000    0.002    0.000 copy.py:128(deepcopy)
     20/1    0.000    0.000    0.002    0.002 copy.py:227(_deepcopy_dict)
       19    0.000    0.000    0.002    0.000 _tensor.py:82(__deepcopy__)
       19    0.001    0.000    0.001    0.000 {method 'new_empty' of 'torch._C.TensorBase' objects}
        1    0.000    0.000    0.001    0.001 checkpoint_connector.py:499(_get_loops_state_dict)
      8/4    0.000    0.000    0.001    0.000 loop.py:52(state_dict)



Profile stats for: [Callback]LearningRateMonitor.on_save_checkpoint
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 callback.py:250(on_save_checkpoint)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_save_checkpoint
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 callback.py:250(on_save_checkpoint)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]HydraOptCallback.on_save_checkpoint
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 callback.py:250(on_save_checkpoint)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_save_checkpoint
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 callback.py:250(on_save_checkpoint)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_save_checkpoint
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 callback.py:250(on_save_checkpoint)



Profile stats for: [Callback]ModelSummary.on_save_checkpoint
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 callback.py:250(on_save_checkpoint)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_save_checkpoint
         20 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        2    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 callback.py:250(on_save_checkpoint)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_save_checkpoint
         16 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 base.py:325(on_save_checkpoint)
        2    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 utils.py:305(fullname)
        2    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]LearningRateMonitor.on_train_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 callback.py:208(on_train_end)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.on_train_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 callback.py:208(on_train_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)



Profile stats for: [Callback]HydraOptCallback.on_train_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 callback.py:208(on_train_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_train_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 callback.py:208(on_train_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_train_end
         1223 function calls in 0.000 seconds

   Ordered by: cumulative time
   List reduced from 75 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:283(on_train_end)
        1    0.000    0.000    0.000    0.000 std.py:1265(close)
        1    0.000    0.000    0.000    0.000 std.py:1464(display)
        1    0.000    0.000    0.000    0.000 std.py:1150(__str__)
        1    0.000    0.000    0.000    0.000 std.py:464(format_meter)
        3    0.000    0.000    0.000    0.000 utils.py:378(disp_len)
        3    0.000    0.000    0.000    0.000 utils.py:374(_text_width)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
      513    0.000    0.000    0.000    0.000 utils.py:375(<genexpr>)
        1    0.000    0.000    0.000    0.000 std.py:457(print_status)
        1    0.000    0.000    0.000    0.000 utils.py:386(disp_trim)
        1    0.000    0.000    0.000    0.000 std.py:686(_decr_instances)
        1    0.000    0.000    0.000    0.000 std.py:1446(format_dict)
      510    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
        1    0.000    0.000    0.000    0.000 utils.py:333(_screen_shape_linux)
        2    0.000    0.000    0.000    0.000 utils.py:273(_is_ascii)
        4    0.000    0.000    0.000    0.000 utils.py:194(inner)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:110(remove)
        2    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 std.py:451(fp_write)



Profile stats for: [Callback]ModelSummary.on_train_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 callback.py:208(on_train_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:208(on_train_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.on_train_end
         7 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 hooks.py:48(on_train_end)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Strategy]SingleDeviceStrategy.on_train_end
         7 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 strategy.py:563(on_train_end)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]LearningRateMonitor.on_fit_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 callback.py:67(on_fit_end)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)



Profile stats for: [Callback]MacSummaryCallback.on_fit_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 callback.py:67(on_fit_end)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: [Callback]HydraOptCallback.on_fit_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:67(on_fit_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]PredictionLogger.on_fit_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 callback.py:67(on_fit_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]TQDMProgressBar.on_fit_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 callback.py:67(on_fit_end)



Profile stats for: [Callback]ModelSummary.on_fit_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 callback.py:67(on_fit_end)



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 callback.py:67(on_fit_end)



Profile stats for: [LightningModule]ImageClassifierModule.on_fit_end
         7 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 hooks.py:38(on_fit_end)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]LearningRateMonitor.teardown
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:61(teardown)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]MacSummaryCallback.teardown
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 callback.py:61(teardown)



Profile stats for: [Callback]HydraOptCallback.teardown
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 callback.py:61(teardown)



Profile stats for: [Callback]PredictionLogger.teardown
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 callback.py:61(teardown)



Profile stats for: [Callback]TQDMProgressBar.teardown
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:61(teardown)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [Callback]ModelSummary.teardown
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 callback.py:61(teardown)



Profile stats for: [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown
         10 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1189(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1136(strategy)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 strategy.py:361(lightning_module)
        1    0.000    0.000    0.000    0.000 callback.py:61(teardown)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: [LightningModule]ImageClassifierModule.teardown
         7 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:141(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profiler.py:55(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:71(stop)
        1    0.000    0.000    0.000    0.000 hooks.py:445(teardown)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



[2024-05-16 18:30:32,171][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:30:32,172][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:30:32,576][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:30:32,594][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:30:32,770][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:33:13,937][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:33:13,944][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:33:13,944][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:33:14,601][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:33:14,614][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:33:14,791][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:33:15,333][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:33:15,348][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 1.54327  |     0 |       1 |
| val_accuracy        | 0.4277   |     0 |       1 |
| val_error           | 0.5723   |     0 |       1 |
| val_f1              | 0.411237 |     0 |       1 |
| val_precision       | 0.435905 |     0 |       1 |
| val_recall          | 0.4277   |     0 |       1 |
| val_loss            | 1.54327  |     0 |       1 |
[2024-05-16 18:33:26,331][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:33:26,425][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:33:26,425][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:33:26,428][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:33:26,428][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:33:26,428][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:33:26,428][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:33:26,428][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:33:26,429][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:33:26,429][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:33:26,430][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:33:26,430][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000 profiler=pytorch trainer.max_epochs=1
[2024-05-16 18:33:26,430][hannah.utils.utils][INFO] -   
[2024-05-16 18:33:26,431][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:33:26,438][root][INFO] - Configuration: 
[2024-05-16 18:33:26,442][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 1
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
profiler:
  _target_: pytorch_lightning.profilers.PyTorchProfiler
  dirpath: profile
  filename: profile
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:33:26,442][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:33:26,962][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:33:26,962][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:33:27,017][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:33:27,042][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:33:27,049][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:33:27,049][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:33:27,049][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:33:27,049][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:33:27,049][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:33:27,049][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:33:27,049][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:33:27,049][root][INFO] - Starting training
[2024-05-16 18:33:32,540][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:33:32,540][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:33:33,022][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 50000
[2024-05-16 18:33:33,022][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:33:33,093][hannah.modules.vision.base][INFO] -   Dev Set: 10000
[2024-05-16 18:33:33,162][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:33:34,002][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:33:34,017][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.4914, 0.4822, 0.4465), std: (0.2023, 0.1994, 0.201)
[2024-05-16 18:33:34,023][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:33:34,030][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:33:34,036][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:33:35,701][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:33:37,231][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:33:37,231][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:33:37,232][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:33:37,232][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:33:37,232][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:33:37,700][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:34:02,415][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 50: 'val_error' reached 0.57230 (best 0.57230), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt' as top 1
[2024-05-16 18:34:02,472][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer.fit` stopped: `max_epochs=1` reached.
[2024-05-16 18:34:02,616][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:34:02,617][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:34:02,860][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:34:02,870][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:34:03,113][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:34:49,487][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:34:49,494][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:34:49,494][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:34:49,736][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:34:49,747][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:34:49,984][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:34:56,848][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:34:56,864][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 1.54327  |     0 |       1 |
| val_accuracy        | 0.4277   |     0 |       1 |
| val_error           | 0.5723   |     0 |       1 |
| val_f1              | 0.411237 |     0 |       1 |
| val_precision       | 0.435905 |     0 |       1 |
| val_recall          | 0.4277   |     0 |       1 |
| val_loss            | 1.54327  |     0 |       1 |
[2024-05-16 18:35:09,962][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:35:10,055][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:35:10,056][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:35:10,059][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:35:10,059][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:35:10,059][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:35:10,059][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:35:10,059][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:35:10,059][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:35:10,059][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:35:10,061][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:35:10,061][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000 profiler=simple trainer.max_epochs=1
[2024-05-16 18:35:10,061][hannah.utils.utils][INFO] -   
[2024-05-16 18:35:10,062][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:35:10,085][root][INFO] - Configuration: 
[2024-05-16 18:35:10,088][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 1
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
profiler:
  _target_: pytorch_lightning.profilers.SimpleProfiler
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:35:10,088][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:35:10,600][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:35:10,601][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:35:10,656][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:35:10,680][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:35:10,687][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:35:10,687][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:35:10,687][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:35:10,687][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:35:10,687][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:35:10,687][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:35:10,687][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:35:10,687][root][INFO] - Starting training
[2024-05-16 18:35:16,128][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:35:16,128][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:35:16,605][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 50000
[2024-05-16 18:35:16,605][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:35:16,675][hannah.modules.vision.base][INFO] -   Dev Set: 10000
[2024-05-16 18:35:16,744][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:35:17,802][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:35:17,826][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.4914, 0.4822, 0.4465), std: (0.2023, 0.1994, 0.201)
[2024-05-16 18:35:17,832][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:35:17,838][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:35:17,844][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:35:19,286][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:35:20,766][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:35:20,766][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:35:20,766][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:35:20,766][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:35:20,766][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:35:21,153][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:35:31,978][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 50: 'val_error' reached 0.57230 (best 0.57230), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt' as top 1
[2024-05-16 18:35:32,031][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer.fit` stopped: `max_epochs=1` reached.
[2024-05-16 18:35:32,054][pytorch_lightning.profilers.profiler][INFO] - FIT Profiler Report

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                 	|  -              	|  3493           	|  21.456         	|  100 %          	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                    	|  11.08          	|  1              	|  11.08          	|  51.641         	|
|  run_training_batch                                                                                                                                                    	|  0.21727        	|  50             	|  10.864         	|  50.633         	|
|  [LightningModule]ImageClassifierModule.optimizer_step                                                                                                                 	|  0.2172         	|  50             	|  10.86          	|  50.616         	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                          	|  0.2023         	|  50             	|  10.115         	|  47.145         	|
|  [LightningModule]ImageClassifierModule.prepare_data                                                                                                                   	|  5.1034         	|  1              	|  5.1034         	|  23.786         	|
|  [LightningModule]ImageClassifierModule.setup                                                                                                                          	|  1.7113         	|  1              	|  1.7113         	|  7.9761         	|
|  [LightningModule]ImageClassifierModule.configure_optimizers                                                                                                           	|  1.2784         	|  1              	|  1.2784         	|  5.9583         	|
|  [LightningModule]ImageClassifierModule.train_dataloader                                                                                                               	|  1.135          	|  1              	|  1.135          	|  5.2902         	|
|  [_EvaluationLoop].val_next                                                                                                                                            	|  0.057063       	|  12             	|  0.68476        	|  3.1915         	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                        	|  0.022963       	|  12             	|  0.27555        	|  1.2843         	|
|  [LightningModule]ImageClassifierModule.val_dataloader                                                                                                                 	|  0.1761         	|  1              	|  0.1761         	|  0.82078        	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                               	|  0.0034704      	|  50             	|  0.17352        	|  0.80874        	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                   	|  0.16451        	|  1              	|  0.16451        	|  0.76674        	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_end                                                                                                             	|  0.12882        	|  1              	|  0.12882        	|  0.60041        	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_end       	|  0.054636       	|  1              	|  0.054636       	|  0.25465        	|
|  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                          	|  0.00034699     	|  50             	|  0.01735        	|  0.080863       	|
|  [Callback]MacSummaryCallback.on_validation_epoch_end                                                                                                                  	|  0.0072259      	|  2              	|  0.014452       	|  0.067357       	|
|  [LightningModule]ImageClassifierModule.optimizer_zero_grad                                                                                                            	|  0.0001942      	|  50             	|  0.0097098      	|  0.045255       	|
|  [Callback]HydraOptCallback.on_train_batch_end                                                                                                                         	|  0.00013665     	|  50             	|  0.0068324      	|  0.031844       	|
|  [_TrainingEpochLoop].train_dataloader_next                                                                                                                            	|  0.00013457     	|  50             	|  0.0067285      	|  0.03136        	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                        	|  0.00010281     	|  62             	|  0.0063744      	|  0.02971        	|
|  [Callback]MacSummaryCallback.on_train_start                                                                                                                           	|  0.0060871      	|  1              	|  0.0060871      	|  0.028371       	|
|  [LightningModule]ImageClassifierModule.transfer_batch_to_device                                                                                                       	|  8.4477e-05     	|  64             	|  0.0054065      	|  0.025199       	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                     	|  0.00013223     	|  12             	|  0.0015867      	|  0.0073955      	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                       	|  0.00091604     	|  1              	|  0.00091604     	|  0.0042695      	|
|  [LightningModule]ImageClassifierModule.configure_gradient_clipping                                                                                                    	|  1.6538e-05     	|  50             	|  0.00082691     	|  0.0038541      	|
|  [LightningModule]ImageClassifierModule.lr_scheduler_step                                                                                                              	|  1.6497e-05     	|  50             	|  0.00082484     	|  0.0038444      	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                   	|  5.9568e-05     	|  12             	|  0.00071481     	|  0.0033316      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_end       	|  1.1388e-05     	|  50             	|  0.0005694      	|  0.0026539      	|
|  [LightningModule]ImageClassifierModule.on_validation_model_eval                                                                                                       	|  0.00023669     	|  2              	|  0.00047337     	|  0.0022063      	|
|  [Callback]LearningRateMonitor.on_train_batch_start                                                                                                                    	|  8.67e-06       	|  50             	|  0.0004335      	|  0.0020204      	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                           	|  0.00020749     	|  2              	|  0.00041497     	|  0.0019341      	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                         	|  0.00013578     	|  2              	|  0.00027156     	|  0.0012657      	|
|  [LightningModule]ImageClassifierModule.on_validation_model_zero_grad                                                                                                  	|  0.00026272     	|  1              	|  0.00026272     	|  0.0012245      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                    	|  0.0002238      	|  1              	|  0.0002238      	|  0.0010431      	|
|  [Callback]HydraOptCallback.on_validation_end                                                                                                                          	|  9.6535e-05     	|  2              	|  0.00019307     	|  0.00089986     	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                	|  0.00018803     	|  1              	|  0.00018803     	|  0.00087638     	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                        	|  0.00016736     	|  1              	|  0.00016736     	|  0.00078003     	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                              	|  0.00016398     	|  1              	|  0.00016398     	|  0.00076426     	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                          	|  0.00013446     	|  1              	|  0.00013446     	|  0.0006267      	|
|  [Callback]LearningRateMonitor.on_before_zero_grad                                                                                                                     	|  1.5613e-06     	|  50             	|  7.8064e-05     	|  0.00036384     	|
|  [Callback]LearningRateMonitor.on_train_batch_end                                                                                                                      	|  1.4685e-06     	|  50             	|  7.3424e-05     	|  0.00034221     	|
|  [Callback]LearningRateMonitor.on_before_backward                                                                                                                      	|  1.4195e-06     	|  50             	|  7.0974e-05     	|  0.00033079     	|
|  [Callback]ModelSummary.on_train_batch_end                                                                                                                             	|  1.4009e-06     	|  50             	|  7.0044e-05     	|  0.00032646     	|
|  [Callback]LearningRateMonitor.on_after_backward                                                                                                                       	|  1.2227e-06     	|  50             	|  6.1133e-05     	|  0.00028493     	|
|  [Callback]LearningRateMonitor.on_before_optimizer_step                                                                                                                	|  1.2044e-06     	|  50             	|  6.022e-05      	|  0.00028067     	|
|  [Callback]MacSummaryCallback.on_train_batch_start                                                                                                                     	|  9.8779e-07     	|  50             	|  4.939e-05      	|  0.00023019     	|
|  [Callback]PredictionLogger.on_train_batch_end                                                                                                                         	|  9.8202e-07     	|  50             	|  4.9101e-05     	|  0.00022885     	|
|  [LightningModule]ImageClassifierModule.on_before_batch_transfer                                                                                                       	|  7.4085e-07     	|  64             	|  4.7414e-05     	|  0.00022099     	|
|  [Callback]MacSummaryCallback.on_before_zero_grad                                                                                                                      	|  9.2281e-07     	|  50             	|  4.6141e-05     	|  0.00021505     	|
|  [LightningModule]ImageClassifierModule.on_train_batch_end                                                                                                             	|  7.7859e-07     	|  50             	|  3.893e-05      	|  0.00018144     	|
|  [LightningModule]ImageClassifierModule.on_before_zero_grad                                                                                                            	|  7.2108e-07     	|  50             	|  3.6054e-05     	|  0.00016804     	|
|  [Callback]PredictionLogger.on_before_zero_grad                                                                                                                        	|  7.2032e-07     	|  50             	|  3.6016e-05     	|  0.00016786     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_zero_grad      	|  6.9566e-07     	|  50             	|  3.4783e-05     	|  0.00016212     	|
|  [Callback]MacSummaryCallback.on_after_backward                                                                                                                        	|  6.895e-07      	|  50             	|  3.4475e-05     	|  0.00016068     	|
|  [LightningModule]ImageClassifierModule.on_after_batch_transfer                                                                                                        	|  5.3516e-07     	|  64             	|  3.425e-05      	|  0.00015963     	|
|  [Callback]MacSummaryCallback.on_before_optimizer_step                                                                                                                 	|  6.8417e-07     	|  50             	|  3.4209e-05     	|  0.00015944     	|
|  [Callback]HydraOptCallback.on_before_zero_grad                                                                                                                        	|  6.778e-07      	|  50             	|  3.389e-05      	|  0.00015795     	|
|  [Callback]MacSummaryCallback.on_train_batch_end                                                                                                                       	|  6.5682e-07     	|  50             	|  3.2841e-05     	|  0.00015307     	|
|  [Callback]PredictionLogger.on_validation_batch_end                                                                                                                    	|  2.6449e-06     	|  12             	|  3.1739e-05     	|  0.00014793     	|
|  [Callback]HydraOptCallback.on_before_backward                                                                                                                         	|  6.3044e-07     	|  50             	|  3.1522e-05     	|  0.00014692     	|
|  [LightningModule]ImageClassifierModule.on_before_backward                                                                                                             	|  6.151e-07      	|  50             	|  3.0755e-05     	|  0.00014334     	|
|  [Callback]HydraOptCallback.on_before_optimizer_step                                                                                                                   	|  6.0885e-07     	|  50             	|  3.0442e-05     	|  0.00014189     	|
|  [Callback]MacSummaryCallback.on_before_backward                                                                                                                       	|  6.0776e-07     	|  50             	|  3.0388e-05     	|  0.00014163     	|
|  [Callback]PredictionLogger.on_before_backward                                                                                                                         	|  6.0351e-07     	|  50             	|  3.0175e-05     	|  0.00014064     	|
|  [LightningModule]ImageClassifierModule.on_after_backward                                                                                                              	|  5.9667e-07     	|  50             	|  2.9833e-05     	|  0.00013905     	|
|  [Callback]LearningRateMonitor.on_train_start                                                                                                                          	|  2.9824e-05     	|  1              	|  2.9824e-05     	|  0.000139       	|
|  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                        	|  5.8855e-07     	|  50             	|  2.9427e-05     	|  0.00013716     	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                          	|  5.8608e-07     	|  50             	|  2.9304e-05     	|  0.00013658     	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                             	|  5.8382e-07     	|  50             	|  2.9191e-05     	|  0.00013605     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_start     	|  5.835e-07      	|  50             	|  2.9175e-05     	|  0.00013598     	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                       	|  5.7914e-07     	|  50             	|  2.8957e-05     	|  0.00013496     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_backward       	|  5.7431e-07     	|  50             	|  2.8716e-05     	|  0.00013384     	|
|  [Callback]HydraOptCallback.on_after_backward                                                                                                                          	|  5.743e-07      	|  50             	|  2.8715e-05     	|  0.00013383     	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                           	|  5.6801e-07     	|  50             	|  2.8401e-05     	|  0.00013237     	|
|  [Callback]PredictionLogger.on_after_backward                                                                                                                          	|  5.6222e-07     	|  50             	|  2.8111e-05     	|  0.00013102     	|
|  [LightningModule]ImageClassifierModule.on_before_optimizer_step                                                                                                       	|  5.607e-07      	|  50             	|  2.8035e-05     	|  0.00013067     	|
|  [LightningModule]ImageClassifierModule.on_train_batch_start                                                                                                           	|  5.4781e-07     	|  50             	|  2.7391e-05     	|  0.00012766     	|
|  [Callback]HydraOptCallback.on_train_batch_start                                                                                                                       	|  5.4256e-07     	|  50             	|  2.7128e-05     	|  0.00012644     	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                            	|  5.3018e-07     	|  50             	|  2.6509e-05     	|  0.00012355     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_optimizer_step 	|  5.2844e-07     	|  50             	|  2.6422e-05     	|  0.00012315     	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                         	|  5.2835e-07     	|  50             	|  2.6418e-05     	|  0.00012313     	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                   	|  5.2616e-07     	|  50             	|  2.6308e-05     	|  0.00012262     	|
|  [Callback]ModelSummary.on_train_batch_start                                                                                                                           	|  5.1617e-07     	|  50             	|  2.5808e-05     	|  0.00012029     	|
|  [Callback]PredictionLogger.on_train_batch_start                                                                                                                       	|  5.0593e-07     	|  50             	|  2.5296e-05     	|  0.0001179      	|
|  [Callback]PredictionLogger.on_before_optimizer_step                                                                                                                   	|  4.9998e-07     	|  50             	|  2.4999e-05     	|  0.00011652     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_after_backward        	|  4.9973e-07     	|  50             	|  2.4986e-05     	|  0.00011646     	|
|  [Callback]LearningRateMonitor.on_train_epoch_start                                                                                                                    	|  2.4897e-05     	|  1              	|  2.4897e-05     	|  0.00011604     	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                    	|  4.856e-07      	|  50             	|  2.428e-05      	|  0.00011316     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end        	|  1.1889e-05     	|  2              	|  2.3777e-05     	|  0.00011082     	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                              	|  4.5829e-07     	|  50             	|  2.2914e-05     	|  0.0001068      	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_end                                                                                                        	|  9.5394e-06     	|  2              	|  1.9079e-05     	|  8.8922e-05     	|
|  [Callback]LearningRateMonitor.on_validation_batch_end                                                                                                                 	|  1.5333e-06     	|  12             	|  1.84e-05       	|  8.5759e-05     	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                        	|  1.1561e-06     	|  12             	|  1.3873e-05     	|  6.4659e-05     	|
|  [Callback]LearningRateMonitor.on_validation_batch_start                                                                                                               	|  1.0705e-06     	|  12             	|  1.2846e-05     	|  5.9874e-05     	|
|  [Callback]MacSummaryCallback.on_validation_batch_end                                                                                                                  	|  9.015e-07      	|  12             	|  1.0818e-05     	|  5.042e-05      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end  	|  8.3285e-07     	|  12             	|  9.9943e-06     	|  4.6581e-05     	|
|  [Callback]HydraOptCallback.on_validation_batch_end                                                                                                                    	|  7.5121e-07     	|  12             	|  9.0145e-06     	|  4.2015e-05     	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                      	|  7.0767e-07     	|  12             	|  8.492e-06      	|  3.958e-05      	|
|  [Callback]PredictionLogger.on_validation_epoch_end                                                                                                                    	|  4.0355e-06     	|  2              	|  8.0711e-06     	|  3.7618e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start	|  6.4504e-07     	|  12             	|  7.7405e-06     	|  3.6077e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_end                                                                                                        	|  6.275e-07      	|  12             	|  7.53e-06       	|  3.5096e-05     	|
|  [Callback]MacSummaryCallback.on_validation_batch_start                                                                                                                	|  5.8151e-07     	|  12             	|  6.9782e-06     	|  3.2524e-05     	|
|  [Callback]HydraOptCallback.on_validation_batch_start                                                                                                                  	|  5.708e-07      	|  12             	|  6.8496e-06     	|  3.1925e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_start                                                                                                      	|  5.1754e-07     	|  12             	|  6.2105e-06     	|  2.8946e-05     	|
|  [Callback]PredictionLogger.on_validation_batch_start                                                                                                                  	|  5.164e-07      	|  12             	|  6.1968e-06     	|  2.8882e-05     	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                              	|  2.694e-06      	|  2              	|  5.3879e-06     	|  2.5112e-05     	|
|  [LightningModule]ImageClassifierModule.on_save_checkpoint                                                                                                             	|  2.684e-06      	|  2              	|  5.3679e-06     	|  2.5019e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                      	|  2.5985e-06     	|  2              	|  5.197e-06      	|  2.4222e-05     	|
|  [Callback]LearningRateMonitor.setup                                                                                                                                   	|  3.6962e-06     	|  1              	|  3.6962e-06     	|  1.7227e-05     	|
|  [Callback]LearningRateMonitor.on_save_checkpoint                                                                                                                      	|  1.8079e-06     	|  2              	|  3.6159e-06     	|  1.6853e-05     	|
|  [Callback]HydraOptCallback.on_validation_epoch_end                                                                                                                    	|  1.5926e-06     	|  2              	|  3.1851e-06     	|  1.4845e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start             	|  3.1539e-06     	|  1              	|  3.1539e-06     	|  1.47e-05       	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                       	|  3.1251e-06     	|  1              	|  3.1251e-06     	|  1.4565e-05     	|
|  [Callback]LearningRateMonitor.on_sanity_check_start                                                                                                                   	|  3.085e-06      	|  1              	|  3.085e-06      	|  1.4379e-05     	|
|  [Callback]LearningRateMonitor.on_validation_end                                                                                                                       	|  1.4475e-06     	|  2              	|  2.895e-06      	|  1.3493e-05     	|
|  [LightningModule]ImageClassifierModule.configure_callbacks                                                                                                            	|  2.864e-06      	|  1              	|  2.864e-06      	|  1.3349e-05     	|
|  [LightningModule]ImageClassifierModule.on_fit_start                                                                                                                   	|  2.6738e-06     	|  1              	|  2.6738e-06     	|  1.2462e-05     	|
|  [Callback]LearningRateMonitor.on_validation_start                                                                                                                     	|  1.312e-06      	|  2              	|  2.624e-06      	|  1.223e-05      	|
|  [Callback]LearningRateMonitor.on_validation_epoch_end                                                                                                                 	|  1.1971e-06     	|  2              	|  2.3942e-06     	|  1.1159e-05     	|
|  [Callback]PredictionLogger.setup                                                                                                                                      	|  2.323e-06      	|  1              	|  2.323e-06      	|  1.0827e-05     	|
|  [Callback]HydraOptCallback.on_train_start                                                                                                                             	|  2.1439e-06     	|  1              	|  2.1439e-06     	|  9.9923e-06     	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                         	|  2.1232e-06     	|  1              	|  2.1232e-06     	|  9.8957e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_start                                                                                                                 	|  2.0128e-06     	|  1              	|  2.0128e-06     	|  9.3813e-06     	|
|  [Callback]MacSummaryCallback.on_save_checkpoint                                                                                                                       	|  9.9605e-07     	|  2              	|  1.9921e-06     	|  9.2847e-06     	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                            	|  9.666e-07      	|  2              	|  1.9332e-06     	|  9.0102e-06     	|
|  [Callback]LearningRateMonitor.on_validation_epoch_start                                                                                                               	|  9.5146e-07     	|  2              	|  1.9029e-06     	|  8.8691e-06     	|
|  [Callback]PredictionLogger.on_validation_end                                                                                                                          	|  9.0653e-07     	|  2              	|  1.8131e-06     	|  8.4502e-06     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                     	|  8.8592e-07     	|  2              	|  1.7718e-06     	|  8.2582e-06     	|
|  [Callback]LearningRateMonitor.on_fit_start                                                                                                                            	|  1.732e-06      	|  1              	|  1.732e-06      	|  8.0726e-06     	|
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                          	|  8.3109e-07     	|  2              	|  1.6622e-06     	|  7.7471e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_start           	|  1.6419e-06     	|  1              	|  1.6419e-06     	|  7.6526e-06     	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                          	|  1.6319e-06     	|  1              	|  1.6319e-06     	|  7.606e-06      	|
|  [Callback]LearningRateMonitor.on_fit_end                                                                                                                              	|  1.6131e-06     	|  1              	|  1.6131e-06     	|  7.5181e-06     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                    	|  8.0105e-07     	|  2              	|  1.6021e-06     	|  7.4671e-06     	|
|  [Callback]MacSummaryCallback.setup                                                                                                                                    	|  1.593e-06      	|  1              	|  1.593e-06      	|  7.4248e-06     	|
|  [Callback]LearningRateMonitor.on_train_end                                                                                                                            	|  1.5621e-06     	|  1              	|  1.5621e-06     	|  7.2804e-06     	|
|  [Callback]MacSummaryCallback.on_validation_end                                                                                                                        	|  7.7649e-07     	|  2              	|  1.553e-06      	|  7.2381e-06     	|
|  [LightningModule]ImageClassifierModule.on_validation_end                                                                                                              	|  7.4599e-07     	|  2              	|  1.492e-06      	|  6.9538e-06     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                      	|  7.2096e-07     	|  2              	|  1.4419e-06     	|  6.7205e-06     	|
|  [Callback]MacSummaryCallback.on_validation_start                                                                                                                      	|  7.1153e-07     	|  2              	|  1.4231e-06     	|  6.6326e-06     	|
|  [Callback]LearningRateMonitor.teardown                                                                                                                                	|  1.4219e-06     	|  1              	|  1.4219e-06     	|  6.6272e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_save_checkpoint       	|  6.9104e-07     	|  2              	|  1.3821e-06     	|  6.4416e-06     	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                        	|  6.8091e-07     	|  2              	|  1.3618e-06     	|  6.3472e-06     	|
|  [LightningModule]ImageClassifierModule.on_validation_start                                                                                                            	|  6.7102e-07     	|  2              	|  1.342e-06      	|  6.2549e-06     	|
|  [Callback]LearningRateMonitor.on_sanity_check_end                                                                                                                     	|  1.342e-06      	|  1              	|  1.342e-06      	|  6.2549e-06     	|
|  [Callback]HydraOptCallback.on_save_checkpoint                                                                                                                         	|  6.709e-07      	|  2              	|  1.3418e-06     	|  6.2539e-06     	|
|  [Callback]HydraOptCallback.on_validation_start                                                                                                                        	|  6.56e-07       	|  2              	|  1.312e-06      	|  6.115e-06      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end  	|  6.3598e-07     	|  2              	|  1.272e-06      	|  5.9283e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start      	|  6.1607e-07     	|  2              	|  1.2321e-06     	|  5.7427e-06     	|
|  [Callback]ModelSummary.setup                                                                                                                                          	|  1.2319e-06     	|  1              	|  1.2319e-06     	|  5.7417e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start	|  6.1549e-07     	|  2              	|  1.231e-06      	|  5.7373e-06     	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                 	|  1.2221e-06     	|  1              	|  1.2221e-06     	|  5.6961e-06     	|
|  [Callback]LearningRateMonitor.on_train_epoch_end                                                                                                                      	|  1.1621e-06     	|  1              	|  1.1621e-06     	|  5.4161e-06     	|
|  [Callback]PredictionLogger.on_validation_epoch_start                                                                                                                  	|  5.56e-07       	|  2              	|  1.112e-06      	|  5.1828e-06     	|
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                             	|  5.4541e-07     	|  2              	|  1.0908e-06     	|  5.084e-06      	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_start                                                                                                      	|  5.3598e-07     	|  2              	|  1.072e-06      	|  4.9961e-06     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                   	|  5.305e-07      	|  2              	|  1.061e-06      	|  4.9451e-06     	|
|  [Callback]PredictionLogger.on_validation_start                                                                                                                        	|  5.2096e-07     	|  2              	|  1.0419e-06     	|  4.8562e-06     	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                   	|  1.0121e-06     	|  1              	|  1.0121e-06     	|  4.7172e-06     	|
|  [Callback]PredictionLogger.on_sanity_check_start                                                                                                                      	|  1.0119e-06     	|  1              	|  1.0119e-06     	|  4.7162e-06     	|
|  [Callback]MacSummaryCallback.on_validation_epoch_start                                                                                                                	|  5.0594e-07     	|  2              	|  1.0119e-06     	|  4.7162e-06     	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                             	|  1.0012e-06     	|  1              	|  1.0012e-06     	|  4.6662e-06     	|
|  [Callback]PredictionLogger.on_save_checkpoint                                                                                                                         	|  4.9057e-07     	|  2              	|  9.8115e-07     	|  4.5729e-06     	|
|  [Callback]MacSummaryCallback.on_train_epoch_start                                                                                                                     	|  9.7114e-07     	|  1              	|  9.7114e-07     	|  4.5263e-06     	|
|  [Callback]HydraOptCallback.setup                                                                                                                                      	|  9.5111e-07     	|  1              	|  9.5111e-07     	|  4.4329e-06     	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                           	|  9.5111e-07     	|  1              	|  9.5111e-07     	|  4.4329e-06     	|
|  [LightningModule]ImageClassifierModule.teardown                                                                                                                       	|  9.5111e-07     	|  1              	|  9.5111e-07     	|  4.4329e-06     	|
|  [Callback]HydraOptCallback.on_validation_epoch_start                                                                                                                  	|  4.7544e-07     	|  2              	|  9.5088e-07     	|  4.4318e-06     	|
|  [Callback]PredictionLogger.on_train_start                                                                                                                             	|  8.8103e-07     	|  1              	|  8.8103e-07     	|  4.1063e-06     	|
|  [Callback]MacSummaryCallback.on_sanity_check_start                                                                                                                    	|  8.4098e-07     	|  1              	|  8.4098e-07     	|  3.9196e-06     	|
|  [Callback]MacSummaryCallback.on_fit_end                                                                                                                               	|  8.2189e-07     	|  1              	|  8.2189e-07     	|  3.8307e-06     	|
|  [Callback]MacSummaryCallback.on_fit_start                                                                                                                             	|  8.1095e-07     	|  1              	|  8.1095e-07     	|  3.7797e-06     	|
|  [Callback]MacSummaryCallback.on_sanity_check_end                                                                                                                      	|  7.6205e-07     	|  1              	|  7.6205e-07     	|  3.5518e-06     	|
|  [Callback]HydraOptCallback.on_train_end                                                                                                                               	|  7.6112e-07     	|  1              	|  7.6112e-07     	|  3.5474e-06     	|
|  [Callback]MacSummaryCallback.teardown                                                                                                                                 	|  7.6112e-07     	|  1              	|  7.6112e-07     	|  3.5474e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_end                                                                                                                   	|  7.5204e-07     	|  1              	|  7.5204e-07     	|  3.5051e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_start    	|  7.411e-07      	|  1              	|  7.411e-07      	|  3.4541e-06     	|
|  [Callback]HydraOptCallback.on_sanity_check_start                                                                                                                      	|  7.3109e-07     	|  1              	|  7.3109e-07     	|  3.4074e-06     	|
|  [Callback]MacSummaryCallback.on_train_end                                                                                                                             	|  7.3109e-07     	|  1              	|  7.3109e-07     	|  3.4074e-06     	|
|  [Callback]PredictionLogger.on_fit_start                                                                                                                               	|  7.1106e-07     	|  1              	|  7.1106e-07     	|  3.3141e-06     	|
|  [LightningModule]ImageClassifierModule.on_fit_end                                                                                                                     	|  7.1106e-07     	|  1              	|  7.1106e-07     	|  3.3141e-06     	|
|  [Callback]PredictionLogger.on_fit_end                                                                                                                                 	|  7.1083e-07     	|  1              	|  7.1083e-07     	|  3.313e-06      	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                         	|  6.7102e-07     	|  1              	|  6.7102e-07     	|  3.1275e-06     	|
|  [Callback]ModelSummary.teardown                                                                                                                                       	|  6.7102e-07     	|  1              	|  6.7102e-07     	|  3.1275e-06     	|
|  [Callback]HydraOptCallback.on_fit_start                                                                                                                               	|  6.6101e-07     	|  1              	|  6.6101e-07     	|  3.0808e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_start                                                                                                           	|  6.5099e-07     	|  1              	|  6.5099e-07     	|  3.0341e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                 	|  6.5099e-07     	|  1              	|  6.5099e-07     	|  3.0341e-06     	|
|  [Callback]HydraOptCallback.teardown                                                                                                                                   	|  6.5006e-07     	|  1              	|  6.5006e-07     	|  3.0298e-06     	|
|  [Callback]HydraOptCallback.on_fit_end                                                                                                                                 	|  6.3097e-07     	|  1              	|  6.3097e-07     	|  2.9408e-06     	|
|  [Callback]HydraOptCallback.on_sanity_check_end                                                                                                                        	|  6.2096e-07     	|  1              	|  6.2096e-07     	|  2.8942e-06     	|
|  [Callback]MacSummaryCallback.on_train_epoch_end                                                                                                                       	|  6.2096e-07     	|  1              	|  6.2096e-07     	|  2.8942e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_end      	|  6.2003e-07     	|  1              	|  6.2003e-07     	|  2.8898e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_start     	|  6.1002e-07     	|  1              	|  6.1002e-07     	|  2.8432e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_end             	|  5.9092e-07     	|  1              	|  5.9092e-07     	|  2.7542e-06     	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                            	|  5.8999e-07     	|  1              	|  5.8999e-07     	|  2.7498e-06     	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                           	|  5.8999e-07     	|  1              	|  5.8999e-07     	|  2.7498e-06     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                     	|  5.8091e-07     	|  1              	|  5.8091e-07     	|  2.7075e-06     	|
|  [Callback]HydraOptCallback.on_train_epoch_start                                                                                                                       	|  5.7113e-07     	|  1              	|  5.7113e-07     	|  2.6619e-06     	|
|  [Callback]PredictionLogger.on_train_end                                                                                                                               	|  5.709e-07      	|  1              	|  5.709e-07      	|  2.6608e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end               	|  5.6997e-07     	|  1              	|  5.6997e-07     	|  2.6565e-06     	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                	|  5.6089e-07     	|  1              	|  5.6089e-07     	|  2.6142e-06     	|
|  [Callback]HydraOptCallback.on_train_epoch_end                                                                                                                         	|  5.5111e-07     	|  1              	|  5.5111e-07     	|  2.5686e-06     	|
|  [Callback]PredictionLogger.teardown                                                                                                                                   	|  5.5088e-07     	|  1              	|  5.5088e-07     	|  2.5675e-06     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                    	|  5.5088e-07     	|  1              	|  5.5088e-07     	|  2.5675e-06     	|
|  [Callback]PredictionLogger.on_train_epoch_end                                                                                                                         	|  5.2107e-07     	|  1              	|  5.2107e-07     	|  2.4286e-06     	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                  	|  5.099e-07      	|  1              	|  5.099e-07      	|  2.3765e-06     	|
|  [Callback]PredictionLogger.on_sanity_check_end                                                                                                                        	|  4.8103e-07     	|  1              	|  4.8103e-07     	|  2.242e-06      	|
|  [Callback]PredictionLogger.on_train_epoch_start                                                                                                                       	|  4.3097e-07     	|  1              	|  4.3097e-07     	|  2.0087e-06     	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[2024-05-16 18:35:32,056][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:35:32,056][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:35:32,286][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:35:32,300][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:35:32,709][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:39:49,655][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:39:49,662][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:39:49,662][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:39:49,890][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:39:49,902][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:39:50,074][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:39:52,681][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:39:52,696][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 1.54327  |     0 |       1 |
| val_accuracy        | 0.4277   |     0 |       1 |
| val_error           | 0.5723   |     0 |       1 |
| val_f1              | 0.411237 |     0 |       1 |
| val_precision       | 0.435905 |     0 |       1 |
| val_recall          | 0.4277   |     0 |       1 |
| val_loss            | 1.54327  |     0 |       1 |
[2024-05-16 18:41:12,257][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:41:12,356][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:41:12,357][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:41:12,360][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:41:12,360][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:41:12,360][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:41:12,360][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:41:12,360][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:41:12,360][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:41:12,360][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:41:12,361][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:41:12,362][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000 profiler=simple trainer.max_epochs=1
[2024-05-16 18:41:12,362][hannah.utils.utils][INFO] -   
[2024-05-16 18:41:12,363][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:41:12,370][root][INFO] - Configuration: 
[2024-05-16 18:41:12,373][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 1
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
profiler:
  _target_: pytorch_lightning.profilers.SimpleProfiler
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:41:12,373][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:41:12,885][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:41:12,885][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:41:12,938][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:41:12,961][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:41:12,968][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:41:12,968][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:41:12,968][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:41:12,968][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:41:12,968][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:41:12,968][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:41:12,968][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:41:12,968][root][INFO] - Starting training
[2024-05-16 18:41:18,415][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:41:18,415][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:41:18,892][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 50000
[2024-05-16 18:41:18,892][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:41:18,962][hannah.modules.vision.base][INFO] -   Dev Set: 10000
[2024-05-16 18:41:19,031][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:41:20,083][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:41:20,107][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.4914, 0.4822, 0.4465), std: (0.2023, 0.1994, 0.201)
[2024-05-16 18:41:20,113][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:41:20,119][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:41:20,125][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:41:21,572][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:41:23,059][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:41:23,059][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:41:23,059][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:41:23,059][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:41:23,059][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:41:23,230][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:41:24,387][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 50: 'val_error' reached 0.52450 (best 0.52450), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt' as top 1
[2024-05-16 18:41:24,444][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer.fit` stopped: `max_epochs=1` reached.
[2024-05-16 18:41:24,467][pytorch_lightning.profilers.profiler][INFO] - FIT Profiler Report

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                 	|  -              	|  3493           	|  11.584         	|  100 %          	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  [LightningModule]ImageClassifierModule.prepare_data                                                                                                                   	|  5.1029         	|  1              	|  5.1029         	|  44.051         	|
|  [LightningModule]ImageClassifierModule.setup                                                                                                                          	|  1.7055         	|  1              	|  1.7055         	|  14.723         	|
|  [LightningModule]ImageClassifierModule.configure_optimizers                                                                                                           	|  1.284          	|  1              	|  1.284          	|  11.084         	|
|  run_training_epoch                                                                                                                                                    	|  1.19           	|  1              	|  1.19           	|  10.273         	|
|  [LightningModule]ImageClassifierModule.train_dataloader                                                                                                               	|  1.1365         	|  1              	|  1.1365         	|  9.8106         	|
|  run_training_batch                                                                                                                                                    	|  0.019684       	|  50             	|  0.98421        	|  8.4962         	|
|  [LightningModule]ImageClassifierModule.optimizer_step                                                                                                                 	|  0.019622       	|  50             	|  0.9811         	|  8.4693         	|
|  [_EvaluationLoop].val_next                                                                                                                                            	|  0.057443       	|  12             	|  0.68932        	|  5.9505         	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                          	|  0.008492       	|  50             	|  0.4246         	|  3.6654         	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                        	|  0.022384       	|  12             	|  0.26861        	|  2.3188         	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                               	|  0.0044884      	|  50             	|  0.22442        	|  1.9373         	|
|  [LightningModule]ImageClassifierModule.val_dataloader                                                                                                                 	|  0.16873        	|  1              	|  0.16873        	|  1.4566         	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                   	|  0.16455        	|  1              	|  0.16455        	|  1.4205         	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_end                                                                                                             	|  0.13478        	|  1              	|  0.13478        	|  1.1635         	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_end       	|  0.058242       	|  1              	|  0.058242       	|  0.50278        	|
|  [Callback]MacSummaryCallback.on_validation_epoch_end                                                                                                                  	|  0.0071417      	|  2              	|  0.014283       	|  0.1233         	|
|  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                          	|  0.00028395     	|  50             	|  0.014198       	|  0.12256        	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                        	|  0.00012784     	|  62             	|  0.0079261      	|  0.068422       	|
|  [LightningModule]ImageClassifierModule.transfer_batch_to_device                                                                                                       	|  0.00010957     	|  64             	|  0.0070126      	|  0.060536       	|
|  [Callback]HydraOptCallback.on_train_batch_end                                                                                                                         	|  0.00012699     	|  50             	|  0.0063496      	|  0.054813       	|
|  [LightningModule]ImageClassifierModule.optimizer_zero_grad                                                                                                            	|  0.00012292     	|  50             	|  0.0061459      	|  0.053055       	|
|  [Callback]MacSummaryCallback.on_train_start                                                                                                                           	|  0.0061153      	|  1              	|  0.0061153      	|  0.05279        	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                       	|  0.0025217      	|  1              	|  0.0025217      	|  0.021769       	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                     	|  0.00013483     	|  12             	|  0.001618       	|  0.013967       	|
|  [_TrainingEpochLoop].train_dataloader_next                                                                                                                            	|  3.1504e-05     	|  50             	|  0.0015752      	|  0.013598       	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                   	|  5.3609e-05     	|  12             	|  0.0006433      	|  0.0055533      	|
|  [LightningModule]ImageClassifierModule.configure_gradient_clipping                                                                                                    	|  1.187e-05      	|  50             	|  0.00059352     	|  0.0051236      	|
|  [LightningModule]ImageClassifierModule.lr_scheduler_step                                                                                                              	|  1.1295e-05     	|  50             	|  0.00056474     	|  0.0048751      	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                         	|  0.00027294     	|  2              	|  0.00054589     	|  0.0047124      	|
|  [LightningModule]ImageClassifierModule.on_validation_model_eval                                                                                                       	|  0.00023373     	|  2              	|  0.00046745     	|  0.0040353      	|
|  [Callback]LearningRateMonitor.on_train_batch_start                                                                                                                    	|  8.4441e-06     	|  50             	|  0.0004222      	|  0.0036447      	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                           	|  0.00020996     	|  2              	|  0.00041992     	|  0.003625       	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_end       	|  8.1227e-06     	|  50             	|  0.00040613     	|  0.0035059      	|
|  [LightningModule]ImageClassifierModule.on_validation_model_zero_grad                                                                                                  	|  0.0002652      	|  1              	|  0.0002652      	|  0.0022893      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                    	|  0.00022106     	|  1              	|  0.00022106     	|  0.0019083      	|
|  [Callback]HydraOptCallback.on_validation_end                                                                                                                          	|  0.00010086     	|  2              	|  0.00020171     	|  0.0017413      	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                	|  0.00019115     	|  1              	|  0.00019115     	|  0.0016501      	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                        	|  0.00017947     	|  1              	|  0.00017947     	|  0.0015493      	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                              	|  0.00017088     	|  1              	|  0.00017088     	|  0.0014751      	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                          	|  0.0001363      	|  1              	|  0.0001363      	|  0.0011767      	|
|  [Callback]ModelSummary.on_train_batch_end                                                                                                                             	|  1.5051e-06     	|  50             	|  7.5253e-05     	|  0.00064962     	|
|  [Callback]LearningRateMonitor.on_before_zero_grad                                                                                                                     	|  1.4423e-06     	|  50             	|  7.2116e-05     	|  0.00062254     	|
|  [Callback]LearningRateMonitor.on_train_batch_end                                                                                                                      	|  1.2691e-06     	|  50             	|  6.3455e-05     	|  0.00054778     	|
|  [Callback]LearningRateMonitor.on_before_backward                                                                                                                      	|  1.2589e-06     	|  50             	|  6.2946e-05     	|  0.00054338     	|
|  [Callback]LearningRateMonitor.on_after_backward                                                                                                                       	|  1.1629e-06     	|  50             	|  5.8144e-05     	|  0.00050193     	|
|  [Callback]LearningRateMonitor.on_before_optimizer_step                                                                                                                	|  1.1449e-06     	|  50             	|  5.7247e-05     	|  0.00049419     	|
|  [Callback]PredictionLogger.on_train_batch_end                                                                                                                         	|  9.4275e-07     	|  50             	|  4.7138e-05     	|  0.00040692     	|
|  [Callback]MacSummaryCallback.on_train_batch_start                                                                                                                     	|  9.098e-07      	|  50             	|  4.549e-05      	|  0.00039269     	|
|  [LightningModule]ImageClassifierModule.on_before_batch_transfer                                                                                                       	|  6.7275e-07     	|  64             	|  4.3056e-05     	|  0.00037168     	|
|  [Callback]MacSummaryCallback.on_before_zero_grad                                                                                                                      	|  8.5528e-07     	|  50             	|  4.2764e-05     	|  0.00036916     	|
|  [Callback]MacSummaryCallback.on_after_backward                                                                                                                        	|  7.2556e-07     	|  50             	|  3.6278e-05     	|  0.00031317     	|
|  [Callback]MacSummaryCallback.on_before_optimizer_step                                                                                                                 	|  7.0208e-07     	|  50             	|  3.5104e-05     	|  0.00030303     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_zero_grad      	|  6.9616e-07     	|  50             	|  3.4808e-05     	|  0.00030048     	|
|  [Callback]MacSummaryCallback.on_train_batch_end                                                                                                                       	|  6.6999e-07     	|  50             	|  3.3499e-05     	|  0.00028918     	|
|  [Callback]PredictionLogger.on_validation_batch_end                                                                                                                    	|  2.7842e-06     	|  12             	|  3.341e-05      	|  0.00028841     	|
|  [Callback]HydraOptCallback.on_before_optimizer_step                                                                                                                   	|  6.4465e-07     	|  50             	|  3.2233e-05     	|  0.00027825     	|
|  [Callback]MacSummaryCallback.on_before_backward                                                                                                                       	|  6.3477e-07     	|  50             	|  3.1738e-05     	|  0.00027398     	|
|  [LightningModule]ImageClassifierModule.on_after_batch_transfer                                                                                                        	|  4.9263e-07     	|  64             	|  3.1529e-05     	|  0.00027217     	|
|  [Callback]LearningRateMonitor.on_train_start                                                                                                                          	|  3.0776e-05     	|  1              	|  3.0776e-05     	|  0.00026567     	|
|  [Callback]PredictionLogger.on_before_zero_grad                                                                                                                        	|  6.1124e-07     	|  50             	|  3.0562e-05     	|  0.00026383     	|
|  [LightningModule]ImageClassifierModule.on_train_batch_end                                                                                                             	|  5.9549e-07     	|  50             	|  2.9774e-05     	|  0.00025703     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_start     	|  5.9352e-07     	|  50             	|  2.9676e-05     	|  0.00025618     	|
|  [Callback]HydraOptCallback.on_before_zero_grad                                                                                                                        	|  5.8845e-07     	|  50             	|  2.9423e-05     	|  0.00025399     	|
|  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                        	|  5.7715e-07     	|  50             	|  2.8857e-05     	|  0.00024911     	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                             	|  5.7528e-07     	|  50             	|  2.8764e-05     	|  0.0002483      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_backward       	|  5.6885e-07     	|  50             	|  2.8443e-05     	|  0.00024553     	|
|  [Callback]PredictionLogger.on_after_backward                                                                                                                          	|  5.6755e-07     	|  50             	|  2.8377e-05     	|  0.00024497     	|
|  [Callback]PredictionLogger.on_before_backward                                                                                                                         	|  5.6664e-07     	|  50             	|  2.8332e-05     	|  0.00024458     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_optimizer_step 	|  5.6426e-07     	|  50             	|  2.8213e-05     	|  0.00024355     	|
|  [LightningModule]ImageClassifierModule.on_after_backward                                                                                                              	|  5.6163e-07     	|  50             	|  2.8081e-05     	|  0.00024241     	|
|  [LightningModule]ImageClassifierModule.on_before_zero_grad                                                                                                            	|  5.6086e-07     	|  50             	|  2.8043e-05     	|  0.00024208     	|
|  [Callback]PredictionLogger.on_train_batch_start                                                                                                                       	|  5.5959e-07     	|  50             	|  2.798e-05      	|  0.00024154     	|
|  [Callback]HydraOptCallback.on_train_batch_start                                                                                                                       	|  5.5271e-07     	|  50             	|  2.7635e-05     	|  0.00023856     	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                       	|  5.4201e-07     	|  50             	|  2.7101e-05     	|  0.00023395     	|
|  [Callback]HydraOptCallback.on_after_backward                                                                                                                          	|  5.3577e-07     	|  50             	|  2.6789e-05     	|  0.00023125     	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                           	|  5.3321e-07     	|  50             	|  2.666e-05      	|  0.00023015     	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                    	|  5.3071e-07     	|  50             	|  2.6536e-05     	|  0.00022907     	|
|  [Callback]HydraOptCallback.on_before_backward                                                                                                                         	|  5.2684e-07     	|  50             	|  2.6342e-05     	|  0.0002274      	|
|  [Callback]LearningRateMonitor.on_train_epoch_start                                                                                                                    	|  2.618e-05      	|  1              	|  2.618e-05      	|  0.000226       	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                            	|  5.2143e-07     	|  50             	|  2.6072e-05     	|  0.00022506     	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                              	|  5.0708e-07     	|  50             	|  2.5354e-05     	|  0.00021887     	|
|  [Callback]PredictionLogger.on_before_optimizer_step                                                                                                                   	|  4.9713e-07     	|  50             	|  2.4857e-05     	|  0.00021457     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_after_backward        	|  4.9632e-07     	|  50             	|  2.4816e-05     	|  0.00021422     	|
|  [Callback]ModelSummary.on_train_batch_start                                                                                                                           	|  4.8324e-07     	|  50             	|  2.4162e-05     	|  0.00020858     	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                         	|  4.7774e-07     	|  50             	|  2.3887e-05     	|  0.00020621     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end        	|  1.1787e-05     	|  2              	|  2.3575e-05     	|  0.00020351     	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                          	|  4.6961e-07     	|  50             	|  2.348e-05      	|  0.00020269     	|
|  [LightningModule]ImageClassifierModule.on_before_backward                                                                                                             	|  4.5077e-07     	|  50             	|  2.2538e-05     	|  0.00019456     	|
|  [LightningModule]ImageClassifierModule.on_train_batch_start                                                                                                           	|  4.4042e-07     	|  50             	|  2.2021e-05     	|  0.0001901      	|
|  [LightningModule]ImageClassifierModule.on_before_optimizer_step                                                                                                       	|  4.2805e-07     	|  50             	|  2.1403e-05     	|  0.00018476     	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                   	|  3.916e-07      	|  50             	|  1.958e-05      	|  0.00016903     	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_end                                                                                                        	|  9.7201e-06     	|  2              	|  1.944e-05      	|  0.00016782     	|
|  [Callback]LearningRateMonitor.on_validation_batch_end                                                                                                                 	|  1.5281e-06     	|  12             	|  1.8337e-05     	|  0.00015829     	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                        	|  1.2693e-06     	|  12             	|  1.5232e-05     	|  0.00013149     	|
|  [Callback]LearningRateMonitor.on_validation_batch_start                                                                                                               	|  1.0676e-06     	|  12             	|  1.2811e-05     	|  0.00011059     	|
|  [Callback]MacSummaryCallback.on_validation_batch_end                                                                                                                  	|  9.1295e-07     	|  12             	|  1.0955e-05     	|  9.4572e-05     	|
|  [LightningModule]ImageClassifierModule.on_save_checkpoint                                                                                                             	|  5.2031e-06     	|  2              	|  1.0406e-05     	|  8.9831e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end  	|  8.3957e-07     	|  12             	|  1.0075e-05     	|  8.6971e-05     	|
|  [Callback]HydraOptCallback.on_validation_batch_end                                                                                                                    	|  8.0459e-07     	|  12             	|  9.655e-06      	|  8.3347e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_end                                                                                                        	|  7.3291e-07     	|  12             	|  8.7949e-06     	|  7.5922e-05     	|
|  [Callback]PredictionLogger.on_validation_epoch_end                                                                                                                    	|  4.2166e-06     	|  2              	|  8.4331e-06     	|  7.2799e-05     	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                      	|  6.4444e-07     	|  12             	|  7.7332e-06     	|  6.6757e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start	|  6.384e-07      	|  12             	|  7.6608e-06     	|  6.6132e-05     	|
|  [Callback]MacSummaryCallback.on_validation_batch_start                                                                                                                	|  6.1066e-07     	|  12             	|  7.3279e-06     	|  6.3258e-05     	|
|  [Callback]HydraOptCallback.on_validation_batch_start                                                                                                                  	|  5.7653e-07     	|  12             	|  6.9183e-06     	|  5.9723e-05     	|
|  [Callback]PredictionLogger.on_validation_batch_start                                                                                                                  	|  5.0734e-07     	|  12             	|  6.0881e-06     	|  5.2555e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_start                                                                                                      	|  4.983e-07      	|  12             	|  5.9796e-06     	|  5.1619e-05     	|
|  [Callback]LearningRateMonitor.setup                                                                                                                                   	|  3.5961e-06     	|  1              	|  3.5961e-06     	|  3.1043e-05     	|
|  [Callback]LearningRateMonitor.on_sanity_check_start                                                                                                                   	|  3.3851e-06     	|  1              	|  3.3851e-06     	|  2.9222e-05     	|
|  [Callback]LearningRateMonitor.on_save_checkpoint                                                                                                                      	|  1.6725e-06     	|  2              	|  3.3451e-06     	|  2.8876e-05     	|
|  [Callback]LearningRateMonitor.on_validation_end                                                                                                                       	|  1.6326e-06     	|  2              	|  3.2652e-06     	|  2.8187e-05     	|
|  [LightningModule]ImageClassifierModule.configure_callbacks                                                                                                            	|  3.1949e-06     	|  1              	|  3.1949e-06     	|  2.758e-05      	|
|  [Callback]LearningRateMonitor.on_validation_start                                                                                                                     	|  1.507e-06      	|  2              	|  3.014e-06      	|  2.6018e-05     	|
|  [Callback]HydraOptCallback.on_validation_epoch_end                                                                                                                    	|  1.4775e-06     	|  2              	|  2.9551e-06     	|  2.551e-05      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start             	|  2.7339e-06     	|  1              	|  2.7339e-06     	|  2.36e-05       	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                       	|  2.7139e-06     	|  1              	|  2.7139e-06     	|  2.3428e-05     	|
|  [Callback]LearningRateMonitor.on_validation_epoch_end                                                                                                                 	|  1.3569e-06     	|  2              	|  2.7139e-06     	|  2.3428e-05     	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                              	|  1.302e-06      	|  2              	|  2.604e-06      	|  2.2479e-05     	|
|  [Callback]PredictionLogger.setup                                                                                                                                      	|  2.3139e-06     	|  1              	|  2.3139e-06     	|  1.9975e-05     	|
|  [LightningModule]ImageClassifierModule.on_fit_start                                                                                                                   	|  2.2929e-06     	|  1              	|  2.2929e-06     	|  1.9794e-05     	|
|  [LightningModule]ImageClassifierModule.on_train_start                                                                                                                 	|  2.2431e-06     	|  1              	|  2.2431e-06     	|  1.9364e-05     	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                         	|  2.014e-06      	|  1              	|  2.014e-06      	|  1.7386e-05     	|
|  [Callback]LearningRateMonitor.on_validation_epoch_start                                                                                                               	|  1.0065e-06     	|  2              	|  2.0131e-06     	|  1.7378e-05     	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                          	|  1.9129e-06     	|  1              	|  1.9129e-06     	|  1.6513e-05     	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                            	|  9.4145e-07     	|  2              	|  1.8829e-06     	|  1.6254e-05     	|
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                          	|  9.0105e-07     	|  2              	|  1.8021e-06     	|  1.5557e-05     	|
|  [Callback]HydraOptCallback.on_train_start                                                                                                                             	|  1.7718e-06     	|  1              	|  1.7718e-06     	|  1.5295e-05     	|
|  [Callback]MacSummaryCallback.on_save_checkpoint                                                                                                                       	|  8.6089e-07     	|  2              	|  1.7218e-06     	|  1.4863e-05     	|
|  [Callback]LearningRateMonitor.on_train_end                                                                                                                            	|  1.6931e-06     	|  1              	|  1.6931e-06     	|  1.4616e-05     	|
|  [Callback]LearningRateMonitor.on_fit_end                                                                                                                              	|  1.6731e-06     	|  1              	|  1.6731e-06     	|  1.4443e-05     	|
|  [Callback]PredictionLogger.on_validation_end                                                                                                                          	|  8.3097e-07     	|  2              	|  1.6619e-06     	|  1.4347e-05     	|
|  [Callback]MacSummaryCallback.on_validation_end                                                                                                                        	|  8.2096e-07     	|  2              	|  1.6419e-06     	|  1.4174e-05     	|
|  [Callback]MacSummaryCallback.setup                                                                                                                                    	|  1.6331e-06     	|  1              	|  1.6331e-06     	|  1.4098e-05     	|
|  [Callback]LearningRateMonitor.on_fit_start                                                                                                                            	|  1.6131e-06     	|  1              	|  1.6131e-06     	|  1.3925e-05     	|
|  [Callback]MacSummaryCallback.on_validation_start                                                                                                                      	|  7.9616e-07     	|  2              	|  1.5923e-06     	|  1.3746e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_start                                                                                                            	|  7.9104e-07     	|  2              	|  1.5821e-06     	|  1.3657e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_start           	|  1.573e-06      	|  1              	|  1.573e-06      	|  1.3579e-05     	|
|  [Callback]LearningRateMonitor.teardown                                                                                                                                	|  1.563e-06      	|  1              	|  1.563e-06      	|  1.3493e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                      	|  7.5647e-07     	|  2              	|  1.5129e-06     	|  1.306e-05      	|
|  [LightningModule]ImageClassifierModule.on_validation_end                                                                                                              	|  7.5158e-07     	|  2              	|  1.5032e-06     	|  1.2976e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                    	|  7.4098e-07     	|  2              	|  1.482e-06      	|  1.2793e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                     	|  6.9104e-07     	|  2              	|  1.3821e-06     	|  1.1931e-05     	|
|  [Callback]PredictionLogger.on_save_checkpoint                                                                                                                         	|  6.8103e-07     	|  2              	|  1.3621e-06     	|  1.1758e-05     	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                 	|  1.312e-06      	|  1              	|  1.312e-06      	|  1.1326e-05     	|
|  [Callback]HydraOptCallback.on_validation_start                                                                                                                        	|  6.4052e-07     	|  2              	|  1.281e-06      	|  1.1059e-05     	|
|  [Callback]LearningRateMonitor.on_sanity_check_end                                                                                                                     	|  1.272e-06      	|  1              	|  1.272e-06      	|  1.098e-05      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start      	|  6.2597e-07     	|  2              	|  1.2519e-06     	|  1.0807e-05     	|
|  [Callback]ModelSummary.setup                                                                                                                                          	|  1.241e-06      	|  1              	|  1.241e-06      	|  1.0713e-05     	|
|  [Callback]HydraOptCallback.on_save_checkpoint                                                                                                                         	|  6.1106e-07     	|  2              	|  1.2221e-06     	|  1.055e-05      	|
|  [Callback]PredictionLogger.on_validation_start                                                                                                                        	|  6.1095e-07     	|  2              	|  1.2219e-06     	|  1.0548e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                   	|  6.0606e-07     	|  2              	|  1.2121e-06     	|  1.0464e-05     	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                           	|  1.211e-06      	|  1              	|  1.211e-06      	|  1.0454e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                        	|  5.9605e-07     	|  2              	|  1.1921e-06     	|  1.0291e-05     	|
|  [Callback]LearningRateMonitor.on_train_epoch_end                                                                                                                      	|  1.1721e-06     	|  1              	|  1.1721e-06     	|  1.0118e-05     	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                   	|  1.1509e-06     	|  1              	|  1.1509e-06     	|  9.935e-06      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_save_checkpoint       	|  5.709e-07      	|  2              	|  1.1418e-06     	|  9.8566e-06     	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                      	|  5.6101e-07     	|  2              	|  1.122e-06      	|  9.6858e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end  	|  5.6101e-07     	|  2              	|  1.122e-06      	|  9.6858e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start	|  5.4564e-07     	|  2              	|  1.0913e-06     	|  9.4205e-06     	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_start                                                                                                      	|  5.4087e-07     	|  2              	|  1.0817e-06     	|  9.3381e-06     	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                             	|  1.0519e-06     	|  1              	|  1.0519e-06     	|  9.0808e-06     	|
|  [Callback]MacSummaryCallback.on_validation_epoch_start                                                                                                                	|  5.1095e-07     	|  2              	|  1.0219e-06     	|  8.8215e-06     	|
|  [Callback]HydraOptCallback.on_validation_epoch_start                                                                                                                  	|  5.0606e-07     	|  2              	|  1.0121e-06     	|  8.7371e-06     	|
|  [Callback]HydraOptCallback.setup                                                                                                                                      	|  9.9093e-07     	|  1              	|  9.9093e-07     	|  8.5542e-06     	|
|  [Callback]HydraOptCallback.on_train_end                                                                                                                               	|  9.5111e-07     	|  1              	|  9.5111e-07     	|  8.2105e-06     	|
|  [Callback]MacSummaryCallback.on_sanity_check_start                                                                                                                    	|  9.3202e-07     	|  1              	|  9.3202e-07     	|  8.0457e-06     	|
|  [Callback]MacSummaryCallback.on_train_epoch_start                                                                                                                     	|  9.3086e-07     	|  1              	|  9.3086e-07     	|  8.0356e-06     	|
|  [Callback]PredictionLogger.on_validation_epoch_start                                                                                                                  	|  4.5507e-07     	|  2              	|  9.1013e-07     	|  7.8568e-06     	|
|  [Callback]PredictionLogger.on_sanity_check_start                                                                                                                      	|  8.8103e-07     	|  1              	|  8.8103e-07     	|  7.6055e-06     	|
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                             	|  4.3993e-07     	|  2              	|  8.7987e-07     	|  7.5955e-06     	|
|  [Callback]MacSummaryCallback.teardown                                                                                                                                 	|  8.6194e-07     	|  1              	|  8.6194e-07     	|  7.4407e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_end                                                                                                                   	|  8.6101e-07     	|  1              	|  8.6101e-07     	|  7.4327e-06     	|
|  [LightningModule]ImageClassifierModule.teardown                                                                                                                       	|  8.6101e-07     	|  1              	|  8.6101e-07     	|  7.4327e-06     	|
|  [Callback]MacSummaryCallback.on_fit_start                                                                                                                             	|  8.4098e-07     	|  1              	|  8.4098e-07     	|  7.2598e-06     	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                           	|  8.2096e-07     	|  1              	|  8.2096e-07     	|  7.087e-06      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_start    	|  8.1188e-07     	|  1              	|  8.1188e-07     	|  7.0086e-06     	|
|  [Callback]MacSummaryCallback.on_fit_end                                                                                                                               	|  8.0094e-07     	|  1              	|  8.0094e-07     	|  6.9141e-06     	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                         	|  7.709e-07      	|  1              	|  7.709e-07      	|  6.6548e-06     	|
|  [LightningModule]ImageClassifierModule.on_fit_end                                                                                                                     	|  7.6112e-07     	|  1              	|  7.6112e-07     	|  6.5704e-06     	|
|  [Callback]PredictionLogger.on_fit_end                                                                                                                                 	|  7.411e-07      	|  1              	|  7.411e-07      	|  6.3976e-06     	|
|  [Callback]PredictionLogger.on_fit_start                                                                                                                               	|  7.3086e-07     	|  1              	|  7.3086e-07     	|  6.3091e-06     	|
|  [Callback]PredictionLogger.on_train_start                                                                                                                             	|  7.1106e-07     	|  1              	|  7.1106e-07     	|  6.1383e-06     	|
|  [Callback]MacSummaryCallback.on_sanity_check_end                                                                                                                      	|  6.7102e-07     	|  1              	|  6.7102e-07     	|  5.7926e-06     	|
|  [Callback]HydraOptCallback.on_fit_start                                                                                                                               	|  6.6101e-07     	|  1              	|  6.6101e-07     	|  5.7061e-06     	|
|  [Callback]MacSummaryCallback.on_train_end                                                                                                                             	|  6.6101e-07     	|  1              	|  6.6101e-07     	|  5.7061e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end               	|  6.6101e-07     	|  1              	|  6.6101e-07     	|  5.7061e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_start                                                                                                           	|  6.5099e-07     	|  1              	|  6.5099e-07     	|  5.6197e-06     	|
|  [Callback]HydraOptCallback.on_fit_end                                                                                                                                 	|  6.5099e-07     	|  1              	|  6.5099e-07     	|  5.6197e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                 	|  6.5099e-07     	|  1              	|  6.5099e-07     	|  5.6197e-06     	|
|  [Callback]HydraOptCallback.on_sanity_check_start                                                                                                                      	|  6.4098e-07     	|  1              	|  6.4098e-07     	|  5.5333e-06     	|
|  [Callback]PredictionLogger.teardown                                                                                                                                   	|  6.3097e-07     	|  1              	|  6.3097e-07     	|  5.4469e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_start     	|  6.2096e-07     	|  1              	|  6.2096e-07     	|  5.3604e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_end             	|  6.2096e-07     	|  1              	|  6.2096e-07     	|  5.3604e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_end      	|  6.1095e-07     	|  1              	|  6.1095e-07     	|  5.274e-06      	|
|  [Callback]PredictionLogger.on_train_epoch_end                                                                                                                         	|  6.1095e-07     	|  1              	|  6.1095e-07     	|  5.274e-06      	|
|  [Callback]HydraOptCallback.teardown                                                                                                                                   	|  6.0094e-07     	|  1              	|  6.0094e-07     	|  5.1876e-06     	|
|  [Callback]MacSummaryCallback.on_train_epoch_end                                                                                                                       	|  5.9092e-07     	|  1              	|  5.9092e-07     	|  5.1012e-06     	|
|  [Callback]ModelSummary.teardown                                                                                                                                       	|  5.7998e-07     	|  1              	|  5.7998e-07     	|  5.0067e-06     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                    	|  5.709e-07      	|  1              	|  5.709e-07      	|  4.9283e-06     	|
|  [Callback]PredictionLogger.on_train_end                                                                                                                               	|  5.6089e-07     	|  1              	|  5.6089e-07     	|  4.8419e-06     	|
|  [Callback]PredictionLogger.on_train_epoch_start                                                                                                                       	|  5.5088e-07     	|  1              	|  5.5088e-07     	|  4.7555e-06     	|
|  [Callback]HydraOptCallback.on_train_epoch_end                                                                                                                         	|  5.411e-07      	|  1              	|  5.411e-07      	|  4.671e-06      	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                  	|  5.4087e-07     	|  1              	|  5.4087e-07     	|  4.669e-06      	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                            	|  5.2107e-07     	|  1              	|  5.2107e-07     	|  4.4982e-06     	|
|  [Callback]HydraOptCallback.on_sanity_check_end                                                                                                                        	|  5.2084e-07     	|  1              	|  5.2084e-07     	|  4.4962e-06     	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                	|  5.0082e-07     	|  1              	|  5.0082e-07     	|  4.3233e-06     	|
|  [Callback]HydraOptCallback.on_train_epoch_start                                                                                                                       	|  4.8103e-07     	|  1              	|  4.8103e-07     	|  4.1525e-06     	|
|  [Callback]PredictionLogger.on_sanity_check_end                                                                                                                        	|  4.7102e-07     	|  1              	|  4.7102e-07     	|  4.0661e-06     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                     	|  4.7102e-07     	|  1              	|  4.7102e-07     	|  4.0661e-06     	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[2024-05-16 18:41:24,469][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:41:24,469][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:41:24,700][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:41:24,713][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:41:24,889][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:42:09,716][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:42:09,723][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:42:09,723][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:42:10,205][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:42:10,217][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:42:10,389][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt
[2024-05-16 18:42:10,909][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:42:10,944][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 1.46464  |     0 |       1 |
| val_accuracy        | 0.4755   |     0 |       1 |
| val_error           | 0.5245   |     0 |       1 |
| val_f1              | 0.477936 |     0 |       1 |
| val_precision       | 0.497408 |     0 |       1 |
| val_recall          | 0.4755   |     0 |       1 |
| val_loss            | 1.46464  |     0 |       1 |
[2024-05-16 18:42:26,326][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:42:26,418][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:42:26,419][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:42:26,422][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:42:26,422][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:42:26,422][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:42:26,422][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:42:26,422][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:42:26,422][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:42:26,422][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:42:26,424][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:42:26,424][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000 profiler=simple
[2024-05-16 18:42:26,424][hannah.utils.utils][INFO] -   
[2024-05-16 18:42:26,425][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:42:26,432][root][INFO] - Configuration: 
[2024-05-16 18:42:26,435][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
profiler:
  _target_: pytorch_lightning.profilers.SimpleProfiler
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:42:26,435][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:42:26,949][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:42:26,949][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:42:27,004][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:42:27,028][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:42:27,034][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:42:27,035][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:42:27,035][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:42:27,035][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:42:27,035][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:42:27,035][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:42:27,035][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:42:27,035][root][INFO] - Starting training
[2024-05-16 18:42:32,470][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:42:32,470][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:42:32,948][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 50000
[2024-05-16 18:42:32,948][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:42:33,018][hannah.modules.vision.base][INFO] -   Dev Set: 10000
[2024-05-16 18:42:33,086][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:42:33,928][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:42:33,943][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.4914, 0.4822, 0.4465), std: (0.2023, 0.1994, 0.201)
[2024-05-16 18:42:33,949][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:42:33,956][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:42:33,962][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:42:35,656][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:42:37,108][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:42:37,108][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:42:37,108][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:42:37,108][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:42:37,108][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:42:37,268][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:38,427][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 50: 'val_error' reached 0.60290 (best 0.60290), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt' as top 1
[2024-05-16 18:42:38,556][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:39,707][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 100: 'val_error' was not in top 1
[2024-05-16 18:42:39,807][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:40,939][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 150: 'val_error' reached 0.59880 (best 0.59880), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=2-step=150.ckpt' as top 1
[2024-05-16 18:42:41,062][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:42,211][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 200: 'val_error' reached 0.56090 (best 0.56090), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=3-step=200.ckpt' as top 1
[2024-05-16 18:42:42,334][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:43,464][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 250: 'val_error' reached 0.46870 (best 0.46870), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=4-step=250.ckpt' as top 1
[2024-05-16 18:42:43,590][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:44,739][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 300: 'val_error' reached 0.35760 (best 0.35760), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=5-step=300.ckpt' as top 1
[2024-05-16 18:42:44,861][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:45,991][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 350: 'val_error' reached 0.27350 (best 0.27350), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=6-step=350.ckpt' as top 1
[2024-05-16 18:42:46,115][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:47,263][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 400: 'val_error' was not in top 1
[2024-05-16 18:42:47,357][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:48,481][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 450: 'val_error' was not in top 1
[2024-05-16 18:42:48,576][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:49,705][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 500: 'val_error' was not in top 1
[2024-05-16 18:42:49,800][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:50,913][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 550: 'val_error' reached 0.22000 (best 0.22000), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=10-step=550.ckpt' as top 1
[2024-05-16 18:42:51,038][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:52,175][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 600: 'val_error' was not in top 1
[2024-05-16 18:42:52,270][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:53,381][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 650: 'val_error' was not in top 1
[2024-05-16 18:42:53,475][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:54,609][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 700: 'val_error' was not in top 1
[2024-05-16 18:42:54,703][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:55,821][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 750: 'val_error' reached 0.15830 (best 0.15830), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=14-step=750.ckpt' as top 1
[2024-05-16 18:42:55,945][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:57,088][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 800: 'val_error' was not in top 1
[2024-05-16 18:42:57,182][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:58,303][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 850: 'val_error' reached 0.14460 (best 0.14460), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=16-step=850.ckpt' as top 1
[2024-05-16 18:42:58,426][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:42:59,563][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 900: 'val_error' reached 0.12250 (best 0.12250), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=17-step=900.ckpt' as top 1
[2024-05-16 18:42:59,685][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:00,809][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 950: 'val_error' reached 0.12150 (best 0.12150), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=18-step=950.ckpt' as top 1
[2024-05-16 18:43:00,941][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:02,077][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 1000: 'val_error' was not in top 1
[2024-05-16 18:43:02,173][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:03,291][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 1050: 'val_error' was not in top 1
[2024-05-16 18:43:03,385][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:04,524][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 1100: 'val_error' was not in top 1
[2024-05-16 18:43:04,618][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:05,736][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 1150: 'val_error' was not in top 1
[2024-05-16 18:43:05,830][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:06,970][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 1200: 'val_error' was not in top 1
[2024-05-16 18:43:07,064][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:08,184][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 1250: 'val_error' was not in top 1
[2024-05-16 18:43:08,278][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:09,420][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 1300: 'val_error' was not in top 1
[2024-05-16 18:43:09,516][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:10,639][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 1350: 'val_error' was not in top 1
[2024-05-16 18:43:10,734][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:11,872][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 1400: 'val_error' was not in top 1
[2024-05-16 18:43:11,967][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:13,090][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 1450: 'val_error' was not in top 1
[2024-05-16 18:43:13,184][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:14,327][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 1500: 'val_error' was not in top 1
[2024-05-16 18:43:14,422][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:15,542][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 1550: 'val_error' was not in top 1
[2024-05-16 18:43:15,636][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:16,776][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 1600: 'val_error' was not in top 1
[2024-05-16 18:43:16,871][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:17,993][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 1650: 'val_error' was not in top 1
[2024-05-16 18:43:18,088][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:19,229][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 1700: 'val_error' was not in top 1
[2024-05-16 18:43:19,325][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:20,461][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 1750: 'val_error' was not in top 1
[2024-05-16 18:43:20,557][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:21,696][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 1800: 'val_error' was not in top 1
[2024-05-16 18:43:21,790][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:22,910][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 1850: 'val_error' was not in top 1
[2024-05-16 18:43:23,005][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:24,156][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 1900: 'val_error' was not in top 1
[2024-05-16 18:43:24,261][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:25,383][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 1950: 'val_error' was not in top 1
[2024-05-16 18:43:25,477][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:26,619][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 2000: 'val_error' was not in top 1
[2024-05-16 18:43:26,714][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:27,837][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 2050: 'val_error' was not in top 1
[2024-05-16 18:43:27,932][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:29,073][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 2100: 'val_error' was not in top 1
[2024-05-16 18:43:29,167][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:30,291][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 2150: 'val_error' was not in top 1
[2024-05-16 18:43:30,385][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:31,522][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 2200: 'val_error' was not in top 1
[2024-05-16 18:43:31,617][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:32,739][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 2250: 'val_error' was not in top 1
[2024-05-16 18:43:32,833][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:33,991][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 2300: 'val_error' was not in top 1
[2024-05-16 18:43:34,088][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:35,226][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 2350: 'val_error' was not in top 1
[2024-05-16 18:43:35,321][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:36,478][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 2400: 'val_error' was not in top 1
[2024-05-16 18:43:36,572][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:37,715][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 2450: 'val_error' was not in top 1
[2024-05-16 18:43:37,809][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:43:38,973][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 2500: 'val_error' was not in top 1
[2024-05-16 18:43:39,006][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer.fit` stopped: `max_epochs=50` reached.
[2024-05-16 18:43:39,046][pytorch_lightning.profilers.profiler][INFO] - FIT Profiler Report

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                 	|  -              	|  166792         	|  72.083         	|  100 %          	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                    	|  1.0681         	|  50             	|  53.406         	|  74.09          	|
|  run_training_batch                                                                                                                                                    	|  0.016273       	|  2500           	|  40.682         	|  56.438         	|
|  [LightningModule]ImageClassifierModule.optimizer_step                                                                                                                 	|  0.016212       	|  2500           	|  40.53          	|  56.227         	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                          	|  0.0080999      	|  2500           	|  20.25          	|  28.092         	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_end                                                                                                             	|  0.12696        	|  50             	|  6.348          	|  8.8065         	|
|  [LightningModule]ImageClassifierModule.prepare_data                                                                                                                   	|  5.0987         	|  1              	|  5.0987         	|  7.0734         	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                               	|  0.0017844      	|  2500           	|  4.461          	|  6.1887         	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                        	|  0.0081817      	|  502            	|  4.1072         	|  5.6979         	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_end       	|  0.041692       	|  50             	|  2.0846         	|  2.892          	|
|  [LightningModule]ImageClassifierModule.configure_optimizers                                                                                                           	|  1.4903         	|  1              	|  1.4903         	|  2.0674         	|
|  [LightningModule]ImageClassifierModule.setup                                                                                                                          	|  1.4874         	|  1              	|  1.4874         	|  2.0635         	|
|  [LightningModule]ImageClassifierModule.train_dataloader                                                                                                               	|  1.3501         	|  1              	|  1.3501         	|  1.873          	|
|  [_EvaluationLoop].val_next                                                                                                                                            	|  0.0015332      	|  502            	|  0.76966        	|  1.0678         	|
|  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                          	|  0.00029696     	|  2500           	|  0.74239        	|  1.0299         	|
|  [Callback]HydraOptCallback.on_train_batch_end                                                                                                                         	|  0.00015266     	|  2500           	|  0.38164        	|  0.52945        	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                        	|  0.00010757     	|  3002           	|  0.32291        	|  0.44798        	|
|  [Callback]MacSummaryCallback.on_validation_epoch_end                                                                                                                  	|  0.0062103      	|  51             	|  0.31672        	|  0.43939        	|
|  [LightningModule]ImageClassifierModule.optimizer_zero_grad                                                                                                            	|  0.00011441     	|  2500           	|  0.28602        	|  0.3968         	|
|  [LightningModule]ImageClassifierModule.transfer_batch_to_device                                                                                                       	|  9.1461e-05     	|  3004           	|  0.27475        	|  0.38116        	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                   	|  0.20515        	|  1              	|  0.20515        	|  0.28461        	|
|  [Callback]LearningRateMonitor.on_train_batch_start                                                                                                                    	|  7.5232e-05     	|  2500           	|  0.18808        	|  0.26092        	|
|  [_TrainingEpochLoop].train_dataloader_next                                                                                                                            	|  6.7613e-05     	|  2500           	|  0.16903        	|  0.2345         	|
|  [LightningModule]ImageClassifierModule.val_dataloader                                                                                                                 	|  0.15533        	|  1              	|  0.15533        	|  0.21549        	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                     	|  0.00013        	|  502            	|  0.065258       	|  0.090532       	|
|  [LightningModule]ImageClassifierModule.lr_scheduler_step                                                                                                              	|  1.1925e-05     	|  2500           	|  0.029814       	|  0.04136        	|
|  [LightningModule]ImageClassifierModule.configure_gradient_clipping                                                                                                    	|  1.1529e-05     	|  2500           	|  0.028823       	|  0.039985       	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_end       	|  8.6182e-06     	|  2500           	|  0.021546       	|  0.02989        	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                   	|  2.8494e-05     	|  502            	|  0.014304       	|  0.019844       	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                        	|  0.00027231     	|  50             	|  0.013615       	|  0.018888       	|
|  [LightningModule]ImageClassifierModule.on_validation_model_zero_grad                                                                                                  	|  0.0002549      	|  50             	|  0.012745       	|  0.017681       	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                           	|  0.00024986     	|  51             	|  0.012743       	|  0.017678       	|
|  [LightningModule]ImageClassifierModule.on_validation_model_eval                                                                                                       	|  0.00022338     	|  51             	|  0.011392       	|  0.015804       	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                         	|  0.0002117      	|  51             	|  0.010797       	|  0.014978       	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                          	|  0.00014        	|  50             	|  0.0070002      	|  0.0097114      	|
|  [Callback]HydraOptCallback.on_validation_end                                                                                                                          	|  0.00012075     	|  51             	|  0.0061581      	|  0.0085431      	|
|  [Callback]MacSummaryCallback.on_train_start                                                                                                                           	|  0.0061272      	|  1              	|  0.0061272      	|  0.0085003      	|
|  [Callback]LearningRateMonitor.on_before_zero_grad                                                                                                                     	|  1.468e-06      	|  2500           	|  0.00367        	|  0.0050914      	|
|  [Callback]ModelSummary.on_train_batch_end                                                                                                                             	|  1.4036e-06     	|  2500           	|  0.0035091      	|  0.0048682      	|
|  [Callback]LearningRateMonitor.on_train_batch_end                                                                                                                      	|  1.3694e-06     	|  2500           	|  0.0034235      	|  0.0047493      	|
|  [Callback]LearningRateMonitor.on_before_backward                                                                                                                      	|  1.2925e-06     	|  2500           	|  0.0032312      	|  0.0044826      	|
|  [Callback]LearningRateMonitor.on_after_backward                                                                                                                       	|  1.2014e-06     	|  2500           	|  0.0030034      	|  0.0041666      	|
|  [Callback]LearningRateMonitor.on_before_optimizer_step                                                                                                                	|  1.1965e-06     	|  2500           	|  0.0029912      	|  0.0041496      	|
|  [Callback]PredictionLogger.on_train_batch_end                                                                                                                         	|  1.1155e-06     	|  2500           	|  0.0027886      	|  0.0038687      	|
|  [Callback]MacSummaryCallback.on_before_zero_grad                                                                                                                      	|  8.9109e-07     	|  2500           	|  0.0022277      	|  0.0030905      	|
|  [Callback]MacSummaryCallback.on_train_batch_start                                                                                                                     	|  8.8259e-07     	|  2500           	|  0.0022065      	|  0.003061       	|
|  [LightningModule]ImageClassifierModule.on_before_batch_transfer                                                                                                       	|  6.8826e-07     	|  3004           	|  0.0020675      	|  0.0028683      	|
|  [Callback]LearningRateMonitor.on_train_epoch_start                                                                                                                    	|  3.8276e-05     	|  50             	|  0.0019138      	|  0.002655       	|
|  [Callback]MacSummaryCallback.on_train_batch_end                                                                                                                       	|  7.4811e-07     	|  2500           	|  0.0018703      	|  0.0025946      	|
|  [Callback]MacSummaryCallback.on_before_backward                                                                                                                       	|  7.0317e-07     	|  2500           	|  0.0017579      	|  0.0024388      	|
|  [Callback]MacSummaryCallback.on_before_optimizer_step                                                                                                                 	|  6.9526e-07     	|  2500           	|  0.0017382      	|  0.0024113      	|
|  [Callback]MacSummaryCallback.on_after_backward                                                                                                                        	|  6.6273e-07     	|  2500           	|  0.0016568      	|  0.0022985      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_zero_grad      	|  6.4402e-07     	|  2500           	|  0.0016101      	|  0.0022336      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_start     	|  6.3478e-07     	|  2500           	|  0.0015869      	|  0.0022016      	|
|  [Callback]PredictionLogger.on_before_zero_grad                                                                                                                        	|  6.2354e-07     	|  2500           	|  0.0015589      	|  0.0021626      	|
|  [LightningModule]ImageClassifierModule.on_train_batch_end                                                                                                             	|  6.2292e-07     	|  2500           	|  0.0015573      	|  0.0021604      	|
|  [Callback]HydraOptCallback.on_before_zero_grad                                                                                                                        	|  6.1142e-07     	|  2500           	|  0.0015286      	|  0.0021206      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_backward       	|  6.1026e-07     	|  2500           	|  0.0015257      	|  0.0021165      	|
|  [Callback]PredictionLogger.on_train_batch_start                                                                                                                       	|  5.842e-07      	|  2500           	|  0.0014605      	|  0.0020262      	|
|  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                        	|  5.782e-07      	|  2500           	|  0.0014455      	|  0.0020053      	|
|  [Callback]HydraOptCallback.on_before_optimizer_step                                                                                                                   	|  5.7614e-07     	|  2500           	|  0.0014403      	|  0.0019982      	|
|  [Callback]PredictionLogger.on_before_backward                                                                                                                         	|  5.7369e-07     	|  2500           	|  0.0014342      	|  0.0019897      	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                       	|  5.6301e-07     	|  2500           	|  0.0014075      	|  0.0019527      	|
|  [Callback]HydraOptCallback.on_train_batch_start                                                                                                                       	|  5.5425e-07     	|  2500           	|  0.0013856      	|  0.0019223      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_optimizer_step 	|  5.5166e-07     	|  2500           	|  0.0013791      	|  0.0019133      	|
|  [Callback]PredictionLogger.on_after_backward                                                                                                                          	|  5.5042e-07     	|  2500           	|  0.0013761      	|  0.001909       	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                             	|  5.496e-07      	|  2500           	|  0.001374       	|  0.0019061      	|
|  [Callback]HydraOptCallback.on_before_backward                                                                                                                         	|  5.4615e-07     	|  2500           	|  0.0013654      	|  0.0018942      	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                            	|  5.2661e-07     	|  2500           	|  0.0013165      	|  0.0018264      	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                           	|  5.2468e-07     	|  2500           	|  0.0013117      	|  0.0018197      	|
|  [LightningModule]ImageClassifierModule.on_before_zero_grad                                                                                                            	|  5.235e-07      	|  2500           	|  0.0013088      	|  0.0018156      	|
|  [Callback]ModelSummary.on_train_batch_start                                                                                                                           	|  5.0407e-07     	|  2500           	|  0.0012602      	|  0.0017482      	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                         	|  4.9526e-07     	|  2500           	|  0.0012382      	|  0.0017177      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_after_backward        	|  4.9178e-07     	|  2500           	|  0.0012294      	|  0.0017056      	|
|  [LightningModule]ImageClassifierModule.on_after_backward                                                                                                              	|  4.8882e-07     	|  2500           	|  0.0012221      	|  0.0016954      	|
|  [Callback]PredictionLogger.on_before_optimizer_step                                                                                                                   	|  4.8522e-07     	|  2500           	|  0.001213       	|  0.0016829      	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                          	|  4.8512e-07     	|  2500           	|  0.0012128      	|  0.0016825      	|
|  [Callback]HydraOptCallback.on_after_backward                                                                                                                          	|  4.7977e-07     	|  2500           	|  0.0011994      	|  0.001664       	|
|  [LightningModule]ImageClassifierModule.on_after_batch_transfer                                                                                                        	|  3.9915e-07     	|  3004           	|  0.001199       	|  0.0016634      	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                    	|  4.6652e-07     	|  2500           	|  0.0011663      	|  0.001618       	|
|  [LightningModule]ImageClassifierModule.on_before_backward                                                                                                             	|  4.6463e-07     	|  2500           	|  0.0011616      	|  0.0016114      	|
|  [LightningModule]ImageClassifierModule.on_before_optimizer_step                                                                                                       	|  4.4392e-07     	|  2500           	|  0.0011098      	|  0.0015396      	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                              	|  4.3724e-07     	|  2500           	|  0.0010931      	|  0.0015164      	|
|  [LightningModule]ImageClassifierModule.on_train_batch_start                                                                                                           	|  4.2682e-07     	|  2500           	|  0.0010671      	|  0.0014803      	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                   	|  3.5407e-07     	|  2500           	|  0.00088518     	|  0.001228       	|
|  [Callback]LearningRateMonitor.on_validation_batch_end                                                                                                                 	|  1.5156e-06     	|  502            	|  0.00076081     	|  0.0010555      	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                       	|  0.00073413     	|  1              	|  0.00073413     	|  0.0010185      	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_end                                                                                                        	|  1.3378e-05     	|  51             	|  0.0006823      	|  0.00094655     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end        	|  1.3071e-05     	|  51             	|  0.0006666      	|  0.00092477     	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                        	|  1.1746e-06     	|  502            	|  0.00058963     	|  0.00081799     	|
|  [Callback]PredictionLogger.on_validation_batch_end                                                                                                                    	|  1.1356e-06     	|  502            	|  0.00057006     	|  0.00079084     	|
|  [Callback]LearningRateMonitor.on_validation_batch_start                                                                                                               	|  1.0815e-06     	|  502            	|  0.00054289     	|  0.00075315     	|
|  [Callback]MacSummaryCallback.on_validation_batch_end                                                                                                                  	|  8.8832e-07     	|  502            	|  0.00044594     	|  0.00061865     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end  	|  7.6022e-07     	|  502            	|  0.00038163     	|  0.00052943     	|
|  [Callback]HydraOptCallback.on_validation_batch_end                                                                                                                    	|  7.5068e-07     	|  502            	|  0.00037684     	|  0.00052279     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_end                                                                                                        	|  6.6442e-07     	|  502            	|  0.00033354     	|  0.00046272     	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                      	|  6.5645e-07     	|  502            	|  0.00032954     	|  0.00045717     	|
|  [Callback]MacSummaryCallback.on_validation_batch_start                                                                                                                	|  6.0882e-07     	|  502            	|  0.00030563     	|  0.00042399     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start	|  5.8936e-07     	|  502            	|  0.00029586     	|  0.00041045     	|
|  [Callback]HydraOptCallback.on_validation_batch_start                                                                                                                  	|  5.7394e-07     	|  502            	|  0.00028812     	|  0.00039971     	|
|  [Callback]PredictionLogger.on_validation_batch_start                                                                                                                  	|  4.8746e-07     	|  502            	|  0.0002447      	|  0.00033948     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                    	|  0.0002217      	|  1              	|  0.0002217      	|  0.00030757     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_start                                                                                                      	|  4.3085e-07     	|  502            	|  0.00021629     	|  0.00030006     	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                	|  0.00019903     	|  1              	|  0.00019903     	|  0.00027611     	|
|  [LightningModule]ImageClassifierModule.on_save_checkpoint                                                                                                             	|  2.7921e-06     	|  61             	|  0.00017032     	|  0.00023628     	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                              	|  0.00016828     	|  1              	|  0.00016828     	|  0.00023346     	|
|  [Callback]LearningRateMonitor.on_save_checkpoint                                                                                                                      	|  1.6511e-06     	|  61             	|  0.00010072     	|  0.00013972     	|
|  [Callback]PredictionLogger.on_validation_epoch_end                                                                                                                    	|  1.6079e-06     	|  51             	|  8.2001e-05     	|  0.00011376     	|
|  [Callback]LearningRateMonitor.on_validation_end                                                                                                                       	|  1.5343e-06     	|  51             	|  7.8248e-05     	|  0.00010855     	|
|  [Callback]HydraOptCallback.on_validation_epoch_end                                                                                                                    	|  1.4602e-06     	|  51             	|  7.4468e-05     	|  0.00010331     	|
|  [Callback]LearningRateMonitor.on_validation_start                                                                                                                     	|  1.4559e-06     	|  51             	|  7.4251e-05     	|  0.00010301     	|
|  [Callback]MacSummaryCallback.on_train_epoch_start                                                                                                                     	|  1.4696e-06     	|  50             	|  7.3482e-05     	|  0.00010194     	|
|  [Callback]LearningRateMonitor.on_validation_epoch_end                                                                                                                 	|  1.4123e-06     	|  51             	|  7.2028e-05     	|  9.9924e-05     	|
|  [Callback]LearningRateMonitor.on_train_epoch_end                                                                                                                      	|  1.2999e-06     	|  50             	|  6.4997e-05     	|  9.017e-05      	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                              	|  1.2159e-06     	|  51             	|  6.2008e-05     	|  8.6024e-05     	|
|  [Callback]HydraOptCallback.on_save_checkpoint                                                                                                                         	|  9.695e-07      	|  61             	|  5.914e-05      	|  8.2044e-05     	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                            	|  1.1158e-06     	|  51             	|  5.6906e-05     	|  7.8945e-05     	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                           	|  1.0615e-06     	|  50             	|  5.3076e-05     	|  7.3632e-05     	|
|  [Callback]LearningRateMonitor.on_validation_epoch_start                                                                                                               	|  1.0399e-06     	|  51             	|  5.3034e-05     	|  7.3574e-05     	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                             	|  9.2696e-07     	|  50             	|  4.6348e-05     	|  6.4298e-05     	|
|  [Callback]PredictionLogger.on_validation_end                                                                                                                          	|  8.6936e-07     	|  51             	|  4.4337e-05     	|  6.1509e-05     	|
|  [Callback]MacSummaryCallback.on_save_checkpoint                                                                                                                       	|  7.2422e-07     	|  61             	|  4.4177e-05     	|  6.1287e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_start                                                                                                            	|  8.0526e-07     	|  51             	|  4.1068e-05     	|  5.6974e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                      	|  7.9903e-07     	|  51             	|  4.0751e-05     	|  5.6533e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                    	|  7.7469e-07     	|  51             	|  3.9509e-05     	|  5.4811e-05     	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_start                                                                                                           	|  7.8125e-07     	|  50             	|  3.9063e-05     	|  5.4192e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_end                                                                                                              	|  7.4874e-07     	|  51             	|  3.8186e-05     	|  5.2975e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_start     	|  7.6161e-07     	|  50             	|  3.8081e-05     	|  5.2829e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_save_checkpoint       	|  6.2322e-07     	|  61             	|  3.8017e-05     	|  5.274e-05      	|
|  [Callback]HydraOptCallback.on_train_epoch_start                                                                                                                       	|  7.5879e-07     	|  50             	|  3.7939e-05     	|  5.2633e-05     	|
|  [Callback]MacSummaryCallback.on_validation_end                                                                                                                        	|  7.2092e-07     	|  51             	|  3.6767e-05     	|  5.1006e-05     	|
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                             	|  5.6495e-07     	|  61             	|  3.4462e-05     	|  4.7809e-05     	|
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                          	|  5.6379e-07     	|  61             	|  3.4391e-05     	|  4.7711e-05     	|
|  [Callback]HydraOptCallback.on_validation_start                                                                                                                        	|  6.539e-07      	|  51             	|  3.3349e-05     	|  4.6265e-05     	|
|  [Callback]MacSummaryCallback.on_validation_start                                                                                                                      	|  6.5235e-07     	|  51             	|  3.327e-05      	|  4.6155e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end  	|  6.3566e-07     	|  51             	|  3.2419e-05     	|  4.4975e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start      	|  6.3221e-07     	|  51             	|  3.2243e-05     	|  4.473e-05      	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                   	|  6.2843e-07     	|  51             	|  3.205e-05      	|  4.4463e-05     	|
|  [Callback]MacSummaryCallback.on_train_epoch_end                                                                                                                       	|  6.2312e-07     	|  50             	|  3.1156e-05     	|  4.3222e-05     	|
|  [Callback]LearningRateMonitor.on_train_start                                                                                                                          	|  3.0525e-05     	|  1              	|  3.0525e-05     	|  4.2347e-05     	|
|  [Callback]PredictionLogger.on_save_checkpoint                                                                                                                         	|  4.9811e-07     	|  61             	|  3.0385e-05     	|  4.2153e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                     	|  5.9433e-07     	|  51             	|  3.0311e-05     	|  4.205e-05      	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                        	|  5.8284e-07     	|  51             	|  2.9725e-05     	|  4.1237e-05     	|
|  [Callback]PredictionLogger.on_validation_start                                                                                                                        	|  5.4377e-07     	|  51             	|  2.7732e-05     	|  3.8473e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_start                                                                                                      	|  5.4363e-07     	|  51             	|  2.7725e-05     	|  3.8463e-05     	|
|  [Callback]PredictionLogger.on_train_epoch_start                                                                                                                       	|  5.5067e-07     	|  50             	|  2.7534e-05     	|  3.8197e-05     	|
|  [Callback]MacSummaryCallback.on_validation_epoch_start                                                                                                                	|  5.2805e-07     	|  51             	|  2.6931e-05     	|  3.7361e-05     	|
|  [Callback]HydraOptCallback.on_train_epoch_end                                                                                                                         	|  5.1775e-07     	|  50             	|  2.5887e-05     	|  3.5913e-05     	|
|  [Callback]PredictionLogger.on_train_epoch_end                                                                                                                         	|  5.1662e-07     	|  50             	|  2.5831e-05     	|  3.5835e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start	|  5.0249e-07     	|  51             	|  2.5627e-05     	|  3.5553e-05     	|
|  [Callback]HydraOptCallback.on_validation_epoch_start                                                                                                                  	|  4.6093e-07     	|  51             	|  2.3508e-05     	|  3.2612e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                      	|  4.4518e-07     	|  51             	|  2.2704e-05     	|  3.1497e-05     	|
|  [Callback]PredictionLogger.on_validation_epoch_start                                                                                                                  	|  4.4174e-07     	|  51             	|  2.2529e-05     	|  3.1254e-05     	|
|  [Callback]LearningRateMonitor.on_sanity_check_start                                                                                                                   	|  3.8561e-06     	|  1              	|  3.8561e-06     	|  5.3496e-06     	|
|  [Callback]LearningRateMonitor.setup                                                                                                                                   	|  3.7749e-06     	|  1              	|  3.7749e-06     	|  5.2369e-06     	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                       	|  3.1241e-06     	|  1              	|  3.1241e-06     	|  4.3341e-06     	|
|  [LightningModule]ImageClassifierModule.configure_callbacks                                                                                                            	|  3.045e-06      	|  1              	|  3.045e-06      	|  4.2243e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start             	|  3.024e-06      	|  1              	|  3.024e-06      	|  4.1952e-06     	|
|  [LightningModule]ImageClassifierModule.on_fit_start                                                                                                                   	|  2.6438e-06     	|  1              	|  2.6438e-06     	|  3.6677e-06     	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                         	|  2.2529e-06     	|  1              	|  2.2529e-06     	|  3.1254e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_start                                                                                                                 	|  2.1029e-06     	|  1              	|  2.1029e-06     	|  2.9174e-06     	|
|  [Callback]PredictionLogger.setup                                                                                                                                      	|  1.973e-06      	|  1              	|  1.973e-06      	|  2.7371e-06     	|
|  [Callback]LearningRateMonitor.on_train_end                                                                                                                            	|  1.902e-06      	|  1              	|  1.902e-06      	|  2.6386e-06     	|
|  [Callback]LearningRateMonitor.on_fit_start                                                                                                                            	|  1.8422e-06     	|  1              	|  1.8422e-06     	|  2.5556e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_start           	|  1.8228e-06     	|  1              	|  1.8228e-06     	|  2.5288e-06     	|
|  [Callback]LearningRateMonitor.on_fit_end                                                                                                                              	|  1.7532e-06     	|  1              	|  1.7532e-06     	|  2.4322e-06     	|
|  [Callback]HydraOptCallback.on_train_start                                                                                                                             	|  1.7132e-06     	|  1              	|  1.7132e-06     	|  2.3767e-06     	|
|  [Callback]MacSummaryCallback.setup                                                                                                                                    	|  1.5821e-06     	|  1              	|  1.5821e-06     	|  2.1948e-06     	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                          	|  1.512e-06      	|  1              	|  1.512e-06      	|  2.0976e-06     	|
|  [Callback]ModelSummary.setup                                                                                                                                          	|  1.502e-06      	|  1              	|  1.502e-06      	|  2.0837e-06     	|
|  [Callback]LearningRateMonitor.on_sanity_check_end                                                                                                                     	|  1.4829e-06     	|  1              	|  1.4829e-06     	|  2.0572e-06     	|
|  [Callback]LearningRateMonitor.teardown                                                                                                                                	|  1.282e-06      	|  1              	|  1.282e-06      	|  1.7785e-06     	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                 	|  1.1411e-06     	|  1              	|  1.1411e-06     	|  1.583e-06      	|
|  [Callback]MacSummaryCallback.on_train_end                                                                                                                             	|  1.0319e-06     	|  1              	|  1.0319e-06     	|  1.4316e-06     	|
|  [Callback]MacSummaryCallback.on_fit_end                                                                                                                               	|  9.3202e-07     	|  1              	|  9.3202e-07     	|  1.293e-06      	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                   	|  8.9104e-07     	|  1              	|  8.9104e-07     	|  1.2361e-06     	|
|  [Callback]HydraOptCallback.setup                                                                                                                                      	|  8.8196e-07     	|  1              	|  8.8196e-07     	|  1.2235e-06     	|
|  [LightningModule]ImageClassifierModule.teardown                                                                                                                       	|  8.6194e-07     	|  1              	|  8.6194e-07     	|  1.1958e-06     	|
|  [Callback]MacSummaryCallback.on_fit_start                                                                                                                             	|  8.4192e-07     	|  1              	|  8.4192e-07     	|  1.168e-06      	|
|  [Callback]PredictionLogger.on_fit_start                                                                                                                               	|  8.4098e-07     	|  1              	|  8.4098e-07     	|  1.1667e-06     	|
|  [Callback]MacSummaryCallback.on_sanity_check_start                                                                                                                    	|  8.4098e-07     	|  1              	|  8.4098e-07     	|  1.1667e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_start    	|  8.1118e-07     	|  1              	|  8.1118e-07     	|  1.1253e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_end                                                                                                                   	|  8.0094e-07     	|  1              	|  8.0094e-07     	|  1.1111e-06     	|
|  [Callback]MacSummaryCallback.teardown                                                                                                                                 	|  7.8208e-07     	|  1              	|  7.8208e-07     	|  1.085e-06      	|
|  [Callback]MacSummaryCallback.on_sanity_check_end                                                                                                                      	|  7.8115e-07     	|  1              	|  7.8115e-07     	|  1.0837e-06     	|
|  [Callback]HydraOptCallback.on_fit_end                                                                                                                                 	|  7.8115e-07     	|  1              	|  7.8115e-07     	|  1.0837e-06     	|
|  [LightningModule]ImageClassifierModule.on_fit_end                                                                                                                     	|  7.8115e-07     	|  1              	|  7.8115e-07     	|  1.0837e-06     	|
|  [Callback]PredictionLogger.on_sanity_check_start                                                                                                                      	|  7.8091e-07     	|  1              	|  7.8091e-07     	|  1.0834e-06     	|
|  [Callback]HydraOptCallback.teardown                                                                                                                                   	|  7.0105e-07     	|  1              	|  7.0105e-07     	|  9.7257e-07     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                    	|  7.0105e-07     	|  1              	|  7.0105e-07     	|  9.7257e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                         	|  6.9104e-07     	|  1              	|  6.9104e-07     	|  9.5868e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_end             	|  6.9104e-07     	|  1              	|  6.9104e-07     	|  9.5868e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                 	|  6.8103e-07     	|  1              	|  6.8103e-07     	|  9.4479e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_end      	|  6.5099e-07     	|  1              	|  6.5099e-07     	|  9.0312e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                           	|  6.4098e-07     	|  1              	|  6.4098e-07     	|  8.8923e-07     	|
|  [Callback]PredictionLogger.on_train_start                                                                                                                             	|  6.3004e-07     	|  1              	|  6.3004e-07     	|  8.7405e-07     	|
|  [Callback]HydraOptCallback.on_fit_start                                                                                                                               	|  6.2096e-07     	|  1              	|  6.2096e-07     	|  8.6145e-07     	|
|  [Callback]PredictionLogger.on_train_end                                                                                                                               	|  6.2096e-07     	|  1              	|  6.2096e-07     	|  8.6145e-07     	|
|  [Callback]HydraOptCallback.on_sanity_check_end                                                                                                                        	|  5.8999e-07     	|  1              	|  5.8999e-07     	|  8.1849e-07     	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                            	|  5.8091e-07     	|  1              	|  5.8091e-07     	|  8.059e-07      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end               	|  5.7113e-07     	|  1              	|  5.7113e-07     	|  7.9233e-07     	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                  	|  5.709e-07      	|  1              	|  5.709e-07      	|  7.9201e-07     	|
|  [Callback]PredictionLogger.teardown                                                                                                                                   	|  5.709e-07      	|  1              	|  5.709e-07      	|  7.9201e-07     	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                	|  5.5088e-07     	|  1              	|  5.5088e-07     	|  7.6423e-07     	|
|  [Callback]HydraOptCallback.on_train_end                                                                                                                               	|  5.411e-07      	|  1              	|  5.411e-07      	|  7.5066e-07     	|
|  [Callback]ModelSummary.teardown                                                                                                                                       	|  5.411e-07      	|  1              	|  5.411e-07      	|  7.5066e-07     	|
|  [Callback]HydraOptCallback.on_sanity_check_start                                                                                                                      	|  5.3085e-07     	|  1              	|  5.3085e-07     	|  7.3645e-07     	|
|  [Callback]PredictionLogger.on_fit_end                                                                                                                                 	|  5.1106e-07     	|  1              	|  5.1106e-07     	|  7.09e-07       	|
|  [Callback]PredictionLogger.on_sanity_check_end                                                                                                                        	|  4.9104e-07     	|  1              	|  4.9104e-07     	|  6.8122e-07     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                     	|  4.5984e-07     	|  1              	|  4.5984e-07     	|  6.3793e-07     	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[2024-05-16 18:43:39,047][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:43:39,048][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:43:39,278][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=18-step=950.ckpt
[2024-05-16 18:43:39,289][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:43:39,466][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=18-step=950.ckpt
[2024-05-16 18:43:49,125][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:43:49,132][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:43:49,133][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:43:49,533][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-16 18:43:49,549][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 0.506442 |     0 |       1 |
| val_accuracy        | 0.8449   |     0 |       1 |
| val_error           | 0.1551   |     0 |       1 |
| val_f1              | 0.844197 |     0 |       1 |
| val_precision       | 0.844543 |     0 |       1 |
| val_recall          | 0.8449   |     0 |       1 |
| val_loss            | 0.506442 |     0 |       1 |
[2024-05-16 18:44:38,251][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:44:38,345][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:44:38,346][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:44:38,348][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:44:38,349][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:44:38,349][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:44:38,349][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:44:38,349][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:44:38,349][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:44:38,349][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:44:38,350][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:44:38,351][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10_ffcv model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000 profiler=simple
[2024-05-16 18:44:38,351][hannah.utils.utils][INFO] -   
[2024-05-16 18:44:38,352][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:44:38,359][root][INFO] - Configuration: 
[2024-05-16 18:44:38,363][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10FFCVDataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
profiler:
  _target_: pytorch_lightning.profilers.SimpleProfiler
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:44:38,363][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:44:38,878][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:44:38,878][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:44:38,933][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:44:38,957][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:44:38,964][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:44:38,964][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:44:38,964][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:44:38,964][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:44:38,964][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:44:38,964][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:44:38,964][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:44:38,964][root][INFO] - Starting training
[2024-05-16 18:44:44,425][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:44:44,425][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:44:44,905][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 50000
[2024-05-16 18:44:44,905][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:44:44,975][hannah.modules.vision.base][INFO] -   Dev Set: 10000
[2024-05-16 18:44:45,044][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:44:46,040][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:44:46,063][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.4914, 0.4822, 0.4465), std: (0.2023, 0.1994, 0.201)
[2024-05-16 18:44:46,069][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:44:46,076][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:44:46,087][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:44:47,455][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:44:48,919][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:44:48,919][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:44:48,919][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:44:48,920][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:44:48,920][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:44:49,086][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:44:50,248][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 50: 'val_error' reached 0.60290 (best 0.60290), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=50.ckpt' as top 1
[2024-05-16 18:44:50,334][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:44:51,473][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 100: 'val_error' was not in top 1
[2024-05-16 18:44:51,528][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:44:52,647][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 150: 'val_error' reached 0.59880 (best 0.59880), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=2-step=150.ckpt' as top 1
[2024-05-16 18:44:52,732][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:44:53,881][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 200: 'val_error' reached 0.56090 (best 0.56090), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=3-step=200.ckpt' as top 1
[2024-05-16 18:44:53,963][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:44:55,078][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 250: 'val_error' reached 0.46870 (best 0.46870), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=4-step=250.ckpt' as top 1
[2024-05-16 18:44:55,161][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:44:56,298][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 300: 'val_error' reached 0.35760 (best 0.35760), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=5-step=300.ckpt' as top 1
[2024-05-16 18:44:56,379][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:44:57,499][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 350: 'val_error' reached 0.27350 (best 0.27350), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=6-step=350.ckpt' as top 1
[2024-05-16 18:44:57,583][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:44:58,715][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 400: 'val_error' was not in top 1
[2024-05-16 18:44:58,769][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:44:59,881][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 450: 'val_error' was not in top 1
[2024-05-16 18:44:59,937][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:01,069][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 500: 'val_error' was not in top 1
[2024-05-16 18:45:01,123][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:02,233][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 550: 'val_error' reached 0.22000 (best 0.22000), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=10-step=550.ckpt' as top 1
[2024-05-16 18:45:02,318][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:03,448][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 600: 'val_error' was not in top 1
[2024-05-16 18:45:03,501][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:04,634][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 650: 'val_error' was not in top 1
[2024-05-16 18:45:04,688][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:05,840][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 700: 'val_error' was not in top 1
[2024-05-16 18:45:05,892][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:07,006][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 750: 'val_error' reached 0.15830 (best 0.15830), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=14-step=750.ckpt' as top 1
[2024-05-16 18:45:07,089][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:08,220][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 800: 'val_error' was not in top 1
[2024-05-16 18:45:08,276][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:09,389][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 850: 'val_error' reached 0.14460 (best 0.14460), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=16-step=850.ckpt' as top 1
[2024-05-16 18:45:09,471][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:10,602][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 900: 'val_error' reached 0.12250 (best 0.12250), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=17-step=900.ckpt' as top 1
[2024-05-16 18:45:10,687][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:11,836][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 950: 'val_error' reached 0.12150 (best 0.12150), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=18-step=950.ckpt' as top 1
[2024-05-16 18:45:11,930][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:13,064][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 1000: 'val_error' was not in top 1
[2024-05-16 18:45:13,117][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:14,228][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 1050: 'val_error' was not in top 1
[2024-05-16 18:45:14,283][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:15,416][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 1100: 'val_error' was not in top 1
[2024-05-16 18:45:15,470][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:16,583][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 1150: 'val_error' was not in top 1
[2024-05-16 18:45:16,636][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:17,758][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 1200: 'val_error' was not in top 1
[2024-05-16 18:45:17,809][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:18,917][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 1250: 'val_error' was not in top 1
[2024-05-16 18:45:18,971][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:20,101][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 1300: 'val_error' was not in top 1
[2024-05-16 18:45:20,152][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:21,276][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 1350: 'val_error' was not in top 1
[2024-05-16 18:45:21,329][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:22,473][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 1400: 'val_error' was not in top 1
[2024-05-16 18:45:22,526][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:23,635][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 1450: 'val_error' was not in top 1
[2024-05-16 18:45:23,689][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:24,827][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 1500: 'val_error' was not in top 1
[2024-05-16 18:45:24,881][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:25,993][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 1550: 'val_error' was not in top 1
[2024-05-16 18:45:26,045][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:27,178][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 1600: 'val_error' was not in top 1
[2024-05-16 18:45:27,231][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:28,347][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 1650: 'val_error' was not in top 1
[2024-05-16 18:45:28,402][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:29,529][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 1700: 'val_error' was not in top 1
[2024-05-16 18:45:29,584][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:30,692][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 1750: 'val_error' was not in top 1
[2024-05-16 18:45:30,745][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:31,880][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 1800: 'val_error' was not in top 1
[2024-05-16 18:45:31,934][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:33,047][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 1850: 'val_error' was not in top 1
[2024-05-16 18:45:33,102][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:34,267][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 1900: 'val_error' was not in top 1
[2024-05-16 18:45:34,326][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:35,440][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 1950: 'val_error' was not in top 1
[2024-05-16 18:45:35,495][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:36,630][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 2000: 'val_error' was not in top 1
[2024-05-16 18:45:36,684][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:37,793][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 2050: 'val_error' was not in top 1
[2024-05-16 18:45:37,847][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:38,974][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 2100: 'val_error' was not in top 1
[2024-05-16 18:45:39,027][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:40,132][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 2150: 'val_error' was not in top 1
[2024-05-16 18:45:40,185][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:41,313][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 2200: 'val_error' was not in top 1
[2024-05-16 18:45:41,366][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:42,470][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 2250: 'val_error' was not in top 1
[2024-05-16 18:45:42,524][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:43,652][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 2300: 'val_error' was not in top 1
[2024-05-16 18:45:43,708][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:44,832][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 2350: 'val_error' was not in top 1
[2024-05-16 18:45:44,884][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:46,014][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 2400: 'val_error' was not in top 1
[2024-05-16 18:45:46,069][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:47,186][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 2450: 'val_error' was not in top 1
[2024-05-16 18:45:47,239][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:45:48,373][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 2500: 'val_error' was not in top 1
[2024-05-16 18:45:48,407][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer.fit` stopped: `max_epochs=50` reached.
[2024-05-16 18:45:48,457][pytorch_lightning.profilers.profiler][INFO] - FIT Profiler Report

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                 	|  -              	|  166792         	|  69.565         	|  100 %          	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                    	|  1.0205         	|  50             	|  51.024         	|  73.347         	|
|  run_training_batch                                                                                                                                                    	|  0.016159       	|  2500           	|  40.398         	|  58.073         	|
|  [LightningModule]ImageClassifierModule.optimizer_step                                                                                                                 	|  0.016102       	|  2500           	|  40.254         	|  57.865         	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                          	|  0.0080132      	|  2500           	|  20.033         	|  28.798         	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_end                                                                                                             	|  0.12666        	|  50             	|  6.333          	|  9.1037         	|
|  [LightningModule]ImageClassifierModule.prepare_data                                                                                                                   	|  5.1167         	|  1              	|  5.1167         	|  7.3554         	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                               	|  0.0017846      	|  2500           	|  4.4616         	|  6.4135         	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                        	|  0.0081086      	|  502            	|  4.0705         	|  5.8514         	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                        	|  0.00072851     	|  3002           	|  2.187          	|  3.1438         	|
|  [LightningModule]ImageClassifierModule.transfer_batch_to_device                                                                                                       	|  0.00070617     	|  3004           	|  2.1213         	|  3.0495         	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_end       	|  0.041265       	|  50             	|  2.0632         	|  2.9659         	|
|  [LightningModule]ImageClassifierModule.setup                                                                                                                          	|  1.6514         	|  1              	|  1.6514         	|  2.3739         	|
|  [LightningModule]ImageClassifierModule.configure_optimizers                                                                                                           	|  1.1962         	|  1              	|  1.1962         	|  1.7195         	|
|  [LightningModule]ImageClassifierModule.train_dataloader                                                                                                               	|  1.1415         	|  1              	|  1.1415         	|  1.6409         	|
|  [_EvaluationLoop].val_next                                                                                                                                            	|  0.0020205      	|  502            	|  1.0143         	|  1.458          	|
|  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                          	|  0.00030161     	|  2500           	|  0.75401        	|  1.0839         	|
|  [Callback]HydraOptCallback.on_train_batch_end                                                                                                                         	|  0.00015522     	|  2500           	|  0.38806        	|  0.55784        	|
|  [Callback]MacSummaryCallback.on_validation_epoch_end                                                                                                                  	|  0.0062928      	|  51             	|  0.32093        	|  0.46135        	|
|  [LightningModule]ImageClassifierModule.optimizer_zero_grad                                                                                                            	|  0.00012281     	|  2500           	|  0.30702        	|  0.44134        	|
|  [_TrainingEpochLoop].train_dataloader_next                                                                                                                            	|  9.57e-05       	|  2500           	|  0.23925        	|  0.34392        	|
|  [Callback]LearningRateMonitor.on_train_batch_start                                                                                                                    	|  7.664e-05      	|  2500           	|  0.1916         	|  0.27543        	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                   	|  0.17355        	|  1              	|  0.17355        	|  0.24949        	|
|  [LightningModule]ImageClassifierModule.val_dataloader                                                                                                                 	|  0.10327        	|  1              	|  0.10327        	|  0.14846        	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                     	|  0.00013341     	|  502            	|  0.066973       	|  0.096274       	|
|  [LightningModule]ImageClassifierModule.configure_gradient_clipping                                                                                                    	|  1.3256e-05     	|  2500           	|  0.03314        	|  0.047639       	|
|  [LightningModule]ImageClassifierModule.lr_scheduler_step                                                                                                              	|  1.2531e-05     	|  2500           	|  0.031327       	|  0.045032       	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_end       	|  9.253e-06      	|  2500           	|  0.023132       	|  0.033253       	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                        	|  0.00031882     	|  50             	|  0.015941       	|  0.022916       	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                   	|  2.6439e-05     	|  502            	|  0.013273       	|  0.019079       	|
|  [LightningModule]ImageClassifierModule.on_validation_model_zero_grad                                                                                                  	|  0.00026212     	|  50             	|  0.013106       	|  0.01884        	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                           	|  0.00024536     	|  51             	|  0.012514       	|  0.017988       	|
|  [LightningModule]ImageClassifierModule.on_validation_model_eval                                                                                                       	|  0.00022882     	|  51             	|  0.01167        	|  0.016775       	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                         	|  0.00019696     	|  51             	|  0.010045       	|  0.014439       	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                          	|  0.00014369     	|  50             	|  0.0071843      	|  0.010328       	|
|  [Callback]HydraOptCallback.on_validation_end                                                                                                                          	|  0.00012243     	|  51             	|  0.0062439      	|  0.0089756      	|
|  [Callback]MacSummaryCallback.on_train_start                                                                                                                           	|  0.00617        	|  1              	|  0.00617        	|  0.0088694      	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                       	|  0.0041188      	|  1              	|  0.0041188      	|  0.0059208      	|
|  [Callback]ModelSummary.on_train_batch_end                                                                                                                             	|  1.5324e-06     	|  2500           	|  0.0038311      	|  0.0055072      	|
|  [Callback]LearningRateMonitor.on_before_zero_grad                                                                                                                     	|  1.4542e-06     	|  2500           	|  0.0036355      	|  0.005226       	|
|  [Callback]LearningRateMonitor.on_train_batch_end                                                                                                                      	|  1.2997e-06     	|  2500           	|  0.0032492      	|  0.0046708      	|
|  [Callback]LearningRateMonitor.on_before_backward                                                                                                                      	|  1.2866e-06     	|  2500           	|  0.0032165      	|  0.0046237      	|
|  [Callback]PredictionLogger.on_train_batch_end                                                                                                                         	|  1.2413e-06     	|  2500           	|  0.0031032      	|  0.0044608      	|
|  [Callback]LearningRateMonitor.on_after_backward                                                                                                                       	|  1.1769e-06     	|  2500           	|  0.0029421      	|  0.0042294      	|
|  [Callback]LearningRateMonitor.on_before_optimizer_step                                                                                                                	|  1.1739e-06     	|  2500           	|  0.0029348      	|  0.0042189      	|
|  [Callback]MacSummaryCallback.on_train_batch_start                                                                                                                     	|  1.0654e-06     	|  2500           	|  0.0026636      	|  0.0038289      	|
|  [Callback]LearningRateMonitor.on_train_epoch_start                                                                                                                    	|  4.1954e-05     	|  50             	|  0.0020977      	|  0.0030155      	|
|  [Callback]MacSummaryCallback.on_before_zero_grad                                                                                                                      	|  8.3788e-07     	|  2500           	|  0.0020947      	|  0.0030111      	|
|  [LightningModule]ImageClassifierModule.on_before_batch_transfer                                                                                                       	|  6.7391e-07     	|  3004           	|  0.0020244      	|  0.0029101      	|
|  [Callback]MacSummaryCallback.on_train_batch_end                                                                                                                       	|  7.7805e-07     	|  2500           	|  0.0019451      	|  0.0027961      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_start     	|  7.7623e-07     	|  2500           	|  0.0019406      	|  0.0027896      	|
|  [Callback]MacSummaryCallback.on_before_optimizer_step                                                                                                                 	|  7.7023e-07     	|  2500           	|  0.0019256      	|  0.002768       	|
|  [Callback]MacSummaryCallback.on_after_backward                                                                                                                        	|  7.043e-07      	|  2500           	|  0.0017607      	|  0.0025311      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_zero_grad      	|  6.9782e-07     	|  2500           	|  0.0017445      	|  0.0025078      	|
|  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                        	|  6.7577e-07     	|  2500           	|  0.0016894      	|  0.0024286      	|
|  [LightningModule]ImageClassifierModule.on_after_batch_transfer                                                                                                        	|  5.5126e-07     	|  3004           	|  0.001656       	|  0.0023805      	|
|  [Callback]PredictionLogger.on_before_backward                                                                                                                         	|  6.6054e-07     	|  2500           	|  0.0016514      	|  0.0023739      	|
|  [Callback]MacSummaryCallback.on_before_backward                                                                                                                       	|  6.5536e-07     	|  2500           	|  0.0016384      	|  0.0023552      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_backward       	|  6.5402e-07     	|  2500           	|  0.0016351      	|  0.0023504      	|
|  [LightningModule]ImageClassifierModule.on_train_batch_end                                                                                                             	|  6.5051e-07     	|  2500           	|  0.0016263      	|  0.0023378      	|
|  [Callback]PredictionLogger.on_before_zero_grad                                                                                                                        	|  6.5e-07        	|  2500           	|  0.001625       	|  0.0023359      	|
|  [Callback]HydraOptCallback.on_before_optimizer_step                                                                                                                   	|  6.2986e-07     	|  2500           	|  0.0015747      	|  0.0022636      	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                             	|  6.1565e-07     	|  2500           	|  0.0015391      	|  0.0022125      	|
|  [Callback]HydraOptCallback.on_train_batch_start                                                                                                                       	|  6.1461e-07     	|  2500           	|  0.0015365      	|  0.0022088      	|
|  [LightningModule]ImageClassifierModule.on_before_zero_grad                                                                                                            	|  6.1227e-07     	|  2500           	|  0.0015307      	|  0.0022004      	|
|  [Callback]HydraOptCallback.on_before_zero_grad                                                                                                                        	|  6.0186e-07     	|  2500           	|  0.0015047      	|  0.002163       	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                           	|  5.9608e-07     	|  2500           	|  0.0014902      	|  0.0021422      	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                       	|  5.9017e-07     	|  2500           	|  0.0014754      	|  0.0021209      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_after_backward        	|  5.7884e-07     	|  2500           	|  0.0014471      	|  0.0020802      	|
|  [Callback]PredictionLogger.on_after_backward                                                                                                                          	|  5.6338e-07     	|  2500           	|  0.0014084      	|  0.0020247      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_optimizer_step 	|  5.467e-07      	|  2500           	|  0.0013667      	|  0.0019647      	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                         	|  5.456e-07      	|  2500           	|  0.001364       	|  0.0019608      	|
|  [Callback]PredictionLogger.on_train_batch_start                                                                                                                       	|  5.4502e-07     	|  2500           	|  0.0013626      	|  0.0019587      	|
|  [Callback]ModelSummary.on_train_batch_start                                                                                                                           	|  5.4377e-07     	|  2500           	|  0.0013594      	|  0.0019542      	|
|  [Callback]HydraOptCallback.on_before_backward                                                                                                                         	|  5.2966e-07     	|  2500           	|  0.0013242      	|  0.0019035      	|
|  [Callback]PredictionLogger.on_before_optimizer_step                                                                                                                   	|  5.1431e-07     	|  2500           	|  0.0012858      	|  0.0018483      	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                          	|  5.1312e-07     	|  2500           	|  0.0012828      	|  0.0018441      	|
|  [Callback]HydraOptCallback.on_after_backward                                                                                                                          	|  5.1155e-07     	|  2500           	|  0.0012789      	|  0.0018384      	|
|  [LightningModule]ImageClassifierModule.on_after_backward                                                                                                              	|  5.1024e-07     	|  2500           	|  0.0012756      	|  0.0018337      	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                            	|  5.0288e-07     	|  2500           	|  0.0012572      	|  0.0018072      	|
|  [LightningModule]ImageClassifierModule.on_before_backward                                                                                                             	|  4.9546e-07     	|  2500           	|  0.0012387      	|  0.0017806      	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                              	|  4.9473e-07     	|  2500           	|  0.0012368      	|  0.0017779      	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                    	|  4.9214e-07     	|  2500           	|  0.0012303      	|  0.0017686      	|
|  [LightningModule]ImageClassifierModule.on_train_batch_start                                                                                                           	|  4.7515e-07     	|  2500           	|  0.0011879      	|  0.0017076      	|
|  [LightningModule]ImageClassifierModule.on_before_optimizer_step                                                                                                       	|  4.5229e-07     	|  2500           	|  0.0011307      	|  0.0016254      	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                   	|  4.1718e-07     	|  2500           	|  0.0010429      	|  0.0014993      	|
|  [Callback]LearningRateMonitor.on_validation_batch_end                                                                                                                 	|  1.4896e-06     	|  502            	|  0.0007478      	|  0.001075       	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end        	|  1.3196e-05     	|  51             	|  0.000673       	|  0.00096744     	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_end                                                                                                        	|  1.3064e-05     	|  51             	|  0.00066627     	|  0.00095777     	|
|  [Callback]PredictionLogger.on_validation_batch_end                                                                                                                    	|  1.3073e-06     	|  502            	|  0.00065625     	|  0.00094337     	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                        	|  1.1676e-06     	|  502            	|  0.00058612     	|  0.00084255     	|
|  [Callback]LearningRateMonitor.on_validation_batch_start                                                                                                               	|  1.1425e-06     	|  502            	|  0.00057352     	|  0.00082445     	|
|  [Callback]MacSummaryCallback.on_validation_batch_end                                                                                                                  	|  8.8058e-07     	|  502            	|  0.00044205     	|  0.00063545     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end  	|  8.4976e-07     	|  502            	|  0.00042658     	|  0.00061321     	|
|  [Callback]HydraOptCallback.on_validation_batch_end                                                                                                                    	|  7.4187e-07     	|  502            	|  0.00037242     	|  0.00053536     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start	|  6.694e-07      	|  502            	|  0.00033604     	|  0.00048306     	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                      	|  6.509e-07      	|  502            	|  0.00032675     	|  0.00046971     	|
|  [Callback]HydraOptCallback.on_validation_batch_start                                                                                                                  	|  6.4241e-07     	|  502            	|  0.00032249     	|  0.00046358     	|
|  [Callback]MacSummaryCallback.on_validation_batch_start                                                                                                                	|  6.3843e-07     	|  502            	|  0.00032049     	|  0.00046071     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_end                                                                                                        	|  6.3267e-07     	|  502            	|  0.0003176      	|  0.00045655     	|
|  [Callback]PredictionLogger.on_validation_batch_start                                                                                                                  	|  5.5769e-07     	|  502            	|  0.00027996     	|  0.00040245     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_start                                                                                                      	|  4.928e-07      	|  502            	|  0.00024738     	|  0.00035562     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                    	|  0.00022874     	|  1              	|  0.00022874     	|  0.00032882     	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                	|  0.00021488     	|  1              	|  0.00021488     	|  0.0003089      	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                              	|  0.00017798     	|  1              	|  0.00017798     	|  0.00025584     	|
|  [LightningModule]ImageClassifierModule.on_save_checkpoint                                                                                                             	|  2.5152e-06     	|  61             	|  0.00015343     	|  0.00022056     	|
|  [Callback]LearningRateMonitor.on_save_checkpoint                                                                                                                      	|  1.7839e-06     	|  61             	|  0.00010882     	|  0.00015642     	|
|  [Callback]PredictionLogger.on_validation_epoch_end                                                                                                                    	|  1.7532e-06     	|  51             	|  8.9413e-05     	|  0.00012853     	|
|  [Callback]HydraOptCallback.on_validation_epoch_end                                                                                                                    	|  1.7212e-06     	|  51             	|  8.778e-05      	|  0.00012619     	|
|  [Callback]MacSummaryCallback.on_train_epoch_start                                                                                                                     	|  1.6487e-06     	|  50             	|  8.2435e-05     	|  0.0001185      	|
|  [Callback]LearningRateMonitor.on_validation_end                                                                                                                       	|  1.5184e-06     	|  51             	|  7.7438e-05     	|  0.00011132     	|
|  [Callback]LearningRateMonitor.on_validation_epoch_end                                                                                                                 	|  1.3817e-06     	|  51             	|  7.0466e-05     	|  0.0001013      	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                              	|  1.3707e-06     	|  51             	|  6.9906e-05     	|  0.00010049     	|
|  [Callback]LearningRateMonitor.on_validation_start                                                                                                                     	|  1.319e-06      	|  51             	|  6.7268e-05     	|  9.6699e-05     	|
|  [Callback]LearningRateMonitor.on_train_epoch_end                                                                                                                      	|  1.2748e-06     	|  50             	|  6.3738e-05     	|  9.1624e-05     	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                            	|  1.1911e-06     	|  51             	|  6.0746e-05     	|  8.7323e-05     	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                             	|  1.1423e-06     	|  50             	|  5.7116e-05     	|  8.2105e-05     	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                           	|  1.0936e-06     	|  50             	|  5.4678e-05     	|  7.86e-05       	|
|  [Callback]LearningRateMonitor.on_validation_epoch_start                                                                                                               	|  9.5415e-07     	|  51             	|  4.8662e-05     	|  6.9952e-05     	|
|  [Callback]MacSummaryCallback.on_save_checkpoint                                                                                                                       	|  7.491e-07      	|  61             	|  4.5695e-05     	|  6.5687e-05     	|
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                             	|  7.279e-07      	|  61             	|  4.4402e-05     	|  6.3828e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                      	|  8.4989e-07     	|  51             	|  4.3344e-05     	|  6.2308e-05     	|
|  [Callback]PredictionLogger.on_validation_end                                                                                                                          	|  8.0227e-07     	|  51             	|  4.0916e-05     	|  5.8817e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_end                                                                                                              	|  7.7755e-07     	|  51             	|  3.9655e-05     	|  5.7005e-05     	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_start                                                                                                           	|  7.8481e-07     	|  50             	|  3.924e-05      	|  5.6408e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_start     	|  7.7597e-07     	|  50             	|  3.8798e-05     	|  5.5773e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_start                                                                                                            	|  7.5431e-07     	|  51             	|  3.847e-05      	|  5.5301e-05     	|
|  [Callback]MacSummaryCallback.on_validation_end                                                                                                                        	|  7.5377e-07     	|  51             	|  3.8442e-05     	|  5.5261e-05     	|
|  [Callback]HydraOptCallback.on_train_epoch_start                                                                                                                       	|  7.452e-07      	|  50             	|  3.726e-05      	|  5.3561e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                    	|  7.2993e-07     	|  51             	|  3.7227e-05     	|  5.3514e-05     	|
|  [Callback]HydraOptCallback.on_save_checkpoint                                                                                                                         	|  5.9977e-07     	|  61             	|  3.6586e-05     	|  5.2593e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                   	|  7.1049e-07     	|  51             	|  3.6235e-05     	|  5.2088e-05     	|
|  [Callback]MacSummaryCallback.on_validation_start                                                                                                                      	|  6.9839e-07     	|  51             	|  3.5618e-05     	|  5.1201e-05     	|
|  [Callback]PredictionLogger.on_save_checkpoint                                                                                                                         	|  5.8119e-07     	|  61             	|  3.5453e-05     	|  5.0964e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_save_checkpoint       	|  5.7282e-07     	|  61             	|  3.4942e-05     	|  5.0229e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start      	|  6.7189e-07     	|  51             	|  3.4266e-05     	|  4.9258e-05     	|
|  [Callback]PredictionLogger.on_train_epoch_start                                                                                                                       	|  6.8369e-07     	|  50             	|  3.4184e-05     	|  4.914e-05      	|
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                          	|  5.4743e-07     	|  61             	|  3.3393e-05     	|  4.8003e-05     	|
|  [Callback]PredictionLogger.on_validation_start                                                                                                                        	|  6.2449e-07     	|  51             	|  3.1849e-05     	|  4.5783e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                     	|  6.0957e-07     	|  51             	|  3.1088e-05     	|  4.4689e-05     	|
|  [Callback]HydraOptCallback.on_validation_start                                                                                                                        	|  6.0641e-07     	|  51             	|  3.0927e-05     	|  4.4458e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                        	|  6.0583e-07     	|  51             	|  3.0897e-05     	|  4.4415e-05     	|
|  [Callback]PredictionLogger.on_train_epoch_end                                                                                                                         	|  6.1429e-07     	|  50             	|  3.0715e-05     	|  4.4152e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_start                                                                                                      	|  5.9263e-07     	|  51             	|  3.0224e-05     	|  4.3448e-05     	|
|  [Callback]MacSummaryCallback.on_train_epoch_end                                                                                                                       	|  6.0238e-07     	|  50             	|  3.0119e-05     	|  4.3296e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end  	|  5.8237e-07     	|  51             	|  2.9701e-05     	|  4.2695e-05     	|
|  [Callback]LearningRateMonitor.on_train_start                                                                                                                          	|  2.9464e-05     	|  1              	|  2.9464e-05     	|  4.2355e-05     	|
|  [Callback]MacSummaryCallback.on_validation_epoch_start                                                                                                                	|  5.6199e-07     	|  51             	|  2.8662e-05     	|  4.1201e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start	|  5.5932e-07     	|  51             	|  2.8525e-05     	|  4.1006e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                      	|  5.2517e-07     	|  51             	|  2.6784e-05     	|  3.8502e-05     	|
|  [Callback]PredictionLogger.on_validation_epoch_start                                                                                                                  	|  5.2063e-07     	|  51             	|  2.6552e-05     	|  3.8169e-05     	|
|  [Callback]HydraOptCallback.on_train_epoch_end                                                                                                                         	|  5.2743e-07     	|  50             	|  2.6371e-05     	|  3.7909e-05     	|
|  [Callback]HydraOptCallback.on_validation_epoch_start                                                                                                                  	|  5.1623e-07     	|  51             	|  2.6328e-05     	|  3.7846e-05     	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                       	|  3.7958e-06     	|  1              	|  3.7958e-06     	|  5.4566e-06     	|
|  [Callback]LearningRateMonitor.setup                                                                                                                                   	|  3.6252e-06     	|  1              	|  3.6252e-06     	|  5.2112e-06     	|
|  [Callback]LearningRateMonitor.on_sanity_check_start                                                                                                                   	|  3.2452e-06     	|  1              	|  3.2452e-06     	|  4.665e-06      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start             	|  2.9041e-06     	|  1              	|  2.9041e-06     	|  4.1747e-06     	|
|  [LightningModule]ImageClassifierModule.configure_callbacks                                                                                                            	|  2.845e-06      	|  1              	|  2.845e-06      	|  4.0897e-06     	|
|  [Callback]PredictionLogger.setup                                                                                                                                      	|  2.614e-06      	|  1              	|  2.614e-06      	|  3.7576e-06     	|
|  [LightningModule]ImageClassifierModule.on_fit_start                                                                                                                   	|  2.5542e-06     	|  1              	|  2.5542e-06     	|  3.6716e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_start                                                                                                                 	|  2.3339e-06     	|  1              	|  2.3339e-06     	|  3.355e-06      	|
|  [Callback]HydraOptCallback.on_train_start                                                                                                                             	|  2.3029e-06     	|  1              	|  2.3029e-06     	|  3.3105e-06     	|
|  [Callback]LearningRateMonitor.on_train_end                                                                                                                            	|  2.2431e-06     	|  1              	|  2.2431e-06     	|  3.2245e-06     	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                         	|  2.204e-06      	|  1              	|  2.204e-06      	|  3.1682e-06     	|
|  [Callback]LearningRateMonitor.on_fit_end                                                                                                                              	|  1.803e-06      	|  1              	|  1.803e-06      	|  2.5919e-06     	|
|  [Callback]LearningRateMonitor.on_fit_start                                                                                                                            	|  1.8028e-06     	|  1              	|  1.8028e-06     	|  2.5916e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_start           	|  1.733e-06      	|  1              	|  1.733e-06      	|  2.4911e-06     	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                          	|  1.6622e-06     	|  1              	|  1.6622e-06     	|  2.3894e-06     	|
|  [Callback]MacSummaryCallback.setup                                                                                                                                    	|  1.502e-06      	|  1              	|  1.502e-06      	|  2.1591e-06     	|
|  [Callback]LearningRateMonitor.teardown                                                                                                                                	|  1.4219e-06     	|  1              	|  1.4219e-06     	|  2.044e-06      	|
|  [Callback]LearningRateMonitor.on_sanity_check_end                                                                                                                     	|  1.302e-06      	|  1              	|  1.302e-06      	|  1.8716e-06     	|
|  [Callback]ModelSummary.setup                                                                                                                                          	|  1.2419e-06     	|  1              	|  1.2419e-06     	|  1.7853e-06     	|
|  [Callback]MacSummaryCallback.on_train_end                                                                                                                             	|  1.2219e-06     	|  1              	|  1.2219e-06     	|  1.7565e-06     	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                 	|  1.1618e-06     	|  1              	|  1.1618e-06     	|  1.6701e-06     	|
|  [Callback]HydraOptCallback.setup                                                                                                                                      	|  1.0219e-06     	|  1              	|  1.0219e-06     	|  1.469e-06      	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                   	|  9.7207e-07     	|  1              	|  9.7207e-07     	|  1.3974e-06     	|
|  [Callback]HydraOptCallback.on_fit_end                                                                                                                                 	|  9.7207e-07     	|  1              	|  9.7207e-07     	|  1.3974e-06     	|
|  [Callback]MacSummaryCallback.on_fit_start                                                                                                                             	|  9.0105e-07     	|  1              	|  9.0105e-07     	|  1.2953e-06     	|
|  [Callback]MacSummaryCallback.on_sanity_check_start                                                                                                                    	|  9.0105e-07     	|  1              	|  9.0105e-07     	|  1.2953e-06     	|
|  [Callback]HydraOptCallback.on_train_end                                                                                                                               	|  8.7195e-07     	|  1              	|  8.7195e-07     	|  1.2534e-06     	|
|  [Callback]PredictionLogger.on_sanity_check_start                                                                                                                      	|  8.6194e-07     	|  1              	|  8.6194e-07     	|  1.239e-06      	|
|  [Callback]MacSummaryCallback.teardown                                                                                                                                 	|  8.51e-07       	|  1              	|  8.51e-07       	|  1.2233e-06     	|
|  [Callback]MacSummaryCallback.on_fit_end                                                                                                                               	|  8.4098e-07     	|  1              	|  8.4098e-07     	|  1.2089e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_end                                                                                                                   	|  8.3097e-07     	|  1              	|  8.3097e-07     	|  1.1945e-06     	|
|  [LightningModule]ImageClassifierModule.teardown                                                                                                                       	|  8.1188e-07     	|  1              	|  8.1188e-07     	|  1.1671e-06     	|
|  [Callback]MacSummaryCallback.on_sanity_check_end                                                                                                                      	|  8.0094e-07     	|  1              	|  8.0094e-07     	|  1.1514e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_start    	|  7.9093e-07     	|  1              	|  7.9093e-07     	|  1.137e-06      	|
|  [LightningModule]ImageClassifierModule.on_fit_end                                                                                                                     	|  7.7114e-07     	|  1              	|  7.7114e-07     	|  1.1085e-06     	|
|  [Callback]PredictionLogger.on_train_end                                                                                                                               	|  7.6112e-07     	|  1              	|  7.6112e-07     	|  1.0941e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_end             	|  7.4087e-07     	|  1              	|  7.4087e-07     	|  1.065e-06      	|
|  [Callback]PredictionLogger.teardown                                                                                                                                   	|  7.1106e-07     	|  1              	|  7.1106e-07     	|  1.0222e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                 	|  6.8103e-07     	|  1              	|  6.8103e-07     	|  9.7899e-07     	|
|  [Callback]PredictionLogger.on_fit_end                                                                                                                                 	|  6.7102e-07     	|  1              	|  6.7102e-07     	|  9.646e-07      	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                    	|  6.7102e-07     	|  1              	|  6.7102e-07     	|  9.646e-07      	|
|  [Callback]HydraOptCallback.on_fit_start                                                                                                                               	|  6.6101e-07     	|  1              	|  6.6101e-07     	|  9.502e-07      	|
|  [Callback]PredictionLogger.on_train_start                                                                                                                             	|  6.6101e-07     	|  1              	|  6.6101e-07     	|  9.502e-07      	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                         	|  6.6101e-07     	|  1              	|  6.6101e-07     	|  9.502e-07      	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                           	|  6.6007e-07     	|  1              	|  6.6007e-07     	|  9.4886e-07     	|
|  [Callback]PredictionLogger.on_fit_start                                                                                                                               	|  6.5099e-07     	|  1              	|  6.5099e-07     	|  9.3581e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_end      	|  6.4098e-07     	|  1              	|  6.4098e-07     	|  9.2142e-07     	|
|  [Callback]HydraOptCallback.teardown                                                                                                                                   	|  6.4098e-07     	|  1              	|  6.4098e-07     	|  9.2142e-07     	|
|  [Callback]HydraOptCallback.on_sanity_check_end                                                                                                                        	|  6.3097e-07     	|  1              	|  6.3097e-07     	|  9.0703e-07     	|
|  [Callback]PredictionLogger.on_sanity_check_end                                                                                                                        	|  6.2096e-07     	|  1              	|  6.2096e-07     	|  8.9264e-07     	|
|  [Callback]ModelSummary.teardown                                                                                                                                       	|  6.0094e-07     	|  1              	|  6.0094e-07     	|  8.6385e-07     	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                  	|  6e-07          	|  1              	|  6e-07          	|  8.6251e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end               	|  5.9092e-07     	|  1              	|  5.9092e-07     	|  8.4946e-07     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                     	|  5.8091e-07     	|  1              	|  5.8091e-07     	|  8.3507e-07     	|
|  [Callback]HydraOptCallback.on_sanity_check_start                                                                                                                      	|  5.7113e-07     	|  1              	|  5.7113e-07     	|  8.2101e-07     	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                            	|  5.5111e-07     	|  1              	|  5.5111e-07     	|  7.9223e-07     	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                	|  5.1991e-07     	|  1              	|  5.1991e-07     	|  7.4738e-07     	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[2024-05-16 18:45:48,458][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:45:48,458][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:45:48,697][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=18-step=950.ckpt
[2024-05-16 18:45:48,707][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:45:48,885][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=18-step=950.ckpt
[2024-05-16 18:45:49,612][pytorch_lightning.profilers.profiler][INFO] - VALIDATE Profiler Report

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                 	|  -              	|  167070         	|  70.72          	|  100 %          	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                    	|  1.0205         	|  50             	|  51.024         	|  72.149         	|
|  run_training_batch                                                                                                                                                    	|  0.016159       	|  2500           	|  40.398         	|  57.124         	|
|  [LightningModule]ImageClassifierModule.optimizer_step                                                                                                                 	|  0.016102       	|  2500           	|  40.254         	|  56.92          	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                          	|  0.0080132      	|  2500           	|  20.033         	|  28.327         	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_end                                                                                                             	|  0.12666        	|  50             	|  6.333          	|  8.9549         	|
|  [LightningModule]ImageClassifierModule.prepare_data                                                                                                                   	|  2.6768         	|  2              	|  5.3536         	|  7.5701         	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                               	|  0.0017846      	|  2500           	|  4.4616         	|  6.3087         	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                        	|  0.0081045      	|  512            	|  4.1495         	|  5.8675         	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                        	|  0.00072844     	|  3012           	|  2.1941         	|  3.1025         	|
|  [LightningModule]ImageClassifierModule.transfer_batch_to_device                                                                                                       	|  0.00070589     	|  3015           	|  2.1283         	|  3.0094         	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_end       	|  0.041265       	|  50             	|  2.0632         	|  2.9175         	|
|  [LightningModule]ImageClassifierModule.setup                                                                                                                          	|  0.82599        	|  2              	|  1.652          	|  2.3359         	|
|  [_EvaluationLoop].val_next                                                                                                                                            	|  0.0029683      	|  512            	|  1.5198         	|  2.149          	|
|  [LightningModule]ImageClassifierModule.configure_optimizers                                                                                                           	|  1.1962         	|  1              	|  1.1962         	|  1.6914         	|
|  [LightningModule]ImageClassifierModule.train_dataloader                                                                                                               	|  1.1415         	|  1              	|  1.1415         	|  1.6141         	|
|  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                          	|  0.00030161     	|  2500           	|  0.75401        	|  1.0662         	|
|  [Callback]HydraOptCallback.on_train_batch_end                                                                                                                         	|  0.00015522     	|  2500           	|  0.38806        	|  0.54872        	|
|  [Callback]MacSummaryCallback.on_validation_epoch_end                                                                                                                  	|  0.006319       	|  52             	|  0.32859        	|  0.46463        	|
|  [LightningModule]ImageClassifierModule.optimizer_zero_grad                                                                                                            	|  0.00012281     	|  2500           	|  0.30702        	|  0.43413        	|
|  [_TrainingEpochLoop].train_dataloader_next                                                                                                                            	|  9.57e-05       	|  2500           	|  0.23925        	|  0.3383         	|
|  [Callback]LearningRateMonitor.on_train_batch_start                                                                                                                    	|  7.664e-05      	|  2500           	|  0.1916         	|  0.27093        	|
|  [LightningModule]ImageClassifierModule.val_dataloader                                                                                                                 	|  0.087009       	|  2              	|  0.17402        	|  0.24606        	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                   	|  0.17355        	|  1              	|  0.17355        	|  0.24541        	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                     	|  0.00013316     	|  512            	|  0.068178       	|  0.096405       	|
|  [LightningModule]ImageClassifierModule.configure_gradient_clipping                                                                                                    	|  1.3256e-05     	|  2500           	|  0.03314        	|  0.04686        	|
|  [LightningModule]ImageClassifierModule.lr_scheduler_step                                                                                                              	|  1.2531e-05     	|  2500           	|  0.031327       	|  0.044296       	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_end       	|  9.253e-06      	|  2500           	|  0.023132       	|  0.03271        	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                        	|  0.00031882     	|  50             	|  0.015941       	|  0.022541       	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                   	|  2.6862e-05     	|  512            	|  0.013754       	|  0.019448       	|
|  [LightningModule]ImageClassifierModule.on_validation_model_zero_grad                                                                                                  	|  0.00026212     	|  50             	|  0.013106       	|  0.018532       	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                           	|  0.00024336     	|  52             	|  0.012655       	|  0.017894       	|
|  [LightningModule]ImageClassifierModule.on_validation_model_eval                                                                                                       	|  0.00022976     	|  52             	|  0.011948       	|  0.016894       	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                         	|  0.00020141     	|  52             	|  0.010473       	|  0.01481        	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                          	|  0.00014369     	|  50             	|  0.0071843      	|  0.010159       	|
|  [Callback]HydraOptCallback.on_validation_end                                                                                                                          	|  0.00012224     	|  52             	|  0.0063565      	|  0.0089883      	|
|  [Callback]MacSummaryCallback.on_train_start                                                                                                                           	|  0.00617        	|  1              	|  0.00617        	|  0.0087245      	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                       	|  0.0041188      	|  1              	|  0.0041188      	|  0.0058241      	|
|  [Callback]ModelSummary.on_train_batch_end                                                                                                                             	|  1.5324e-06     	|  2500           	|  0.0038311      	|  0.0054172      	|
|  [Callback]LearningRateMonitor.on_before_zero_grad                                                                                                                     	|  1.4542e-06     	|  2500           	|  0.0036355      	|  0.0051406      	|
|  [Callback]LearningRateMonitor.on_train_batch_end                                                                                                                      	|  1.2997e-06     	|  2500           	|  0.0032492      	|  0.0045945      	|
|  [Callback]LearningRateMonitor.on_before_backward                                                                                                                      	|  1.2866e-06     	|  2500           	|  0.0032165      	|  0.0045481      	|
|  [Callback]PredictionLogger.on_train_batch_end                                                                                                                         	|  1.2413e-06     	|  2500           	|  0.0031032      	|  0.0043879      	|
|  [Callback]LearningRateMonitor.on_after_backward                                                                                                                       	|  1.1769e-06     	|  2500           	|  0.0029421      	|  0.0041603      	|
|  [Callback]LearningRateMonitor.on_before_optimizer_step                                                                                                                	|  1.1739e-06     	|  2500           	|  0.0029348      	|  0.0041499      	|
|  [Callback]MacSummaryCallback.on_train_batch_start                                                                                                                     	|  1.0654e-06     	|  2500           	|  0.0026636      	|  0.0037663      	|
|  [Callback]LearningRateMonitor.on_train_epoch_start                                                                                                                    	|  4.1954e-05     	|  50             	|  0.0020977      	|  0.0029662      	|
|  [Callback]MacSummaryCallback.on_before_zero_grad                                                                                                                      	|  8.3788e-07     	|  2500           	|  0.0020947      	|  0.0029619      	|
|  [LightningModule]ImageClassifierModule.on_before_batch_transfer                                                                                                       	|  6.7425e-07     	|  3015           	|  0.0020329      	|  0.0028745      	|
|  [Callback]MacSummaryCallback.on_train_batch_end                                                                                                                       	|  7.7805e-07     	|  2500           	|  0.0019451      	|  0.0027504      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_start     	|  7.7623e-07     	|  2500           	|  0.0019406      	|  0.002744       	|
|  [Callback]MacSummaryCallback.on_before_optimizer_step                                                                                                                 	|  7.7023e-07     	|  2500           	|  0.0019256      	|  0.0027228      	|
|  [Callback]MacSummaryCallback.on_after_backward                                                                                                                        	|  7.043e-07      	|  2500           	|  0.0017607      	|  0.0024897      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_zero_grad      	|  6.9782e-07     	|  2500           	|  0.0017445      	|  0.0024668      	|
|  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                        	|  6.7577e-07     	|  2500           	|  0.0016894      	|  0.0023889      	|
|  [LightningModule]ImageClassifierModule.on_after_batch_transfer                                                                                                        	|  5.5113e-07     	|  3015           	|  0.0016616      	|  0.0023496      	|
|  [Callback]PredictionLogger.on_before_backward                                                                                                                         	|  6.6054e-07     	|  2500           	|  0.0016514      	|  0.0023351      	|
|  [Callback]MacSummaryCallback.on_before_backward                                                                                                                       	|  6.5536e-07     	|  2500           	|  0.0016384      	|  0.0023167      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_backward       	|  6.5402e-07     	|  2500           	|  0.0016351      	|  0.002312       	|
|  [LightningModule]ImageClassifierModule.on_train_batch_end                                                                                                             	|  6.5051e-07     	|  2500           	|  0.0016263      	|  0.0022996      	|
|  [Callback]PredictionLogger.on_before_zero_grad                                                                                                                        	|  6.5e-07        	|  2500           	|  0.001625       	|  0.0022978      	|
|  [Callback]HydraOptCallback.on_before_optimizer_step                                                                                                                   	|  6.2986e-07     	|  2500           	|  0.0015747      	|  0.0022266      	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                             	|  6.1565e-07     	|  2500           	|  0.0015391      	|  0.0021764      	|
|  [Callback]HydraOptCallback.on_train_batch_start                                                                                                                       	|  6.1461e-07     	|  2500           	|  0.0015365      	|  0.0021727      	|
|  [LightningModule]ImageClassifierModule.on_before_zero_grad                                                                                                            	|  6.1227e-07     	|  2500           	|  0.0015307      	|  0.0021644      	|
|  [Callback]HydraOptCallback.on_before_zero_grad                                                                                                                        	|  6.0186e-07     	|  2500           	|  0.0015047      	|  0.0021276      	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                           	|  5.9608e-07     	|  2500           	|  0.0014902      	|  0.0021072      	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                       	|  5.9017e-07     	|  2500           	|  0.0014754      	|  0.0020863      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_after_backward        	|  5.7884e-07     	|  2500           	|  0.0014471      	|  0.0020462      	|
|  [Callback]PredictionLogger.on_after_backward                                                                                                                          	|  5.6338e-07     	|  2500           	|  0.0014084      	|  0.0019916      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_optimizer_step 	|  5.467e-07      	|  2500           	|  0.0013667      	|  0.0019326      	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                         	|  5.456e-07      	|  2500           	|  0.001364       	|  0.0019287      	|
|  [Callback]PredictionLogger.on_train_batch_start                                                                                                                       	|  5.4502e-07     	|  2500           	|  0.0013626      	|  0.0019267      	|
|  [Callback]ModelSummary.on_train_batch_start                                                                                                                           	|  5.4377e-07     	|  2500           	|  0.0013594      	|  0.0019222      	|
|  [Callback]HydraOptCallback.on_before_backward                                                                                                                         	|  5.2966e-07     	|  2500           	|  0.0013242      	|  0.0018724      	|
|  [Callback]PredictionLogger.on_before_optimizer_step                                                                                                                   	|  5.1431e-07     	|  2500           	|  0.0012858      	|  0.0018181      	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                          	|  5.1312e-07     	|  2500           	|  0.0012828      	|  0.0018139      	|
|  [Callback]HydraOptCallback.on_after_backward                                                                                                                          	|  5.1155e-07     	|  2500           	|  0.0012789      	|  0.0018084      	|
|  [LightningModule]ImageClassifierModule.on_after_backward                                                                                                              	|  5.1024e-07     	|  2500           	|  0.0012756      	|  0.0018037      	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                            	|  5.0288e-07     	|  2500           	|  0.0012572      	|  0.0017777      	|
|  [LightningModule]ImageClassifierModule.on_before_backward                                                                                                             	|  4.9546e-07     	|  2500           	|  0.0012387      	|  0.0017515      	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                              	|  4.9473e-07     	|  2500           	|  0.0012368      	|  0.0017489      	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                    	|  4.9214e-07     	|  2500           	|  0.0012303      	|  0.0017397      	|
|  [LightningModule]ImageClassifierModule.on_train_batch_start                                                                                                           	|  4.7515e-07     	|  2500           	|  0.0011879      	|  0.0016797      	|
|  [LightningModule]ImageClassifierModule.on_before_optimizer_step                                                                                                       	|  4.5229e-07     	|  2500           	|  0.0011307      	|  0.0015989      	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                   	|  4.1718e-07     	|  2500           	|  0.0010429      	|  0.0014748      	|
|  [LightningModule]ImageClassifierModule.on_load_checkpoint                                                                                                             	|  0.00086538     	|  1              	|  0.00086538     	|  0.0012237      	|
|  [Callback]LearningRateMonitor.on_validation_batch_end                                                                                                                 	|  1.4883e-06     	|  512            	|  0.00076199     	|  0.0010775      	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_end                                                                                                        	|  1.308e-05      	|  52             	|  0.00068017     	|  0.00096178     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end        	|  1.3049e-05     	|  52             	|  0.00067853     	|  0.00095945     	|
|  [Callback]PredictionLogger.on_validation_batch_end                                                                                                                    	|  1.3064e-06     	|  512            	|  0.00066887     	|  0.0009458      	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                        	|  1.1653e-06     	|  512            	|  0.00059662     	|  0.00084363     	|
|  [Callback]LearningRateMonitor.on_validation_batch_start                                                                                                               	|  1.1432e-06     	|  512            	|  0.00058533     	|  0.00082767     	|
|  [Callback]MacSummaryCallback.on_validation_batch_end                                                                                                                  	|  8.8141e-07     	|  512            	|  0.00045128     	|  0.00063812     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end  	|  8.4773e-07     	|  512            	|  0.00043404     	|  0.00061374     	|
|  [Callback]HydraOptCallback.on_validation_batch_end                                                                                                                    	|  7.4099e-07     	|  512            	|  0.00037939     	|  0.00053646     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start	|  6.6759e-07     	|  512            	|  0.00034181     	|  0.00048332     	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                      	|  6.5067e-07     	|  512            	|  0.00033314     	|  0.00047107     	|
|  [Callback]HydraOptCallback.on_validation_batch_start                                                                                                                  	|  6.3968e-07     	|  512            	|  0.00032752     	|  0.00046312     	|
|  [Callback]MacSummaryCallback.on_validation_batch_start                                                                                                                	|  6.3828e-07     	|  512            	|  0.0003268      	|  0.0004621      	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_end                                                                                                        	|  6.3176e-07     	|  512            	|  0.00032346     	|  0.00045738     	|
|  [Callback]PredictionLogger.on_validation_batch_start                                                                                                                  	|  5.5753e-07     	|  512            	|  0.00028546     	|  0.00040364     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                    	|  0.00013997     	|  2              	|  0.00027994     	|  0.00039584     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_start                                                                                                      	|  4.9416e-07     	|  512            	|  0.00025301     	|  0.00035776     	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                	|  0.00021488     	|  1              	|  0.00021488     	|  0.00030385     	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                              	|  0.00017798     	|  1              	|  0.00017798     	|  0.00025166     	|
|  [LightningModule]ImageClassifierModule.on_save_checkpoint                                                                                                             	|  2.5152e-06     	|  61             	|  0.00015343     	|  0.00021695     	|
|  [Callback]LearningRateMonitor.on_save_checkpoint                                                                                                                      	|  1.7839e-06     	|  61             	|  0.00010882     	|  0.00015387     	|
|  [Callback]PredictionLogger.on_validation_epoch_end                                                                                                                    	|  1.7522e-06     	|  52             	|  9.1116e-05     	|  0.00012884     	|
|  [Callback]HydraOptCallback.on_validation_epoch_end                                                                                                                    	|  1.7227e-06     	|  52             	|  8.9582e-05     	|  0.00012667     	|
|  [Callback]MacSummaryCallback.on_train_epoch_start                                                                                                                     	|  1.6487e-06     	|  50             	|  8.2435e-05     	|  0.00011656     	|
|  [Callback]LearningRateMonitor.on_validation_end                                                                                                                       	|  1.5225e-06     	|  52             	|  7.9171e-05     	|  0.00011195     	|
|  [Callback]LearningRateMonitor.on_validation_epoch_end                                                                                                                 	|  1.3805e-06     	|  52             	|  7.1788e-05     	|  0.00010151     	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                              	|  1.369e-06      	|  52             	|  7.1187e-05     	|  0.00010066     	|
|  [Callback]LearningRateMonitor.on_validation_start                                                                                                                     	|  1.3227e-06     	|  52             	|  6.878e-05      	|  9.7257e-05     	|
|  [Callback]LearningRateMonitor.on_train_epoch_end                                                                                                                      	|  1.2748e-06     	|  50             	|  6.3738e-05     	|  9.0127e-05     	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                            	|  1.1955e-06     	|  52             	|  6.2168e-05     	|  8.7907e-05     	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                             	|  1.1423e-06     	|  50             	|  5.7116e-05     	|  8.0764e-05     	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                           	|  1.0936e-06     	|  50             	|  5.4678e-05     	|  7.7316e-05     	|
|  [Callback]LearningRateMonitor.on_validation_epoch_start                                                                                                               	|  9.5719e-07     	|  52             	|  4.9774e-05     	|  7.0381e-05     	|
|  [Callback]MacSummaryCallback.on_save_checkpoint                                                                                                                       	|  7.491e-07      	|  61             	|  4.5695e-05     	|  6.4613e-05     	|
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                             	|  7.279e-07      	|  61             	|  4.4402e-05     	|  6.2785e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                      	|  8.4664e-07     	|  52             	|  4.4025e-05     	|  6.2253e-05     	|
|  [Callback]PredictionLogger.on_validation_end                                                                                                                          	|  8.0359e-07     	|  52             	|  4.1787e-05     	|  5.9087e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_end                                                                                                              	|  7.7531e-07     	|  52             	|  4.0316e-05     	|  5.7008e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_start                                                                                                            	|  7.5579e-07     	|  52             	|  3.9301e-05     	|  5.5572e-05     	|
|  [Callback]MacSummaryCallback.on_validation_end                                                                                                                        	|  7.5468e-07     	|  52             	|  3.9244e-05     	|  5.5491e-05     	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_start                                                                                                           	|  7.8481e-07     	|  50             	|  3.924e-05      	|  5.5487e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_start     	|  7.7597e-07     	|  50             	|  3.8798e-05     	|  5.4862e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                    	|  7.2899e-07     	|  52             	|  3.7908e-05     	|  5.3602e-05     	|
|  [Callback]HydraOptCallback.on_train_epoch_start                                                                                                                       	|  7.452e-07      	|  50             	|  3.726e-05      	|  5.2686e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                   	|  7.08e-07       	|  52             	|  3.6816e-05     	|  5.2058e-05     	|
|  [Callback]HydraOptCallback.on_save_checkpoint                                                                                                                         	|  5.9977e-07     	|  61             	|  3.6586e-05     	|  5.1733e-05     	|
|  [Callback]MacSummaryCallback.on_validation_start                                                                                                                      	|  7e-07          	|  52             	|  3.64e-05       	|  5.147e-05      	|
|  [Callback]PredictionLogger.on_save_checkpoint                                                                                                                         	|  5.8119e-07     	|  61             	|  3.5453e-05     	|  5.0131e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start      	|  6.7341e-07     	|  52             	|  3.5017e-05     	|  4.9515e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_save_checkpoint       	|  5.7282e-07     	|  61             	|  3.4942e-05     	|  4.9408e-05     	|
|  [Callback]PredictionLogger.on_train_epoch_start                                                                                                                       	|  6.8369e-07     	|  50             	|  3.4184e-05     	|  4.8337e-05     	|
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                          	|  5.4743e-07     	|  61             	|  3.3393e-05     	|  4.7218e-05     	|
|  [Callback]PredictionLogger.on_validation_start                                                                                                                        	|  6.2404e-07     	|  52             	|  3.245e-05      	|  4.5885e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                     	|  6.1017e-07     	|  52             	|  3.1729e-05     	|  4.4865e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                        	|  6.0805e-07     	|  52             	|  3.1618e-05     	|  4.4709e-05     	|
|  [Callback]HydraOptCallback.on_validation_start                                                                                                                        	|  6.0689e-07     	|  52             	|  3.1558e-05     	|  4.4624e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_start                                                                                                      	|  5.9356e-07     	|  52             	|  3.0865e-05     	|  4.3644e-05     	|
|  [Callback]PredictionLogger.on_train_epoch_end                                                                                                                         	|  6.1429e-07     	|  50             	|  3.0715e-05     	|  4.3431e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end  	|  5.8273e-07     	|  52             	|  3.0302e-05     	|  4.2848e-05     	|
|  [Callback]MacSummaryCallback.on_train_epoch_end                                                                                                                       	|  6.0238e-07     	|  50             	|  3.0119e-05     	|  4.2589e-05     	|
|  [Callback]LearningRateMonitor.on_train_start                                                                                                                          	|  2.9464e-05     	|  1              	|  2.9464e-05     	|  4.1663e-05     	|
|  [Callback]MacSummaryCallback.on_validation_epoch_start                                                                                                                	|  5.6409e-07     	|  52             	|  2.9333e-05     	|  4.1477e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start	|  5.607e-07      	|  52             	|  2.9156e-05     	|  4.1228e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                      	|  5.2663e-07     	|  52             	|  2.7385e-05     	|  3.8723e-05     	|
|  [Callback]PredictionLogger.on_validation_epoch_start                                                                                                                  	|  5.2199e-07     	|  52             	|  2.7143e-05     	|  3.8381e-05     	|
|  [Callback]HydraOptCallback.on_validation_epoch_start                                                                                                                  	|  5.1805e-07     	|  52             	|  2.6939e-05     	|  3.8092e-05     	|
|  [Callback]HydraOptCallback.on_train_epoch_end                                                                                                                         	|  5.2743e-07     	|  50             	|  2.6371e-05     	|  3.729e-05      	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                       	|  3.6104e-06     	|  2              	|  7.2208e-06     	|  1.021e-05      	|
|  [Callback]LearningRateMonitor.setup                                                                                                                                   	|  2.8241e-06     	|  2              	|  5.6482e-06     	|  7.9867e-06     	|
|  [Callback]PredictionLogger.setup                                                                                                                                      	|  2.594e-06      	|  2              	|  5.1879e-06     	|  7.3358e-06     	|
|  [LightningModule]ImageClassifierModule.configure_callbacks                                                                                                            	|  1.9929e-06     	|  2              	|  3.9858e-06     	|  5.636e-06      	|
|  [Callback]LearningRateMonitor.teardown                                                                                                                                	|  1.7325e-06     	|  2              	|  3.465e-06      	|  4.8996e-06     	|
|  [Callback]LearningRateMonitor.on_sanity_check_start                                                                                                                   	|  3.2452e-06     	|  1              	|  3.2452e-06     	|  4.5888e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start             	|  2.9041e-06     	|  1              	|  2.9041e-06     	|  4.1065e-06     	|
|  [LightningModule]ImageClassifierModule.on_fit_start                                                                                                                   	|  2.5542e-06     	|  1              	|  2.5542e-06     	|  3.6116e-06     	|
|  [Callback]MacSummaryCallback.setup                                                                                                                                    	|  1.2266e-06     	|  2              	|  2.4531e-06     	|  3.4687e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_start                                                                                                                 	|  2.3339e-06     	|  1              	|  2.3339e-06     	|  3.3002e-06     	|
|  [Callback]HydraOptCallback.on_train_start                                                                                                                             	|  2.3029e-06     	|  1              	|  2.3029e-06     	|  3.2564e-06     	|
|  [Callback]LearningRateMonitor.on_train_end                                                                                                                            	|  2.2431e-06     	|  1              	|  2.2431e-06     	|  3.1718e-06     	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                         	|  2.204e-06      	|  1              	|  2.204e-06      	|  3.1165e-06     	|
|  [Callback]ModelSummary.setup                                                                                                                                          	|  1.0219e-06     	|  2              	|  2.0438e-06     	|  2.89e-06       	|
|  [Callback]MacSummaryCallback.teardown                                                                                                                                 	|  1.0059e-06     	|  2              	|  2.0119e-06     	|  2.8449e-06     	|
|  [LightningModule]ImageClassifierModule.teardown                                                                                                                       	|  9.0688e-07     	|  2              	|  1.8138e-06     	|  2.5647e-06     	|
|  [Callback]LearningRateMonitor.on_fit_end                                                                                                                              	|  1.803e-06      	|  1              	|  1.803e-06      	|  2.5495e-06     	|
|  [Callback]LearningRateMonitor.on_fit_start                                                                                                                            	|  1.8028e-06     	|  1              	|  1.8028e-06     	|  2.5492e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_start           	|  1.733e-06      	|  1              	|  1.733e-06      	|  2.4504e-06     	|
|  [Callback]HydraOptCallback.setup                                                                                                                                      	|  8.5647e-07     	|  2              	|  1.7129e-06     	|  2.4221e-06     	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                          	|  1.6622e-06     	|  1              	|  1.6622e-06     	|  2.3504e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                 	|  7.0606e-07     	|  2              	|  1.4121e-06     	|  1.9968e-06     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                    	|  6.8103e-07     	|  2              	|  1.3621e-06     	|  1.926e-06      	|
|  [Callback]HydraOptCallback.teardown                                                                                                                                   	|  6.6601e-07     	|  2              	|  1.332e-06      	|  1.8835e-06     	|
|  [Callback]PredictionLogger.teardown                                                                                                                                   	|  6.56e-07       	|  2              	|  1.312e-06      	|  1.8552e-06     	|
|  [Callback]LearningRateMonitor.on_sanity_check_end                                                                                                                     	|  1.302e-06      	|  1              	|  1.302e-06      	|  1.841e-06      	|
|  [Callback]ModelSummary.teardown                                                                                                                                       	|  6.5088e-07     	|  2              	|  1.3018e-06     	|  1.8407e-06     	|
|  [Callback]MacSummaryCallback.on_train_end                                                                                                                             	|  1.2219e-06     	|  1              	|  1.2219e-06     	|  1.7278e-06     	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                 	|  1.1618e-06     	|  1              	|  1.1618e-06     	|  1.6428e-06     	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                   	|  9.7207e-07     	|  1              	|  9.7207e-07     	|  1.3745e-06     	|
|  [Callback]HydraOptCallback.on_fit_end                                                                                                                                 	|  9.7207e-07     	|  1              	|  9.7207e-07     	|  1.3745e-06     	|
|  [Callback]MacSummaryCallback.on_fit_start                                                                                                                             	|  9.0105e-07     	|  1              	|  9.0105e-07     	|  1.2741e-06     	|
|  [Callback]MacSummaryCallback.on_sanity_check_start                                                                                                                    	|  9.0105e-07     	|  1              	|  9.0105e-07     	|  1.2741e-06     	|
|  [Callback]HydraOptCallback.on_train_end                                                                                                                               	|  8.7195e-07     	|  1              	|  8.7195e-07     	|  1.233e-06      	|
|  [Callback]PredictionLogger.on_sanity_check_start                                                                                                                      	|  8.6194e-07     	|  1              	|  8.6194e-07     	|  1.2188e-06     	|
|  [Callback]MacSummaryCallback.on_fit_end                                                                                                                               	|  8.4098e-07     	|  1              	|  8.4098e-07     	|  1.1892e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_end                                                                                                                   	|  8.3097e-07     	|  1              	|  8.3097e-07     	|  1.175e-06      	|
|  [Callback]MacSummaryCallback.on_sanity_check_end                                                                                                                      	|  8.0094e-07     	|  1              	|  8.0094e-07     	|  1.1325e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_start    	|  7.9093e-07     	|  1              	|  7.9093e-07     	|  1.1184e-06     	|
|  [LightningModule]ImageClassifierModule.on_fit_end                                                                                                                     	|  7.7114e-07     	|  1              	|  7.7114e-07     	|  1.0904e-06     	|
|  [Callback]PredictionLogger.on_train_end                                                                                                                               	|  7.6112e-07     	|  1              	|  7.6112e-07     	|  1.0762e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_end             	|  7.4087e-07     	|  1              	|  7.4087e-07     	|  1.0476e-06     	|
|  [Callback]PredictionLogger.on_fit_end                                                                                                                                 	|  6.7102e-07     	|  1              	|  6.7102e-07     	|  9.4883e-07     	|
|  [Callback]HydraOptCallback.on_fit_start                                                                                                                               	|  6.6101e-07     	|  1              	|  6.6101e-07     	|  9.3468e-07     	|
|  [Callback]PredictionLogger.on_train_start                                                                                                                             	|  6.6101e-07     	|  1              	|  6.6101e-07     	|  9.3468e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                         	|  6.6101e-07     	|  1              	|  6.6101e-07     	|  9.3468e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                           	|  6.6007e-07     	|  1              	|  6.6007e-07     	|  9.3336e-07     	|
|  [Callback]PredictionLogger.on_fit_start                                                                                                                               	|  6.5099e-07     	|  1              	|  6.5099e-07     	|  9.2052e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_end      	|  6.4098e-07     	|  1              	|  6.4098e-07     	|  9.0636e-07     	|
|  [Callback]HydraOptCallback.on_sanity_check_end                                                                                                                        	|  6.3097e-07     	|  1              	|  6.3097e-07     	|  8.9221e-07     	|
|  [Callback]PredictionLogger.on_sanity_check_end                                                                                                                        	|  6.2096e-07     	|  1              	|  6.2096e-07     	|  8.7805e-07     	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                  	|  6e-07          	|  1              	|  6e-07          	|  8.4842e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end               	|  5.9092e-07     	|  1              	|  5.9092e-07     	|  8.3558e-07     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                     	|  5.8091e-07     	|  1              	|  5.8091e-07     	|  8.2142e-07     	|
|  [Callback]HydraOptCallback.on_sanity_check_start                                                                                                                      	|  5.7113e-07     	|  1              	|  5.7113e-07     	|  8.0759e-07     	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                            	|  5.5111e-07     	|  1              	|  5.5111e-07     	|  7.7928e-07     	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                	|  5.1991e-07     	|  1              	|  5.1991e-07     	|  7.3516e-07     	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[2024-05-16 18:45:49,614][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:45:49,614][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:45:50,110][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=18-step=950.ckpt
[2024-05-16 18:45:50,121][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:45:50,298][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=18-step=950.ckpt
[2024-05-16 18:45:51,001][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:45:51,001][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:45:51,001][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:45:51,002][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:45:51,002][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:45:51,002][hannah.datasets.base][WARNING] - Datasets class names contain classes that are longer than the recommended lenght of 5 characters, consider implementing class_names_abbreviated in your dataset
[2024-05-16 18:45:51,002][hannah.datasets.base][WARNING] - Datasets class names contain classes that are longer than the recommended lenght of 5 characters, consider implementing class_names_abbreviated in your dataset
[2024-05-16 18:45:51,648][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/torchmetrics/utilities/prints.py:43: UserWarning: The ``compute`` method of metric MulticlassROC was called before the ``update`` method which may lead to errors, as metric states have not yet been updated.
  warnings.warn(*args, **kwargs)  # noqa: B028

[2024-05-16 18:45:51,652][hannah.datasets.base][WARNING] - Datasets class names contain classes that are longer than the recommended lenght of 5 characters, consider implementing class_names_abbreviated in your dataset
[2024-05-16 18:45:51,750][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/torchmetrics/utilities/prints.py:43: UserWarning: The ``compute`` method of metric MulticlassPrecisionRecallCurve was called before the ``update`` method which may lead to errors, as metric states have not yet been updated.
  warnings.warn(*args, **kwargs)  # noqa: B028

[2024-05-16 18:45:51,754][hannah.datasets.base][WARNING] - Datasets class names contain classes that are longer than the recommended lenght of 5 characters, consider implementing class_names_abbreviated in your dataset
[2024-05-16 18:45:51,884][pytorch_lightning.profilers.profiler][INFO] - TEST Profiler Report

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                 	|  -              	|  167348         	|  72.992         	|  100 %          	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                    	|  1.0205         	|  50             	|  51.024         	|  69.904         	|
|  run_training_batch                                                                                                                                                    	|  0.016159       	|  2500           	|  40.398         	|  55.346         	|
|  [LightningModule]ImageClassifierModule.optimizer_step                                                                                                                 	|  0.016102       	|  2500           	|  40.254         	|  55.149         	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                          	|  0.0080132      	|  2500           	|  20.033         	|  27.446         	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_end                                                                                                             	|  0.12666        	|  50             	|  6.333          	|  8.6763         	|
|  [LightningModule]ImageClassifierModule.prepare_data                                                                                                                   	|  1.9494         	|  3              	|  5.8481         	|  8.012          	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                               	|  0.0017846      	|  2500           	|  4.4616         	|  6.1124         	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                        	|  0.0081045      	|  512            	|  4.1495         	|  5.6849         	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                        	|  0.00072846     	|  3022           	|  2.2014         	|  3.016          	|
|  [LightningModule]ImageClassifierModule.transfer_batch_to_device                                                                                                       	|  0.00070569     	|  3026           	|  2.1354         	|  2.9256         	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_end       	|  0.041265       	|  50             	|  2.0632         	|  2.8267         	|
|  [LightningModule]ImageClassifierModule.setup                                                                                                                          	|  0.55084        	|  3              	|  1.6525         	|  2.264          	|
|  [_EvaluationLoop].val_next                                                                                                                                            	|  0.0029683      	|  512            	|  1.5198         	|  2.0821         	|
|  [LightningModule]ImageClassifierModule.configure_optimizers                                                                                                           	|  1.1962         	|  1              	|  1.1962         	|  1.6388         	|
|  [LightningModule]ImageClassifierModule.train_dataloader                                                                                                               	|  1.1415         	|  1              	|  1.1415         	|  1.5638         	|
|  [LightningModule]ImageClassifierModule.on_test_end                                                                                                                    	|  0.84807        	|  1              	|  0.84807        	|  1.1619         	|
|  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                          	|  0.00030161     	|  2500           	|  0.75401        	|  1.033          	|
|  [_EvaluationLoop].test_next                                                                                                                                           	|  0.050763       	|  10             	|  0.50763        	|  0.69546        	|
|  [Callback]HydraOptCallback.on_train_batch_end                                                                                                                         	|  0.00015522     	|  2500           	|  0.38806        	|  0.53165        	|
|  [Callback]MacSummaryCallback.on_validation_epoch_end                                                                                                                  	|  0.006319       	|  52             	|  0.32859        	|  0.45017        	|
|  [LightningModule]ImageClassifierModule.optimizer_zero_grad                                                                                                            	|  0.00012281     	|  2500           	|  0.30702        	|  0.42062        	|
|  [_TrainingEpochLoop].train_dataloader_next                                                                                                                            	|  9.57e-05       	|  2500           	|  0.23925        	|  0.32778        	|
|  [Callback]LearningRateMonitor.on_train_batch_start                                                                                                                    	|  7.664e-05      	|  2500           	|  0.1916         	|  0.2625         	|
|  [LightningModule]ImageClassifierModule.val_dataloader                                                                                                                 	|  0.087009       	|  2              	|  0.17402        	|  0.23841        	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                   	|  0.17355        	|  1              	|  0.17355        	|  0.23777        	|
|  [Strategy]SingleDeviceStrategy.test_step                                                                                                                              	|  0.0083992      	|  10             	|  0.083992       	|  0.11507        	|
|  [LightningModule]ImageClassifierModule.test_dataloader                                                                                                                	|  0.068838       	|  1              	|  0.068838       	|  0.09431        	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                     	|  0.00013316     	|  512            	|  0.068178       	|  0.093405       	|
|  [LightningModule]ImageClassifierModule.configure_gradient_clipping                                                                                                    	|  1.3256e-05     	|  2500           	|  0.03314        	|  0.045402       	|
|  [LightningModule]ImageClassifierModule.lr_scheduler_step                                                                                                              	|  1.2531e-05     	|  2500           	|  0.031327       	|  0.042918       	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_end       	|  9.253e-06      	|  2500           	|  0.023132       	|  0.031692       	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                        	|  0.00031882     	|  50             	|  0.015941       	|  0.02184        	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                   	|  2.6862e-05     	|  512            	|  0.013754       	|  0.018843       	|
|  [LightningModule]ImageClassifierModule.on_validation_model_zero_grad                                                                                                  	|  0.00026212     	|  50             	|  0.013106       	|  0.017955       	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                           	|  0.00024336     	|  52             	|  0.012655       	|  0.017337       	|
|  [LightningModule]ImageClassifierModule.on_validation_model_eval                                                                                                       	|  0.00022976     	|  52             	|  0.011948       	|  0.016369       	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                         	|  0.00020141     	|  52             	|  0.010473       	|  0.014349       	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                          	|  0.00014369     	|  50             	|  0.0071843      	|  0.0098426      	|
|  [Callback]HydraOptCallback.on_validation_end                                                                                                                          	|  0.00012224     	|  52             	|  0.0063565      	|  0.0087086      	|
|  [Callback]MacSummaryCallback.on_test_end                                                                                                                              	|  0.0062587      	|  1              	|  0.0062587      	|  0.0085745      	|
|  [Callback]MacSummaryCallback.on_train_start                                                                                                                           	|  0.00617        	|  1              	|  0.00617        	|  0.008453       	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                       	|  0.0041188      	|  1              	|  0.0041188      	|  0.0056429      	|
|  [Callback]ModelSummary.on_train_batch_end                                                                                                                             	|  1.5324e-06     	|  2500           	|  0.0038311      	|  0.0052486      	|
|  [Callback]LearningRateMonitor.on_before_zero_grad                                                                                                                     	|  1.4542e-06     	|  2500           	|  0.0036355      	|  0.0049807      	|
|  [Callback]LearningRateMonitor.on_train_batch_end                                                                                                                      	|  1.2997e-06     	|  2500           	|  0.0032492      	|  0.0044515      	|
|  [Callback]LearningRateMonitor.on_before_backward                                                                                                                      	|  1.2866e-06     	|  2500           	|  0.0032165      	|  0.0044066      	|
|  [Callback]PredictionLogger.on_train_batch_end                                                                                                                         	|  1.2413e-06     	|  2500           	|  0.0031032      	|  0.0042514      	|
|  [Callback]LearningRateMonitor.on_after_backward                                                                                                                       	|  1.1769e-06     	|  2500           	|  0.0029421      	|  0.0040308      	|
|  [Callback]LearningRateMonitor.on_before_optimizer_step                                                                                                                	|  1.1739e-06     	|  2500           	|  0.0029348      	|  0.0040208      	|
|  [Callback]MacSummaryCallback.on_train_batch_start                                                                                                                     	|  1.0654e-06     	|  2500           	|  0.0026636      	|  0.0036491      	|
|  [Callback]LearningRateMonitor.on_train_epoch_start                                                                                                                    	|  4.1954e-05     	|  50             	|  0.0020977      	|  0.0028739      	|
|  [Callback]MacSummaryCallback.on_before_zero_grad                                                                                                                      	|  8.3788e-07     	|  2500           	|  0.0020947      	|  0.0028698      	|
|  [LightningModule]ImageClassifierModule.on_before_batch_transfer                                                                                                       	|  6.7497e-07     	|  3026           	|  0.0020425      	|  0.0027982      	|
|  [Callback]MacSummaryCallback.on_train_batch_end                                                                                                                       	|  7.7805e-07     	|  2500           	|  0.0019451      	|  0.0026649      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_start     	|  7.7623e-07     	|  2500           	|  0.0019406      	|  0.0026586      	|
|  [Callback]MacSummaryCallback.on_before_optimizer_step                                                                                                                 	|  7.7023e-07     	|  2500           	|  0.0019256      	|  0.0026381      	|
|  [Callback]MacSummaryCallback.on_after_backward                                                                                                                        	|  7.043e-07      	|  2500           	|  0.0017607      	|  0.0024123      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_zero_grad      	|  6.9782e-07     	|  2500           	|  0.0017445      	|  0.0023901      	|
|  [LightningModule]ImageClassifierModule.on_load_checkpoint                                                                                                             	|  0.00085641     	|  2              	|  0.0017128      	|  0.0023466      	|
|  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                        	|  6.7577e-07     	|  2500           	|  0.0016894      	|  0.0023146      	|
|  [LightningModule]ImageClassifierModule.on_after_batch_transfer                                                                                                        	|  5.5109e-07     	|  3026           	|  0.0016676      	|  0.0022846      	|
|  [Callback]PredictionLogger.on_before_backward                                                                                                                         	|  6.6054e-07     	|  2500           	|  0.0016514      	|  0.0022624      	|
|  [Callback]MacSummaryCallback.on_before_backward                                                                                                                       	|  6.5536e-07     	|  2500           	|  0.0016384      	|  0.0022447      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_backward       	|  6.5402e-07     	|  2500           	|  0.0016351      	|  0.0022401      	|
|  [LightningModule]ImageClassifierModule.on_train_batch_end                                                                                                             	|  6.5051e-07     	|  2500           	|  0.0016263      	|  0.002228       	|
|  [Callback]PredictionLogger.on_before_zero_grad                                                                                                                        	|  6.5e-07        	|  2500           	|  0.001625       	|  0.0022263      	|
|  [Callback]HydraOptCallback.on_before_optimizer_step                                                                                                                   	|  6.2986e-07     	|  2500           	|  0.0015747      	|  0.0021573      	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                             	|  6.1565e-07     	|  2500           	|  0.0015391      	|  0.0021086      	|
|  [Callback]HydraOptCallback.on_train_batch_start                                                                                                                       	|  6.1461e-07     	|  2500           	|  0.0015365      	|  0.0021051      	|
|  [LightningModule]ImageClassifierModule.on_before_zero_grad                                                                                                            	|  6.1227e-07     	|  2500           	|  0.0015307      	|  0.0020971      	|
|  [Callback]HydraOptCallback.on_before_zero_grad                                                                                                                        	|  6.0186e-07     	|  2500           	|  0.0015047      	|  0.0020614      	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                           	|  5.9608e-07     	|  2500           	|  0.0014902      	|  0.0020416      	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                       	|  5.9017e-07     	|  2500           	|  0.0014754      	|  0.0020213      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_after_backward        	|  5.7884e-07     	|  2500           	|  0.0014471      	|  0.0019825      	|
|  [Callback]PredictionLogger.on_after_backward                                                                                                                          	|  5.6338e-07     	|  2500           	|  0.0014084      	|  0.0019296      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_optimizer_step 	|  5.467e-07      	|  2500           	|  0.0013667      	|  0.0018725      	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                         	|  5.456e-07      	|  2500           	|  0.001364       	|  0.0018687      	|
|  [Callback]PredictionLogger.on_train_batch_start                                                                                                                       	|  5.4502e-07     	|  2500           	|  0.0013626      	|  0.0018667      	|
|  [Callback]ModelSummary.on_train_batch_start                                                                                                                           	|  5.4377e-07     	|  2500           	|  0.0013594      	|  0.0018624      	|
|  [Callback]HydraOptCallback.on_before_backward                                                                                                                         	|  5.2966e-07     	|  2500           	|  0.0013242      	|  0.0018141      	|
|  [Callback]PredictionLogger.on_before_optimizer_step                                                                                                                   	|  5.1431e-07     	|  2500           	|  0.0012858      	|  0.0017615      	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                          	|  5.1312e-07     	|  2500           	|  0.0012828      	|  0.0017575      	|
|  [Callback]HydraOptCallback.on_after_backward                                                                                                                          	|  5.1155e-07     	|  2500           	|  0.0012789      	|  0.0017521      	|
|  [LightningModule]ImageClassifierModule.on_after_backward                                                                                                              	|  5.1024e-07     	|  2500           	|  0.0012756      	|  0.0017476      	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                            	|  5.0288e-07     	|  2500           	|  0.0012572      	|  0.0017224      	|
|  [LightningModule]ImageClassifierModule.on_before_backward                                                                                                             	|  4.9546e-07     	|  2500           	|  0.0012387      	|  0.001697       	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                              	|  4.9473e-07     	|  2500           	|  0.0012368      	|  0.0016945      	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                    	|  4.9214e-07     	|  2500           	|  0.0012303      	|  0.0016856      	|
|  [Callback]TQDMProgressBar.on_test_batch_end                                                                                                                           	|  0.00012235     	|  10             	|  0.0012235      	|  0.0016763      	|
|  [LightningModule]ImageClassifierModule.on_train_batch_start                                                                                                           	|  4.7515e-07     	|  2500           	|  0.0011879      	|  0.0016274      	|
|  [LightningModule]ImageClassifierModule.on_before_optimizer_step                                                                                                       	|  4.5229e-07     	|  2500           	|  0.0011307      	|  0.0015491      	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                   	|  4.1718e-07     	|  2500           	|  0.0010429      	|  0.0014289      	|
|  [Callback]LearningRateMonitor.on_validation_batch_end                                                                                                                 	|  1.4883e-06     	|  512            	|  0.00076199     	|  0.0010439      	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_end                                                                                                        	|  1.308e-05      	|  52             	|  0.00068017     	|  0.00093185     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end        	|  1.3049e-05     	|  52             	|  0.00067853     	|  0.0009296      	|
|  [Callback]PredictionLogger.on_validation_batch_end                                                                                                                    	|  1.3064e-06     	|  512            	|  0.00066887     	|  0.00091637     	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                        	|  1.1653e-06     	|  512            	|  0.00059662     	|  0.00081738     	|
|  [Callback]LearningRateMonitor.on_validation_batch_start                                                                                                               	|  1.1432e-06     	|  512            	|  0.00058533     	|  0.00080192     	|
|  [Callback]MacSummaryCallback.on_validation_batch_end                                                                                                                  	|  8.8141e-07     	|  512            	|  0.00045128     	|  0.00061827     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end  	|  8.4773e-07     	|  512            	|  0.00043404     	|  0.00059464     	|
|  [Callback]HydraOptCallback.on_validation_batch_end                                                                                                                    	|  7.4099e-07     	|  512            	|  0.00037939     	|  0.00051977     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start	|  6.6759e-07     	|  512            	|  0.00034181     	|  0.00046828     	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                      	|  6.5067e-07     	|  512            	|  0.00033314     	|  0.00045641     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                    	|  0.00011021     	|  3              	|  0.00033064     	|  0.00045298     	|
|  [Callback]HydraOptCallback.on_validation_batch_start                                                                                                                  	|  6.3968e-07     	|  512            	|  0.00032752     	|  0.0004487      	|
|  [Callback]MacSummaryCallback.on_validation_batch_start                                                                                                                	|  6.3828e-07     	|  512            	|  0.0003268      	|  0.00044772     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_end                                                                                                        	|  6.3176e-07     	|  512            	|  0.00032346     	|  0.00044315     	|
|  [Callback]TQDMProgressBar.on_test_batch_start                                                                                                                         	|  3.0755e-05     	|  10             	|  0.00030755     	|  0.00042135     	|
|  [Callback]PredictionLogger.on_validation_batch_start                                                                                                                  	|  5.5753e-07     	|  512            	|  0.00028546     	|  0.00039108     	|
|  [Callback]TQDMProgressBar.on_test_start                                                                                                                               	|  0.00028193     	|  1              	|  0.00028193     	|  0.00038625     	|
|  [LightningModule]ImageClassifierModule.on_test_model_eval                                                                                                             	|  0.00026097     	|  1              	|  0.00026097     	|  0.00035754     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_start                                                                                                      	|  4.9416e-07     	|  512            	|  0.00025301     	|  0.00034663     	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                	|  0.00021488     	|  1              	|  0.00021488     	|  0.00029439     	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                              	|  0.00017798     	|  1              	|  0.00017798     	|  0.00024383     	|
|  [Callback]HydraOptCallback.on_test_end                                                                                                                                	|  0.00015798     	|  1              	|  0.00015798     	|  0.00021643     	|
|  [LightningModule]ImageClassifierModule.on_save_checkpoint                                                                                                             	|  2.5152e-06     	|  61             	|  0.00015343     	|  0.0002102      	|
|  [Callback]TQDMProgressBar.on_test_end                                                                                                                                 	|  0.00013761     	|  1              	|  0.00013761     	|  0.00018852     	|
|  [Callback]LearningRateMonitor.on_save_checkpoint                                                                                                                      	|  1.7839e-06     	|  61             	|  0.00010882     	|  0.00014908     	|
|  [Callback]PredictionLogger.on_validation_epoch_end                                                                                                                    	|  1.7522e-06     	|  52             	|  9.1116e-05     	|  0.00012483     	|
|  [Callback]HydraOptCallback.on_validation_epoch_end                                                                                                                    	|  1.7227e-06     	|  52             	|  8.9582e-05     	|  0.00012273     	|
|  [Callback]MacSummaryCallback.on_train_epoch_start                                                                                                                     	|  1.6487e-06     	|  50             	|  8.2435e-05     	|  0.00011294     	|
|  [Callback]LearningRateMonitor.on_validation_end                                                                                                                       	|  1.5225e-06     	|  52             	|  7.9171e-05     	|  0.00010847     	|
|  [Callback]LearningRateMonitor.on_validation_epoch_end                                                                                                                 	|  1.3805e-06     	|  52             	|  7.1788e-05     	|  9.8352e-05     	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                              	|  1.369e-06      	|  52             	|  7.1187e-05     	|  9.7528e-05     	|
|  [Callback]LearningRateMonitor.on_validation_start                                                                                                                     	|  1.3227e-06     	|  52             	|  6.878e-05      	|  9.423e-05      	|
|  [Callback]LearningRateMonitor.on_train_epoch_end                                                                                                                      	|  1.2748e-06     	|  50             	|  6.3738e-05     	|  8.7322e-05     	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                            	|  1.1955e-06     	|  52             	|  6.2168e-05     	|  8.5171e-05     	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                             	|  1.1423e-06     	|  50             	|  5.7116e-05     	|  7.8251e-05     	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                           	|  1.0936e-06     	|  50             	|  5.4678e-05     	|  7.491e-05      	|
|  [Callback]LearningRateMonitor.on_validation_epoch_start                                                                                                               	|  9.5719e-07     	|  52             	|  4.9774e-05     	|  6.8191e-05     	|
|  [Callback]MacSummaryCallback.on_save_checkpoint                                                                                                                       	|  7.491e-07      	|  61             	|  4.5695e-05     	|  6.2603e-05     	|
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                             	|  7.279e-07      	|  61             	|  4.4402e-05     	|  6.0831e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                      	|  8.4664e-07     	|  52             	|  4.4025e-05     	|  6.0315e-05     	|
|  [Callback]PredictionLogger.on_validation_end                                                                                                                          	|  8.0359e-07     	|  52             	|  4.1787e-05     	|  5.7249e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_end                                                                                                              	|  7.7531e-07     	|  52             	|  4.0316e-05     	|  5.5234e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_start                                                                                                            	|  7.5579e-07     	|  52             	|  3.9301e-05     	|  5.3843e-05     	|
|  [Callback]MacSummaryCallback.on_validation_end                                                                                                                        	|  7.5468e-07     	|  52             	|  3.9244e-05     	|  5.3765e-05     	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_start                                                                                                           	|  7.8481e-07     	|  50             	|  3.924e-05      	|  5.376e-05      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_start     	|  7.7597e-07     	|  50             	|  3.8798e-05     	|  5.3155e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                    	|  7.2899e-07     	|  52             	|  3.7908e-05     	|  5.1934e-05     	|
|  [Callback]HydraOptCallback.on_train_epoch_start                                                                                                                       	|  7.452e-07      	|  50             	|  3.726e-05      	|  5.1047e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                   	|  7.08e-07       	|  52             	|  3.6816e-05     	|  5.0439e-05     	|
|  [Callback]HydraOptCallback.on_save_checkpoint                                                                                                                         	|  5.9977e-07     	|  61             	|  3.6586e-05     	|  5.0124e-05     	|
|  [Callback]MacSummaryCallback.on_validation_start                                                                                                                      	|  7e-07          	|  52             	|  3.64e-05       	|  4.9868e-05     	|
|  [Callback]PredictionLogger.on_save_checkpoint                                                                                                                         	|  5.8119e-07     	|  61             	|  3.5453e-05     	|  4.8571e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start      	|  6.7341e-07     	|  52             	|  3.5017e-05     	|  4.7975e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_save_checkpoint       	|  5.7282e-07     	|  61             	|  3.4942e-05     	|  4.7871e-05     	|
|  [Callback]PredictionLogger.on_train_epoch_start                                                                                                                       	|  6.8369e-07     	|  50             	|  3.4184e-05     	|  4.6833e-05     	|
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                          	|  5.4743e-07     	|  61             	|  3.3393e-05     	|  4.5749e-05     	|
|  [Callback]PredictionLogger.on_validation_start                                                                                                                        	|  6.2404e-07     	|  52             	|  3.245e-05      	|  4.4458e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                     	|  6.1017e-07     	|  52             	|  3.1729e-05     	|  4.3469e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                        	|  6.0805e-07     	|  52             	|  3.1618e-05     	|  4.3318e-05     	|
|  [Callback]HydraOptCallback.on_validation_start                                                                                                                        	|  6.0689e-07     	|  52             	|  3.1558e-05     	|  4.3235e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_start                                                                                                      	|  5.9356e-07     	|  52             	|  3.0865e-05     	|  4.2286e-05     	|
|  [Callback]PredictionLogger.on_train_epoch_end                                                                                                                         	|  6.1429e-07     	|  50             	|  3.0715e-05     	|  4.208e-05      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end  	|  5.8273e-07     	|  52             	|  3.0302e-05     	|  4.1514e-05     	|
|  [Callback]MacSummaryCallback.on_train_epoch_end                                                                                                                       	|  6.0238e-07     	|  50             	|  3.0119e-05     	|  4.1264e-05     	|
|  [Callback]LearningRateMonitor.on_train_start                                                                                                                          	|  2.9464e-05     	|  1              	|  2.9464e-05     	|  4.0366e-05     	|
|  [Callback]MacSummaryCallback.on_validation_epoch_start                                                                                                                	|  5.6409e-07     	|  52             	|  2.9333e-05     	|  4.0186e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start	|  5.607e-07      	|  52             	|  2.9156e-05     	|  3.9945e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                      	|  5.2663e-07     	|  52             	|  2.7385e-05     	|  3.7518e-05     	|
|  [Callback]PredictionLogger.on_validation_epoch_start                                                                                                                  	|  5.2199e-07     	|  52             	|  2.7143e-05     	|  3.7187e-05     	|
|  [Callback]HydraOptCallback.on_validation_epoch_start                                                                                                                  	|  5.1805e-07     	|  52             	|  2.6939e-05     	|  3.6907e-05     	|
|  [Callback]HydraOptCallback.on_train_epoch_end                                                                                                                         	|  5.2743e-07     	|  50             	|  2.6371e-05     	|  3.6129e-05     	|
|  [Callback]PredictionLogger.on_test_batch_end                                                                                                                          	|  1.976e-06      	|  10             	|  1.976e-05      	|  2.7071e-05     	|
|  [Callback]LearningRateMonitor.on_test_batch_end                                                                                                                       	|  1.5292e-06     	|  10             	|  1.5292e-05     	|  2.095e-05      	|
|  [Callback]LearningRateMonitor.on_test_batch_start                                                                                                                     	|  1.3871e-06     	|  10             	|  1.3871e-05     	|  1.9003e-05     	|
|  [Callback]ModelSummary.on_test_batch_end                                                                                                                              	|  1.0796e-06     	|  10             	|  1.0796e-05     	|  1.479e-05      	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                       	|  3.4886e-06     	|  3              	|  1.0466e-05     	|  1.4338e-05     	|
|  [Callback]MacSummaryCallback.on_test_batch_end                                                                                                                        	|  9.6431e-07     	|  10             	|  9.6431e-06     	|  1.3211e-05     	|
|  [Callback]PredictionLogger.setup                                                                                                                                      	|  2.584e-06      	|  3              	|  7.7521e-06     	|  1.0621e-05     	|
|  [Callback]LearningRateMonitor.setup                                                                                                                                   	|  2.5138e-06     	|  3              	|  7.5414e-06     	|  1.0332e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_test_batch_end        	|  7.2822e-07     	|  10             	|  7.2822e-06     	|  9.9768e-06     	|
|  [Callback]HydraOptCallback.on_test_batch_end                                                                                                                          	|  7.0899e-07     	|  10             	|  7.0899e-06     	|  9.7133e-06     	|
|  [Callback]ModelSummary.on_test_batch_start                                                                                                                            	|  6.6776e-07     	|  10             	|  6.6776e-06     	|  9.1484e-06     	|
|  [LightningModule]ImageClassifierModule.on_test_batch_end                                                                                                              	|  6.33e-07       	|  10             	|  6.33e-06       	|  8.6722e-06     	|
|  [Callback]MacSummaryCallback.on_test_batch_start                                                                                                                      	|  6.139e-07      	|  10             	|  6.139e-06      	|  8.4106e-06     	|
|  [LightningModule]ImageClassifierModule.on_test_batch_start                                                                                                            	|  5.8366e-07     	|  10             	|  5.8366e-06     	|  7.9963e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_test_batch_start      	|  5.6596e-07     	|  10             	|  5.6596e-06     	|  7.7538e-06     	|
|  [Callback]LearningRateMonitor.teardown                                                                                                                                	|  1.8226e-06     	|  3              	|  5.4678e-06     	|  7.491e-06      	|
|  [Callback]HydraOptCallback.on_test_batch_start                                                                                                                        	|  5.1868e-07     	|  10             	|  5.1868e-06     	|  7.106e-06      	|
|  [LightningModule]ImageClassifierModule.configure_callbacks                                                                                                            	|  1.7089e-06     	|  3              	|  5.1267e-06     	|  7.0237e-06     	|
|  [Callback]PredictionLogger.on_test_batch_start                                                                                                                        	|  4.9481e-07     	|  10             	|  4.9481e-06     	|  6.779e-06      	|
|  [Callback]MacSummaryCallback.setup                                                                                                                                    	|  1.2183e-06     	|  3              	|  3.655e-06      	|  5.0074e-06     	|
|  [Callback]LearningRateMonitor.on_sanity_check_start                                                                                                                   	|  3.2452e-06     	|  1              	|  3.2452e-06     	|  4.446e-06      	|
|  [Callback]MacSummaryCallback.teardown                                                                                                                                 	|  1.0346e-06     	|  3              	|  3.1039e-06     	|  4.2524e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start             	|  2.9041e-06     	|  1              	|  2.9041e-06     	|  3.9787e-06     	|
|  [LightningModule]ImageClassifierModule.teardown                                                                                                                       	|  9.352e-07      	|  3              	|  2.8056e-06     	|  3.8437e-06     	|
|  [Callback]ModelSummary.setup                                                                                                                                          	|  8.9159e-07     	|  3              	|  2.6748e-06     	|  3.6645e-06     	|
|  [LightningModule]ImageClassifierModule.on_fit_start                                                                                                                   	|  2.5542e-06     	|  1              	|  2.5542e-06     	|  3.4992e-06     	|
|  [Callback]HydraOptCallback.setup                                                                                                                                      	|  7.9791e-07     	|  3              	|  2.3937e-06     	|  3.2795e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_start                                                                                                                 	|  2.3339e-06     	|  1              	|  2.3339e-06     	|  3.1975e-06     	|
|  [Callback]HydraOptCallback.on_train_start                                                                                                                             	|  2.3029e-06     	|  1              	|  2.3029e-06     	|  3.1551e-06     	|
|  [Callback]LearningRateMonitor.on_train_end                                                                                                                            	|  2.2431e-06     	|  1              	|  2.2431e-06     	|  3.0731e-06     	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                         	|  2.204e-06      	|  1              	|  2.204e-06      	|  3.0195e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                 	|  7.1766e-07     	|  3              	|  2.153e-06      	|  2.9496e-06     	|
|  [Callback]PredictionLogger.teardown                                                                                                                                   	|  6.9772e-07     	|  3              	|  2.0931e-06     	|  2.8677e-06     	|
|  [Callback]PredictionLogger.on_test_epoch_end                                                                                                                          	|  1.973e-06      	|  1              	|  1.973e-06      	|  2.7031e-06     	|
|  [Callback]HydraOptCallback.teardown                                                                                                                                   	|  6.5433e-07     	|  3              	|  1.963e-06      	|  2.6893e-06     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                    	|  6.5099e-07     	|  3              	|  1.953e-06      	|  2.6756e-06     	|
|  [Callback]ModelSummary.teardown                                                                                                                                       	|  6.3765e-07     	|  3              	|  1.9129e-06     	|  2.6208e-06     	|
|  [Callback]LearningRateMonitor.on_fit_end                                                                                                                              	|  1.803e-06      	|  1              	|  1.803e-06      	|  2.4702e-06     	|
|  [Callback]LearningRateMonitor.on_fit_start                                                                                                                            	|  1.8028e-06     	|  1              	|  1.8028e-06     	|  2.4699e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_start           	|  1.733e-06      	|  1              	|  1.733e-06      	|  2.3742e-06     	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                          	|  1.6622e-06     	|  1              	|  1.6622e-06     	|  2.2772e-06     	|
|  [Callback]LearningRateMonitor.on_test_epoch_end                                                                                                                       	|  1.5621e-06     	|  1              	|  1.5621e-06     	|  2.1401e-06     	|
|  [Callback]PredictionLogger.on_test_end                                                                                                                                	|  1.5418e-06     	|  1              	|  1.5418e-06     	|  2.1123e-06     	|
|  [Callback]LearningRateMonitor.on_test_end                                                                                                                             	|  1.4121e-06     	|  1              	|  1.4121e-06     	|  1.9346e-06     	|
|  [Callback]LearningRateMonitor.on_test_start                                                                                                                           	|  1.322e-06      	|  1              	|  1.322e-06      	|  1.8112e-06     	|
|  [Callback]LearningRateMonitor.on_sanity_check_end                                                                                                                     	|  1.302e-06      	|  1              	|  1.302e-06      	|  1.7838e-06     	|
|  [Callback]ModelSummary.on_test_start                                                                                                                                  	|  1.2519e-06     	|  1              	|  1.2519e-06     	|  1.7152e-06     	|
|  [Callback]MacSummaryCallback.on_train_end                                                                                                                             	|  1.2219e-06     	|  1              	|  1.2219e-06     	|  1.674e-06      	|
|  [Strategy]SingleDeviceStrategy.on_test_end                                                                                                                            	|  1.1919e-06     	|  1              	|  1.1919e-06     	|  1.6329e-06     	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                 	|  1.1618e-06     	|  1              	|  1.1618e-06     	|  1.5917e-06     	|
|  [Callback]ModelSummary.on_test_end                                                                                                                                    	|  1.082e-06      	|  1              	|  1.082e-06      	|  1.4823e-06     	|
|  [Callback]HydraOptCallback.on_test_start                                                                                                                              	|  9.8092e-07     	|  1              	|  9.8092e-07     	|  1.3439e-06     	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                   	|  9.7207e-07     	|  1              	|  9.7207e-07     	|  1.3318e-06     	|
|  [Callback]HydraOptCallback.on_fit_end                                                                                                                                 	|  9.7207e-07     	|  1              	|  9.7207e-07     	|  1.3318e-06     	|
|  [Callback]MacSummaryCallback.on_fit_start                                                                                                                             	|  9.0105e-07     	|  1              	|  9.0105e-07     	|  1.2345e-06     	|
|  [Callback]MacSummaryCallback.on_sanity_check_start                                                                                                                    	|  9.0105e-07     	|  1              	|  9.0105e-07     	|  1.2345e-06     	|
|  [Callback]HydraOptCallback.on_train_end                                                                                                                               	|  8.7195e-07     	|  1              	|  8.7195e-07     	|  1.1946e-06     	|
|  [Callback]PredictionLogger.on_sanity_check_start                                                                                                                      	|  8.6194e-07     	|  1              	|  8.6194e-07     	|  1.1809e-06     	|
|  [Callback]MacSummaryCallback.on_fit_end                                                                                                                               	|  8.4098e-07     	|  1              	|  8.4098e-07     	|  1.1522e-06     	|
|  [Callback]MacSummaryCallback.on_test_start                                                                                                                            	|  8.4098e-07     	|  1              	|  8.4098e-07     	|  1.1522e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_end                                                                                                                   	|  8.3097e-07     	|  1              	|  8.3097e-07     	|  1.1384e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_test_end              	|  8.2189e-07     	|  1              	|  8.2189e-07     	|  1.126e-06      	|
|  [LightningModule]ImageClassifierModule.on_test_start                                                                                                                  	|  8.2096e-07     	|  1              	|  8.2096e-07     	|  1.1247e-06     	|
|  [Strategy]SingleDeviceStrategy.on_test_start                                                                                                                          	|  8.1211e-07     	|  1              	|  8.1211e-07     	|  1.1126e-06     	|
|  [Callback]MacSummaryCallback.on_sanity_check_end                                                                                                                      	|  8.0094e-07     	|  1              	|  8.0094e-07     	|  1.0973e-06     	|
|  [LightningModule]ImageClassifierModule.on_test_epoch_end                                                                                                              	|  7.9116e-07     	|  1              	|  7.9116e-07     	|  1.0839e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_start    	|  7.9093e-07     	|  1              	|  7.9093e-07     	|  1.0836e-06     	|
|  [Callback]LearningRateMonitor.on_test_epoch_start                                                                                                                     	|  7.9093e-07     	|  1              	|  7.9093e-07     	|  1.0836e-06     	|
|  [LightningModule]ImageClassifierModule.on_fit_end                                                                                                                     	|  7.7114e-07     	|  1              	|  7.7114e-07     	|  1.0565e-06     	|
|  [Callback]PredictionLogger.on_train_end                                                                                                                               	|  7.6112e-07     	|  1              	|  7.6112e-07     	|  1.0428e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_end             	|  7.4087e-07     	|  1              	|  7.4087e-07     	|  1.015e-06      	|
|  [Callback]MacSummaryCallback.on_test_epoch_end                                                                                                                        	|  7.2084e-07     	|  1              	|  7.2084e-07     	|  9.8757e-07     	|
|  [Callback]PredictionLogger.on_fit_end                                                                                                                                 	|  6.7102e-07     	|  1              	|  6.7102e-07     	|  9.1931e-07     	|
|  [Callback]HydraOptCallback.on_fit_start                                                                                                                               	|  6.6101e-07     	|  1              	|  6.6101e-07     	|  9.0559e-07     	|
|  [Callback]PredictionLogger.on_train_start                                                                                                                             	|  6.6101e-07     	|  1              	|  6.6101e-07     	|  9.0559e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                         	|  6.6101e-07     	|  1              	|  6.6101e-07     	|  9.0559e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_test_start            	|  6.6101e-07     	|  1              	|  6.6101e-07     	|  9.0559e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                           	|  6.6007e-07     	|  1              	|  6.6007e-07     	|  9.0432e-07     	|
|  [Callback]PredictionLogger.on_fit_start                                                                                                                               	|  6.5099e-07     	|  1              	|  6.5099e-07     	|  8.9188e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_end      	|  6.4098e-07     	|  1              	|  6.4098e-07     	|  8.7816e-07     	|
|  [Callback]HydraOptCallback.on_sanity_check_end                                                                                                                        	|  6.3097e-07     	|  1              	|  6.3097e-07     	|  8.6444e-07     	|
|  [Callback]TQDMProgressBar.on_test_epoch_end                                                                                                                           	|  6.3097e-07     	|  1              	|  6.3097e-07     	|  8.6444e-07     	|
|  [Callback]PredictionLogger.on_sanity_check_end                                                                                                                        	|  6.2096e-07     	|  1              	|  6.2096e-07     	|  8.5073e-07     	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                  	|  6e-07          	|  1              	|  6e-07          	|  8.2202e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end               	|  5.9092e-07     	|  1              	|  5.9092e-07     	|  8.0958e-07     	|
|  [Callback]HydraOptCallback.on_test_epoch_end                                                                                                                          	|  5.9092e-07     	|  1              	|  5.9092e-07     	|  8.0958e-07     	|
|  [Callback]PredictionLogger.on_test_start                                                                                                                              	|  5.8115e-07     	|  1              	|  5.8115e-07     	|  7.9618e-07     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                     	|  5.8091e-07     	|  1              	|  5.8091e-07     	|  7.9586e-07     	|
|  [Callback]HydraOptCallback.on_sanity_check_start                                                                                                                      	|  5.7113e-07     	|  1              	|  5.7113e-07     	|  7.8246e-07     	|
|  [Callback]PredictionLogger.on_test_epoch_start                                                                                                                        	|  5.709e-07      	|  1              	|  5.709e-07      	|  7.8215e-07     	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                            	|  5.5111e-07     	|  1              	|  5.5111e-07     	|  7.5503e-07     	|
|  [Callback]HydraOptCallback.on_test_epoch_start                                                                                                                        	|  5.5088e-07     	|  1              	|  5.5088e-07     	|  7.5471e-07     	|
|  [Callback]MacSummaryCallback.on_test_epoch_start                                                                                                                      	|  5.5018e-07     	|  1              	|  5.5018e-07     	|  7.5376e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_test_epoch_end        	|  5.4087e-07     	|  1              	|  5.4087e-07     	|  7.41e-07       	|
|  [Callback]TQDMProgressBar.on_test_epoch_start                                                                                                                         	|  5.2084e-07     	|  1              	|  5.2084e-07     	|  7.1356e-07     	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                	|  5.1991e-07     	|  1              	|  5.1991e-07     	|  7.1229e-07     	|
|  [Callback]ModelSummary.on_test_epoch_start                                                                                                                            	|  5.0105e-07     	|  1              	|  5.0105e-07     	|  6.8645e-07     	|
|  [LightningModule]ImageClassifierModule.on_test_epoch_start                                                                                                            	|  4.8988e-07     	|  1              	|  4.8988e-07     	|  6.7114e-07     	|
|  [Callback]ModelSummary.on_test_epoch_end                                                                                                                              	|  4.7102e-07     	|  1              	|  4.7102e-07     	|  6.453e-07      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_test_epoch_start      	|  4.6007e-07     	|  1              	|  4.6007e-07     	|  6.3031e-07     	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[2024-05-16 18:45:51,893][hannah.train][INFO] - Averaged Result Metrics:
| Metric               |     Mean |   Std |   Count |
|----------------------|----------|-------|---------|
| test_classifier_loss | 0.393521 |     0 |       1 |
| test_accuracy        | 0.8785   |     0 |       1 |
| test_error           | 0.1215   |     0 |       1 |
| test_f1              | 0.878351 |     0 |       1 |
| test_precision       | 0.879509 |     0 |       1 |
| test_recall          | 0.8785   |     0 |       1 |
| test_loss            | 0.393521 |     0 |       1 |
[2024-05-16 18:45:51,904][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 0.393521 |     0 |       1 |
| val_accuracy        | 0.8785   |     0 |       1 |
| val_error           | 0.1215   |     0 |       1 |
| val_f1              | 0.878351 |     0 |       1 |
| val_precision       | 0.879509 |     0 |       1 |
| val_recall          | 0.8785   |     0 |       1 |
| val_loss            | 0.393521 |     0 |       1 |
[2024-05-16 18:46:28,272][hannah.utils.utils][INFO] - Environment info:
[2024-05-16 18:46:28,371][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-16 18:46:28,372][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-16 18:46:28,375][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-16 18:46:28,375][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-16 18:46:28,375][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-16 18:46:28,375][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-16 18:46:28,375][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-16 18:46:28,375][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-16 18:46:28,375][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-16 18:46:28,377][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-16 18:46:28,377][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset=cifar10 model=kakao_resnet8 trainer.devices=[1] module.batch_size=1000 profiler=simple
[2024-05-16 18:46:28,377][hannah.utils.utils][INFO] -   
[2024-05-16 18:46:28,378][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:46:28,386][root][INFO] - Configuration: 
[2024-05-16 18:46:28,389][root][INFO] - dataset:
  data_folder: ${hydra:runtime.cwd}/datasets/
  cls: hannah.datasets.vision.Cifar10Dataset
  dataset: cifar10
  val_percent: 0.1
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.kakao_resnet.resnet8
  name: kakao_resnet8
  width_multiplier: 1.0
  input_kernel: 3
  input_stride: 1
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: ${optimizer.lr}
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.sgd.SGD
  lr: 0.3
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0005
  nesterov: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 1000
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices:
  - 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 50
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 16
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
profiler:
  _target_: pytorch_lightning.profilers.SimpleProfiler
augmentation:
  batch_augment:
    pipeline: null
    transforms:
      RandomHorizontalFlip:
        p: 0.5
      RandomAffine:
        degrees:
        - -15
        - 15
        translate:
        - 0.1
        - 0.1
        scale:
        - 0.9
        - 1.1
        shear:
        - -5
        - 5
        p: 0.5
      RandomCrop:
        size:
        - 32
        - 32
        padding: 4
      RandomErasing:
        p: 0.5
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false
monitor:
  metric: val_accuracy
  direction: maximize

[2024-05-16 18:46:28,389][root][INFO] - Current working directory /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8
[2024-05-16 18:46:28,904][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-16 18:46:28,905][hannah.callbacks.optimization][INFO] -   - val_accuracy direction: maximize(-1)
[2024-05-16 18:46:28,962][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/lightning_fabric/connector.py:563: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!

[2024-05-16 18:46:28,986][pytorch_lightning.utilities.rank_zero][INFO] - Using 16bit Automatic Mixed Precision (AMP)
[2024-05-16 18:46:28,993][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-16 18:46:28,993][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-16 18:46:28,993][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-16 18:46:28,993][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-16 18:46:28,993][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-16 18:46:28,993][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:46:28,993][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-16 18:46:28,994][root][INFO] - Starting training
[2024-05-16 18:46:34,468][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-16 18:46:34,468][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-16 18:46:34,469][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 45000
[2024-05-16 18:46:34,469][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-16 18:46:34,469][hannah.modules.vision.base][INFO] -   Dev Set: 5000
[2024-05-16 18:46:34,469][hannah.modules.vision.base][INFO] -   Test Set: 10000
[2024-05-16 18:46:34,469][hannah.modules.vision.base][INFO] - Setting up model kakao_resnet8
[2024-05-16 18:46:34,481][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.491, 0.482, 0.446), std: (0.247, 0.243, 0.261)
[2024-05-16 18:46:34,487][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-16 18:46:34,497][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:46:34,506][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-16 18:46:34,507][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-16 18:46:34,513][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (45) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.

[2024-05-16 18:46:34,678][pytorch_lightning.callbacks.model_summary][INFO] - 
   | Name                 | Type                           | Params | In sizes       | Out sizes
------------------------------------------------------------------------------------------------------
0  | val_metrics          | MetricCollection               | 0      | ?              | ?        
1  | test_metrics         | MetricCollection               | 0      | ?              | ?        
2  | train_metrics        | MetricCollection               | 0      | ?              | ?        
3  | model                | Sequential                     | 2.3 M  | [1, 3, 32, 32] | [1, 10]  
4  | input_normalizer     | Normalize                      | 0      | ?              | ?        
5  | default_augmentation | Sequential                     | 0      | ?              | ?        
6  | augmentations        | ModuleDict                     | 0      | ?              | ?        
7  | test_confusion       | MulticlassConfusionMatrix      | 0      | ?              | ?        
8  | test_roc             | MulticlassROC                  | 0      | ?              | ?        
9  | test_pr_curve        | MulticlassPrecisionRecallCurve | 0      | ?              | ?        
10 | metrics              | ModuleDict                     | 0      | ?              | ?        
------------------------------------------------------------------------------------------------------
2.3 M     Trainable params
0         Non-trainable params
2.3 M     Total params
9.100     Total estimated model params size (MB)
[2024-05-16 18:46:34,931][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-16 18:46:35,253][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:46:35,254][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:46:35,254][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:46:35,254][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:46:35,254][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:46:35,384][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:46:38,427][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 45: 'val_error' reached 0.70720 (best 0.70720), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=0-step=45.ckpt' as top 1
[2024-05-16 18:46:38,532][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:46:41,571][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 90: 'val_error' reached 0.53100 (best 0.53100), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=1-step=90.ckpt' as top 1
[2024-05-16 18:46:41,688][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:46:44,740][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 135: 'val_error' was not in top 1
[2024-05-16 18:46:44,824][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:46:47,862][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 180: 'val_error' reached 0.50800 (best 0.50800), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=3-step=180.ckpt' as top 1
[2024-05-16 18:46:47,977][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:46:51,017][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 225: 'val_error' reached 0.43160 (best 0.43160), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=4-step=225.ckpt' as top 1
[2024-05-16 18:46:51,135][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:46:54,169][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 270: 'val_error' was not in top 1
[2024-05-16 18:46:54,253][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:46:57,480][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 315: 'val_error' was not in top 1
[2024-05-16 18:46:57,566][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:00,592][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 360: 'val_error' reached 0.32540 (best 0.32540), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=7-step=360.ckpt' as top 1
[2024-05-16 18:47:00,707][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:03,753][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 405: 'val_error' reached 0.31440 (best 0.31440), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=8-step=405.ckpt' as top 1
[2024-05-16 18:47:03,868][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:06,896][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 450: 'val_error' was not in top 1
[2024-05-16 18:47:06,981][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:09,998][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 495: 'val_error' reached 0.24020 (best 0.24020), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=10-step=495.ckpt' as top 1
[2024-05-16 18:47:10,115][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:13,153][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 540: 'val_error' was not in top 1
[2024-05-16 18:47:13,240][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:16,268][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 585: 'val_error' reached 0.22980 (best 0.22980), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=12-step=585.ckpt' as top 1
[2024-05-16 18:47:16,382][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:19,415][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 630: 'val_error' reached 0.18400 (best 0.18400), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=13-step=630.ckpt' as top 1
[2024-05-16 18:47:19,533][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:22,561][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 675: 'val_error' was not in top 1
[2024-05-16 18:47:22,648][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:25,876][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 720: 'val_error' reached 0.15760 (best 0.15760), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=15-step=720.ckpt' as top 1
[2024-05-16 18:47:25,988][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:29,017][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 765: 'val_error' reached 0.13520 (best 0.13520), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=16-step=765.ckpt' as top 1
[2024-05-16 18:47:29,133][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:32,170][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 810: 'val_error' was not in top 1
[2024-05-16 18:47:32,256][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:35,299][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 855: 'val_error' was not in top 1
[2024-05-16 18:47:35,394][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:38,449][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 900: 'val_error' was not in top 1
[2024-05-16 18:47:38,535][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:41,561][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 945: 'val_error' was not in top 1
[2024-05-16 18:47:41,648][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:44,683][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 990: 'val_error' was not in top 1
[2024-05-16 18:47:44,767][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:47,825][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 1035: 'val_error' was not in top 1
[2024-05-16 18:47:47,909][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:50,952][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 1080: 'val_error' was not in top 1
[2024-05-16 18:47:51,036][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:54,090][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 1125: 'val_error' was not in top 1
[2024-05-16 18:47:54,175][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:47:57,397][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 1170: 'val_error' was not in top 1
[2024-05-16 18:47:57,481][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:00,531][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 1215: 'val_error' was not in top 1
[2024-05-16 18:48:00,615][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:03,655][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 1260: 'val_error' was not in top 1
[2024-05-16 18:48:03,742][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:06,797][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 1305: 'val_error' was not in top 1
[2024-05-16 18:48:06,881][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:09,921][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 1350: 'val_error' was not in top 1
[2024-05-16 18:48:10,008][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:13,046][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 1395: 'val_error' was not in top 1
[2024-05-16 18:48:13,131][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:16,182][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 1440: 'val_error' was not in top 1
[2024-05-16 18:48:16,269][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:19,313][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 1485: 'val_error' was not in top 1
[2024-05-16 18:48:19,397][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:22,461][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 1530: 'val_error' was not in top 1
[2024-05-16 18:48:22,546][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:25,775][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 1575: 'val_error' was not in top 1
[2024-05-16 18:48:25,861][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:28,910][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 1620: 'val_error' was not in top 1
[2024-05-16 18:48:28,996][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:32,041][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 1665: 'val_error' was not in top 1
[2024-05-16 18:48:32,125][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:35,190][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 1710: 'val_error' was not in top 1
[2024-05-16 18:48:35,286][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:38,326][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 1755: 'val_error' was not in top 1
[2024-05-16 18:48:38,412][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:41,470][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 1800: 'val_error' was not in top 1
[2024-05-16 18:48:41,557][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:44,587][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 1845: 'val_error' was not in top 1
[2024-05-16 18:48:44,674][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:47,716][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 1890: 'val_error' reached 0.13440 (best 0.13440), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=41-step=1890.ckpt' as top 1
[2024-05-16 18:48:47,827][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:51,063][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 1935: 'val_error' reached 0.13400 (best 0.13400), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=42-step=1935.ckpt' as top 1
[2024-05-16 18:48:51,176][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:54,217][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 1980: 'val_error' reached 0.13180 (best 0.13180), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=43-step=1980.ckpt' as top 1
[2024-05-16 18:48:54,329][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:48:57,379][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 2025: 'val_error' was not in top 1
[2024-05-16 18:48:57,463][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:49:00,500][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 2070: 'val_error' was not in top 1
[2024-05-16 18:49:00,584][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:49:03,635][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 2115: 'val_error' was not in top 1
[2024-05-16 18:49:03,721][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:49:06,758][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 2160: 'val_error' was not in top 1
[2024-05-16 18:49:06,843][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:49:09,901][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 2205: 'val_error' reached 0.13140 (best 0.13140), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=48-step=2205.ckpt' as top 1
[2024-05-16 18:49:10,013][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/autograd/__init__.py:266: UserWarning: adaptive_max_pool2d_backward_cuda does not have a deterministic implementation, but you set 'torch.use_deterministic_algorithms(True, warn_only=True)'. You can file an issue at https://github.com/pytorch/pytorch/issues to help us prioritize adding deterministic support for this operation. (Triggered internally at ../aten/src/ATen/Context.cpp:79.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

[2024-05-16 18:49:13,054][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 2250: 'val_error' reached 0.13100 (best 0.13100), saving model to '/local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=49-step=2250.ckpt' as top 1
[2024-05-16 18:49:13,119][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer.fit` stopped: `max_epochs=50` reached.
[2024-05-16 18:49:13,154][pytorch_lightning.profilers.profiler][INFO] - FIT Profiler Report

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                 	|  -              	|  146082         	|  164.24         	|  100 %          	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                    	|  2.9897         	|  50             	|  149.48         	|  91.016         	|
|  [_TrainingEpochLoop].train_dataloader_next                                                                                                                            	|  0.035163       	|  2250           	|  79.117         	|  48.172         	|
|  run_training_batch                                                                                                                                                    	|  0.024454       	|  2250           	|  55.022         	|  33.502         	|
|  [LightningModule]ImageClassifierModule.optimizer_step                                                                                                                 	|  0.024376       	|  2250           	|  54.845         	|  33.394         	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                          	|  0.011087       	|  2250           	|  24.946         	|  15.189         	|
|  [_EvaluationLoop].val_next                                                                                                                                            	|  0.03569        	|  252            	|  8.994          	|  5.4762         	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_end                                                                                                             	|  0.12167        	|  50             	|  6.0833         	|  3.7039         	|
|  [LightningModule]ImageClassifierModule.prepare_data                                                                                                                   	|  4.4963         	|  1              	|  4.4963         	|  2.7377         	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                               	|  0.0019752      	|  2250           	|  4.4441         	|  2.7059         	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                        	|  0.010231       	|  252            	|  2.5783         	|  1.5698         	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_end       	|  0.044675       	|  50             	|  2.2337         	|  1.3601         	|
|  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                          	|  0.00034581     	|  2250           	|  0.77806        	|  0.47374        	|
|  [LightningModule]ImageClassifierModule.setup                                                                                                                          	|  0.66518        	|  1              	|  0.66518        	|  0.40501        	|
|  [LightningModule]ImageClassifierModule.optimizer_zero_grad                                                                                                            	|  0.00016428     	|  2250           	|  0.36962        	|  0.22505        	|
|  [Callback]HydraOptCallback.on_train_batch_end                                                                                                                         	|  0.00015766     	|  2250           	|  0.35474        	|  0.21599        	|
|  [Callback]MacSummaryCallback.on_validation_epoch_end                                                                                                                  	|  0.0063278      	|  51             	|  0.32272        	|  0.19649        	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                        	|  0.00011456     	|  2502           	|  0.28662        	|  0.17452        	|
|  [LightningModule]ImageClassifierModule.transfer_batch_to_device                                                                                                       	|  9.2479e-05     	|  2504           	|  0.23157        	|  0.14099        	|
|  [Callback]LearningRateMonitor.on_train_batch_start                                                                                                                    	|  7.9226e-05     	|  2250           	|  0.17826        	|  0.10854        	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                   	|  0.16338        	|  1              	|  0.16338        	|  0.099478       	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                     	|  0.00016744     	|  252            	|  0.042194       	|  0.025691       	|
|  [LightningModule]ImageClassifierModule.lr_scheduler_step                                                                                                              	|  1.7832e-05     	|  2250           	|  0.040123       	|  0.02443        	|
|  [LightningModule]ImageClassifierModule.configure_gradient_clipping                                                                                                    	|  1.6213e-05     	|  2250           	|  0.036479       	|  0.022211       	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_end       	|  1.1885e-05     	|  2250           	|  0.026742       	|  0.016283       	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                        	|  0.00027587     	|  50             	|  0.013793       	|  0.0083984      	|
|  [LightningModule]ImageClassifierModule.on_validation_model_zero_grad                                                                                                  	|  0.00026609     	|  50             	|  0.013305       	|  0.0081008      	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                   	|  4.9997e-05     	|  252            	|  0.012599       	|  0.0076714      	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                           	|  0.00024653     	|  51             	|  0.012573       	|  0.0076554      	|
|  [LightningModule]ImageClassifierModule.on_validation_model_eval                                                                                                       	|  0.00021334     	|  51             	|  0.010881       	|  0.0066249      	|
|  [LightningModule]ImageClassifierModule.configure_optimizers                                                                                                           	|  0.0099326      	|  1              	|  0.0099326      	|  0.0060477      	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                         	|  0.00016082     	|  51             	|  0.0082018      	|  0.0049939      	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                          	|  0.0001388      	|  50             	|  0.00694        	|  0.0042255      	|
|  [Callback]MacSummaryCallback.on_train_start                                                                                                                           	|  0.0062505      	|  1              	|  0.0062505      	|  0.0038058      	|
|  [Callback]HydraOptCallback.on_validation_end                                                                                                                          	|  0.00011927     	|  51             	|  0.0060826      	|  0.0037035      	|
|  [Callback]LearningRateMonitor.on_before_zero_grad                                                                                                                     	|  1.6118e-06     	|  2250           	|  0.0036264      	|  0.002208       	|
|  [Callback]ModelSummary.on_train_batch_end                                                                                                                             	|  1.4706e-06     	|  2250           	|  0.0033088      	|  0.0020146      	|
|  [Callback]LearningRateMonitor.on_train_batch_end                                                                                                                      	|  1.418e-06      	|  2250           	|  0.0031906      	|  0.0019426      	|
|  [Callback]LearningRateMonitor.on_before_backward                                                                                                                      	|  1.377e-06      	|  2250           	|  0.0030982      	|  0.0018864      	|
|  [Callback]LearningRateMonitor.on_after_backward                                                                                                                       	|  1.2651e-06     	|  2250           	|  0.0028465      	|  0.0017331      	|
|  [Callback]LearningRateMonitor.on_before_optimizer_step                                                                                                                	|  1.2643e-06     	|  2250           	|  0.0028447      	|  0.0017321      	|
|  [LightningModule]ImageClassifierModule.on_before_batch_transfer                                                                                                       	|  1.0942e-06     	|  2504           	|  0.0027398      	|  0.0016682      	|
|  [Callback]MacSummaryCallback.on_train_batch_start                                                                                                                     	|  1.1542e-06     	|  2250           	|  0.002597       	|  0.0015812      	|
|  [Callback]PredictionLogger.on_train_batch_end                                                                                                                         	|  1.0456e-06     	|  2250           	|  0.0023526      	|  0.0014324      	|
|  [Callback]MacSummaryCallback.on_before_zero_grad                                                                                                                      	|  9.4566e-07     	|  2250           	|  0.0021277      	|  0.0012955      	|
|  [Callback]LearningRateMonitor.on_train_epoch_start                                                                                                                    	|  3.8999e-05     	|  50             	|  0.0019499      	|  0.0011873      	|
|  [LightningModule]ImageClassifierModule.on_after_batch_transfer                                                                                                        	|  7.4156e-07     	|  2504           	|  0.0018569      	|  0.0011306      	|
|  [Callback]MacSummaryCallback.on_before_optimizer_step                                                                                                                 	|  8.2162e-07     	|  2250           	|  0.0018486      	|  0.0011256      	|
|  [LightningModule]ImageClassifierModule.on_train_batch_end                                                                                                             	|  7.7625e-07     	|  2250           	|  0.0017466      	|  0.0010634      	|
|  [Callback]MacSummaryCallback.on_train_batch_end                                                                                                                       	|  7.5074e-07     	|  2250           	|  0.0016892      	|  0.0010285      	|
|  [Callback]PredictionLogger.on_before_zero_grad                                                                                                                        	|  7.2797e-07     	|  2250           	|  0.0016379      	|  0.00099729     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_zero_grad      	|  7.1138e-07     	|  2250           	|  0.0016006      	|  0.00097456     	|
|  [LightningModule]ImageClassifierModule.on_before_zero_grad                                                                                                            	|  7.0341e-07     	|  2250           	|  0.0015827      	|  0.00096364     	|
|  [Callback]MacSummaryCallback.on_after_backward                                                                                                                        	|  7.0187e-07     	|  2250           	|  0.0015792      	|  0.00096154     	|
|  [Callback]HydraOptCallback.on_before_zero_grad                                                                                                                        	|  7.0155e-07     	|  2250           	|  0.0015785      	|  0.00096109     	|
|  [Callback]MacSummaryCallback.on_before_backward                                                                                                                       	|  6.8638e-07     	|  2250           	|  0.0015444      	|  0.00094031     	|
|  [LightningModule]ImageClassifierModule.on_train_batch_start                                                                                                           	|  6.7464e-07     	|  2250           	|  0.0015179      	|  0.00092424     	|
|  [Callback]HydraOptCallback.on_before_optimizer_step                                                                                                                   	|  6.5587e-07     	|  2250           	|  0.0014757      	|  0.00089852     	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                   	|  6.4976e-07     	|  2250           	|  0.001462       	|  0.00089015     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_start     	|  6.4826e-07     	|  2250           	|  0.0014586      	|  0.00088809     	|
|  [Callback]HydraOptCallback.on_train_batch_start                                                                                                                       	|  6.4582e-07     	|  2250           	|  0.0014531      	|  0.00088475     	|
|  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                        	|  6.4001e-07     	|  2250           	|  0.00144        	|  0.00087679     	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                             	|  6.2682e-07     	|  2250           	|  0.0014103      	|  0.00085872     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_backward       	|  6.2453e-07     	|  2250           	|  0.0014052      	|  0.00085559     	|
|  [Callback]PredictionLogger.on_before_backward                                                                                                                         	|  6.1283e-07     	|  2250           	|  0.0013789      	|  0.00083956     	|
|  [LightningModule]ImageClassifierModule.on_after_backward                                                                                                              	|  6.086e-07      	|  2250           	|  0.0013694      	|  0.00083377     	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                          	|  6.0192e-07     	|  2250           	|  0.0013543      	|  0.0008246      	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                         	|  6.0064e-07     	|  2250           	|  0.0013514      	|  0.00082285     	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                       	|  5.984e-07      	|  2250           	|  0.0013464      	|  0.00081979     	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                           	|  5.7383e-07     	|  2250           	|  0.0012911      	|  0.00078613     	|
|  [Callback]PredictionLogger.on_train_batch_start                                                                                                                       	|  5.7285e-07     	|  2250           	|  0.0012889      	|  0.00078478     	|
|  [Callback]PredictionLogger.on_after_backward                                                                                                                          	|  5.6986e-07     	|  2250           	|  0.0012822      	|  0.00078069     	|
|  [LightningModule]ImageClassifierModule.on_before_backward                                                                                                             	|  5.6911e-07     	|  2250           	|  0.0012805      	|  0.00077966     	|
|  [Callback]HydraOptCallback.on_before_backward                                                                                                                         	|  5.6275e-07     	|  2250           	|  0.0012662      	|  0.00077095     	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                    	|  5.5437e-07     	|  2250           	|  0.0012473      	|  0.00075946     	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                            	|  5.5415e-07     	|  2250           	|  0.0012468      	|  0.00075917     	|
|  [Callback]PredictionLogger.on_before_optimizer_step                                                                                                                   	|  5.5329e-07     	|  2250           	|  0.0012449      	|  0.00075799     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_optimizer_step 	|  5.4089e-07     	|  2250           	|  0.001217       	|  0.00074099     	|
|  [Callback]ModelSummary.on_train_batch_start                                                                                                                           	|  5.3943e-07     	|  2250           	|  0.0012137      	|  0.00073899     	|
|  [LightningModule]ImageClassifierModule.on_before_optimizer_step                                                                                                       	|  5.3531e-07     	|  2250           	|  0.0012045      	|  0.00073336     	|
|  [Callback]HydraOptCallback.on_after_backward                                                                                                                          	|  5.3318e-07     	|  2250           	|  0.0011997      	|  0.00073044     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_after_backward        	|  5.1873e-07     	|  2250           	|  0.0011671      	|  0.00071064     	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                              	|  4.7257e-07     	|  2250           	|  0.0010633      	|  0.0006474      	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_end                                                                                                        	|  1.3231e-05     	|  51             	|  0.00067478     	|  0.00041086     	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                       	|  0.0006505      	|  1              	|  0.0006505      	|  0.00039607     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end        	|  1.2736e-05     	|  51             	|  0.00064954     	|  0.00039549     	|
|  [Callback]PredictionLogger.on_validation_batch_end                                                                                                                    	|  1.7777e-06     	|  252            	|  0.00044799     	|  0.00027277     	|
|  [Callback]LearningRateMonitor.on_validation_batch_end                                                                                                                 	|  1.5817e-06     	|  252            	|  0.0003986      	|  0.0002427      	|
|  [Callback]LearningRateMonitor.on_validation_batch_start                                                                                                               	|  1.3631e-06     	|  252            	|  0.00034351     	|  0.00020915     	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                        	|  1.1515e-06     	|  252            	|  0.00029017     	|  0.00017668     	|
|  [LightningModule]ImageClassifierModule.train_dataloader                                                                                                               	|  0.00025343     	|  1              	|  0.00025343     	|  0.00015431     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                    	|  0.00023219     	|  1              	|  0.00023219     	|  0.00014137     	|
|  [Callback]MacSummaryCallback.on_validation_batch_end                                                                                                                  	|  8.6452e-07     	|  252            	|  0.00021786     	|  0.00013265     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end  	|  8.1972e-07     	|  252            	|  0.00020657     	|  0.00012577     	|
|  [Callback]HydraOptCallback.on_validation_batch_end                                                                                                                    	|  7.921e-07      	|  252            	|  0.00019961     	|  0.00012154     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_start                                                                                                      	|  7.4612e-07     	|  252            	|  0.00018802     	|  0.00011448     	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                	|  0.00018339     	|  1              	|  0.00018339     	|  0.00011166     	|
|  [Callback]HydraOptCallback.on_validation_batch_start                                                                                                                  	|  7.2274e-07     	|  252            	|  0.00018213     	|  0.00011089     	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                      	|  7.2049e-07     	|  252            	|  0.00018156     	|  0.00011055     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_end                                                                                                        	|  7.1441e-07     	|  252            	|  0.00018003     	|  0.00010962     	|
|  [Callback]MacSummaryCallback.on_validation_batch_start                                                                                                                	|  7.1129e-07     	|  252            	|  0.00017925     	|  0.00010914     	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                              	|  0.00017793     	|  1              	|  0.00017793     	|  0.00010833     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start	|  6.9781e-07     	|  252            	|  0.00017585     	|  0.00010707     	|
|  [LightningModule]ImageClassifierModule.val_dataloader                                                                                                                 	|  0.00016927     	|  1              	|  0.00016927     	|  0.00010307     	|
|  [LightningModule]ImageClassifierModule.on_save_checkpoint                                                                                                             	|  2.527e-06      	|  66             	|  0.00016678     	|  0.00010155     	|
|  [Callback]PredictionLogger.on_validation_batch_start                                                                                                                  	|  5.7257e-07     	|  252            	|  0.00014429     	|  8.7852e-05     	|
|  [Callback]LearningRateMonitor.on_save_checkpoint                                                                                                                      	|  1.6561e-06     	|  66             	|  0.0001093      	|  6.6551e-05     	|
|  [Callback]PredictionLogger.on_validation_epoch_end                                                                                                                    	|  1.7252e-06     	|  51             	|  8.7987e-05     	|  5.3573e-05     	|
|  [Callback]LearningRateMonitor.on_validation_end                                                                                                                       	|  1.5781e-06     	|  51             	|  8.0485e-05     	|  4.9005e-05     	|
|  [Callback]HydraOptCallback.on_validation_epoch_end                                                                                                                    	|  1.4962e-06     	|  51             	|  7.6304e-05     	|  4.646e-05      	|
|  [Callback]LearningRateMonitor.on_validation_epoch_end                                                                                                                 	|  1.3821e-06     	|  51             	|  7.0486e-05     	|  4.2917e-05     	|
|  [Callback]MacSummaryCallback.on_train_epoch_start                                                                                                                     	|  1.3851e-06     	|  50             	|  6.9257e-05     	|  4.2169e-05     	|
|  [Callback]LearningRateMonitor.on_train_epoch_end                                                                                                                      	|  1.2294e-06     	|  50             	|  6.1468e-05     	|  3.7426e-05     	|
|  [Callback]LearningRateMonitor.on_validation_start                                                                                                                     	|  1.1985e-06     	|  51             	|  6.1125e-05     	|  3.7218e-05     	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                              	|  1.1831e-06     	|  51             	|  6.0339e-05     	|  3.6739e-05     	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                           	|  1.0959e-06     	|  50             	|  5.4796e-05     	|  3.3364e-05     	|
|  [Callback]MacSummaryCallback.on_save_checkpoint                                                                                                                       	|  8.2219e-07     	|  66             	|  5.4264e-05     	|  3.304e-05      	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                            	|  9.6208e-07     	|  51             	|  4.9066e-05     	|  2.9875e-05     	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                             	|  9.6485e-07     	|  50             	|  4.8242e-05     	|  2.9373e-05     	|
|  [Callback]MacSummaryCallback.on_validation_start                                                                                                                      	|  9.1515e-07     	|  51             	|  4.6673e-05     	|  2.8418e-05     	|
|  [Callback]LearningRateMonitor.on_validation_epoch_start                                                                                                               	|  8.7178e-07     	|  51             	|  4.4461e-05     	|  2.7071e-05     	|
|  [Callback]PredictionLogger.on_validation_end                                                                                                                          	|  8.6209e-07     	|  51             	|  4.3967e-05     	|  2.677e-05      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_save_checkpoint       	|  6.5752e-07     	|  66             	|  4.3397e-05     	|  2.6423e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                      	|  7.975e-07      	|  51             	|  4.0672e-05     	|  2.4764e-05     	|
|  [Callback]HydraOptCallback.on_save_checkpoint                                                                                                                         	|  6.1194e-07     	|  66             	|  4.0388e-05     	|  2.4591e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_end                                                                                                              	|  7.7422e-07     	|  51             	|  3.9485e-05     	|  2.4041e-05     	|
|  [Callback]PredictionLogger.on_save_checkpoint                                                                                                                         	|  5.9603e-07     	|  66             	|  3.9338e-05     	|  2.3952e-05     	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_start                                                                                                           	|  7.7828e-07     	|  50             	|  3.8914e-05     	|  2.3694e-05     	|
|  [Callback]HydraOptCallback.on_train_epoch_start                                                                                                                       	|  7.4931e-07     	|  50             	|  3.7466e-05     	|  2.2812e-05     	|
|  [Callback]MacSummaryCallback.on_validation_end                                                                                                                        	|  7.1815e-07     	|  51             	|  3.6626e-05     	|  2.2301e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_start                                                                                                            	|  7.1633e-07     	|  51             	|  3.6533e-05     	|  2.2244e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_start     	|  7.2549e-07     	|  50             	|  3.6275e-05     	|  2.2087e-05     	|
|  [Callback]MacSummaryCallback.on_validation_epoch_start                                                                                                                	|  6.9377e-07     	|  51             	|  3.5382e-05     	|  2.1543e-05     	|
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                          	|  4.9426e-07     	|  66             	|  3.2621e-05     	|  1.9862e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                     	|  6.3034e-07     	|  51             	|  3.2147e-05     	|  1.9574e-05     	|
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                             	|  4.7181e-07     	|  66             	|  3.114e-05      	|  1.896e-05      	|
|  [Callback]HydraOptCallback.on_validation_start                                                                                                                        	|  6.0542e-07     	|  51             	|  3.0877e-05     	|  1.88e-05       	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start      	|  5.9616e-07     	|  51             	|  3.0404e-05     	|  1.8512e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                    	|  5.7951e-07     	|  51             	|  2.9555e-05     	|  1.7995e-05     	|
|  [Callback]LearningRateMonitor.on_train_start                                                                                                                          	|  2.9544e-05     	|  1              	|  2.9544e-05     	|  1.7989e-05     	|
|  [Callback]MacSummaryCallback.on_train_epoch_end                                                                                                                       	|  5.8646e-07     	|  50             	|  2.9323e-05     	|  1.7854e-05     	|
|  [Callback]PredictionLogger.on_train_epoch_end                                                                                                                         	|  5.7569e-07     	|  50             	|  2.8785e-05     	|  1.7526e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end  	|  5.569e-07      	|  51             	|  2.8402e-05     	|  1.7293e-05     	|
|  [Callback]PredictionLogger.on_validation_start                                                                                                                        	|  5.4611e-07     	|  51             	|  2.7851e-05     	|  1.6958e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                        	|  5.4502e-07     	|  51             	|  2.7796e-05     	|  1.6924e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                      	|  5.4051e-07     	|  51             	|  2.7566e-05     	|  1.6784e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_start                                                                                                      	|  5.3797e-07     	|  51             	|  2.7437e-05     	|  1.6705e-05     	|
|  [Callback]PredictionLogger.on_train_epoch_start                                                                                                                       	|  5.3237e-07     	|  50             	|  2.6618e-05     	|  1.6207e-05     	|
|  [Callback]HydraOptCallback.on_train_epoch_end                                                                                                                         	|  5.1079e-07     	|  50             	|  2.5539e-05     	|  1.555e-05      	|
|  [Callback]HydraOptCallback.on_validation_epoch_start                                                                                                                  	|  5.0033e-07     	|  51             	|  2.5517e-05     	|  1.5537e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start	|  4.9886e-07     	|  51             	|  2.5442e-05     	|  1.5491e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                   	|  4.7716e-07     	|  51             	|  2.4335e-05     	|  1.4817e-05     	|
|  [Callback]PredictionLogger.on_validation_epoch_start                                                                                                                  	|  4.7126e-07     	|  51             	|  2.4034e-05     	|  1.4634e-05     	|
|  [Callback]LearningRateMonitor.setup                                                                                                                                   	|  3.5348e-06     	|  1              	|  3.5348e-06     	|  2.1523e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start             	|  3.265e-06      	|  1              	|  3.265e-06      	|  1.988e-06      	|
|  [Callback]LearningRateMonitor.on_sanity_check_start                                                                                                                   	|  3.265e-06      	|  1              	|  3.265e-06      	|  1.988e-06      	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                       	|  3.244e-06      	|  1              	|  3.244e-06      	|  1.9752e-06     	|
|  [LightningModule]ImageClassifierModule.configure_callbacks                                                                                                            	|  2.9739e-06     	|  1              	|  2.9739e-06     	|  1.8108e-06     	|
|  [LightningModule]ImageClassifierModule.on_fit_start                                                                                                                   	|  2.5639e-06     	|  1              	|  2.5639e-06     	|  1.5611e-06     	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                         	|  2.5032e-06     	|  1              	|  2.5032e-06     	|  1.5241e-06     	|
|  [Callback]PredictionLogger.setup                                                                                                                                      	|  2.1241e-06     	|  1              	|  2.1241e-06     	|  1.2933e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_start                                                                                                                 	|  1.973e-06      	|  1              	|  1.973e-06      	|  1.2013e-06     	|
|  [Callback]HydraOptCallback.on_train_start                                                                                                                             	|  1.8529e-06     	|  1              	|  1.8529e-06     	|  1.1282e-06     	|
|  [Callback]LearningRateMonitor.on_train_end                                                                                                                            	|  1.8021e-06     	|  1              	|  1.8021e-06     	|  1.0973e-06     	|
|  [Callback]LearningRateMonitor.on_fit_end                                                                                                                              	|  1.7129e-06     	|  1              	|  1.7129e-06     	|  1.043e-06      	|
|  [Callback]LearningRateMonitor.on_fit_start                                                                                                                            	|  1.6629e-06     	|  1              	|  1.6629e-06     	|  1.0125e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_start           	|  1.5919e-06     	|  1              	|  1.5919e-06     	|  9.6924e-07     	|
|  [Callback]MacSummaryCallback.setup                                                                                                                                    	|  1.4519e-06     	|  1              	|  1.4519e-06     	|  8.8404e-07     	|
|  [Callback]ModelSummary.setup                                                                                                                                          	|  1.4119e-06     	|  1              	|  1.4119e-06     	|  8.5966e-07     	|
|  [Callback]LearningRateMonitor.teardown                                                                                                                                	|  1.3921e-06     	|  1              	|  1.3921e-06     	|  8.4761e-07     	|
|  [Callback]LearningRateMonitor.on_sanity_check_end                                                                                                                     	|  1.322e-06      	|  1              	|  1.322e-06      	|  8.0494e-07     	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                          	|  1.2419e-06     	|  1              	|  1.2419e-06     	|  7.5617e-07     	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                 	|  1.0519e-06     	|  1              	|  1.0519e-06     	|  6.4049e-07     	|
|  [Callback]HydraOptCallback.setup                                                                                                                                      	|  1.041e-06      	|  1              	|  1.041e-06      	|  6.3383e-07     	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                   	|  1.041e-06      	|  1              	|  1.041e-06      	|  6.3383e-07     	|
|  [Callback]PredictionLogger.on_sanity_check_start                                                                                                                      	|  9.2201e-07     	|  1              	|  9.2201e-07     	|  5.6139e-07     	|
|  [LightningModule]ImageClassifierModule.on_train_end                                                                                                                   	|  9.2178e-07     	|  1              	|  9.2178e-07     	|  5.6124e-07     	|
|  [LightningModule]ImageClassifierModule.teardown                                                                                                                       	|  8.8103e-07     	|  1              	|  8.8103e-07     	|  5.3644e-07     	|
|  [Callback]MacSummaryCallback.on_fit_start                                                                                                                             	|  8.7102e-07     	|  1              	|  8.7102e-07     	|  5.3034e-07     	|
|  [Callback]MacSummaryCallback.on_fit_end                                                                                                                               	|  8.6194e-07     	|  1              	|  8.6194e-07     	|  5.2481e-07     	|
|  [Callback]MacSummaryCallback.teardown                                                                                                                                 	|  8.3097e-07     	|  1              	|  8.3097e-07     	|  5.0596e-07     	|
|  [LightningModule]ImageClassifierModule.on_fit_end                                                                                                                     	|  8.021e-07      	|  1              	|  8.021e-07      	|  4.8838e-07     	|
|  [Callback]MacSummaryCallback.on_train_end                                                                                                                             	|  8.0117e-07     	|  1              	|  8.0117e-07     	|  4.8781e-07     	|
|  [Callback]MacSummaryCallback.on_sanity_check_end                                                                                                                      	|  7.8208e-07     	|  1              	|  7.8208e-07     	|  4.7619e-07     	|
|  [Callback]MacSummaryCallback.on_sanity_check_start                                                                                                                    	|  7.8185e-07     	|  1              	|  7.8185e-07     	|  4.7604e-07     	|
|  [Callback]PredictionLogger.on_train_start                                                                                                                             	|  7.5088e-07     	|  1              	|  7.5088e-07     	|  4.5719e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_end             	|  7.411e-07      	|  1              	|  7.411e-07      	|  4.5124e-07     	|
|  [Callback]HydraOptCallback.on_train_end                                                                                                                               	|  7.1106e-07     	|  1              	|  7.1106e-07     	|  4.3295e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                         	|  7.1083e-07     	|  1              	|  7.1083e-07     	|  4.3281e-07     	|
|  [Callback]HydraOptCallback.on_fit_start                                                                                                                               	|  7.0105e-07     	|  1              	|  7.0105e-07     	|  4.2685e-07     	|
|  [Callback]PredictionLogger.on_fit_end                                                                                                                                 	|  6.9104e-07     	|  1              	|  6.9104e-07     	|  4.2076e-07     	|
|  [Callback]HydraOptCallback.teardown                                                                                                                                   	|  6.7102e-07     	|  1              	|  6.7102e-07     	|  4.0856e-07     	|
|  [Callback]HydraOptCallback.on_fit_end                                                                                                                                 	|  6.5123e-07     	|  1              	|  6.5123e-07     	|  3.9651e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                           	|  6.4098e-07     	|  1              	|  6.4098e-07     	|  3.9028e-07     	|
|  [Callback]ModelSummary.teardown                                                                                                                                       	|  6.4098e-07     	|  1              	|  6.4098e-07     	|  3.9028e-07     	|
|  [Callback]PredictionLogger.on_fit_start                                                                                                                               	|  6.3097e-07     	|  1              	|  6.3097e-07     	|  3.8418e-07     	|
|  [Callback]PredictionLogger.on_train_end                                                                                                                               	|  6.3097e-07     	|  1              	|  6.3097e-07     	|  3.8418e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_end      	|  6.2096e-07     	|  1              	|  6.2096e-07     	|  3.7809e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                 	|  6.1095e-07     	|  1              	|  6.1095e-07     	|  3.7199e-07     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                    	|  6.0094e-07     	|  1              	|  6.0094e-07     	|  3.6589e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_start    	|  5.9092e-07     	|  1              	|  5.9092e-07     	|  3.598e-07      	|
|  [Callback]PredictionLogger.teardown                                                                                                                                   	|  5.9092e-07     	|  1              	|  5.9092e-07     	|  3.598e-07      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end               	|  5.6112e-07     	|  1              	|  5.6112e-07     	|  3.4165e-07     	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                	|  5.3109e-07     	|  1              	|  5.3109e-07     	|  3.2336e-07     	|
|  [Callback]HydraOptCallback.on_sanity_check_end                                                                                                                        	|  5.2084e-07     	|  1              	|  5.2084e-07     	|  3.1713e-07     	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                            	|  5.1106e-07     	|  1              	|  5.1106e-07     	|  3.1117e-07     	|
|  [Callback]PredictionLogger.on_sanity_check_end                                                                                                                        	|  4.9104e-07     	|  1              	|  4.9104e-07     	|  2.9898e-07     	|
|  [Callback]HydraOptCallback.on_sanity_check_start                                                                                                                      	|  4.9011e-07     	|  1              	|  4.9011e-07     	|  2.9841e-07     	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                  	|  4.61e-07       	|  1              	|  4.61e-07       	|  2.8069e-07     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                     	|  4.6007e-07     	|  1              	|  4.6007e-07     	|  2.8013e-07     	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[2024-05-16 18:49:13,155][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:49:13,155][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:49:13,157][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=49-step=2250.ckpt
[2024-05-16 18:49:13,167][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:49:13,343][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=49-step=2250.ckpt
[2024-05-16 18:49:13,344][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-16 18:49:13,615][pytorch_lightning.profilers.profiler][INFO] - VALIDATE Profiler Report

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                 	|  -              	|  146250         	|  164.7          	|  100 %          	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                    	|  2.9897         	|  50             	|  149.48         	|  90.761         	|
|  [_TrainingEpochLoop].train_dataloader_next                                                                                                                            	|  0.035163       	|  2250           	|  79.117         	|  48.037         	|
|  run_training_batch                                                                                                                                                    	|  0.024454       	|  2250           	|  55.022         	|  33.408         	|
|  [LightningModule]ImageClassifierModule.optimizer_step                                                                                                                 	|  0.024376       	|  2250           	|  54.845         	|  33.3           	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                          	|  0.011087       	|  2250           	|  24.946         	|  15.147         	|
|  [_EvaluationLoop].val_next                                                                                                                                            	|  0.035667       	|  257            	|  9.1665         	|  5.5656         	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_end                                                                                                             	|  0.12167        	|  50             	|  6.0833         	|  3.6936         	|
|  [LightningModule]ImageClassifierModule.prepare_data                                                                                                                   	|  2.2481         	|  2              	|  4.4963         	|  2.73           	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                               	|  0.0019752      	|  2250           	|  4.4441         	|  2.6983         	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                        	|  0.010223       	|  257            	|  2.6274         	|  1.5953         	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_end       	|  0.044675       	|  50             	|  2.2337         	|  1.3563         	|
|  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                          	|  0.00034581     	|  2250           	|  0.77806        	|  0.47241        	|
|  [LightningModule]ImageClassifierModule.setup                                                                                                                          	|  0.33285        	|  2              	|  0.6657         	|  0.40419        	|
|  [LightningModule]ImageClassifierModule.optimizer_zero_grad                                                                                                            	|  0.00016428     	|  2250           	|  0.36962        	|  0.22442        	|
|  [Callback]HydraOptCallback.on_train_batch_end                                                                                                                         	|  0.00015766     	|  2250           	|  0.35474        	|  0.21539        	|
|  [Callback]MacSummaryCallback.on_validation_epoch_end                                                                                                                  	|  0.0063541      	|  52             	|  0.33041        	|  0.20062        	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                        	|  0.00011454     	|  2507           	|  0.28715        	|  0.17435        	|
|  [LightningModule]ImageClassifierModule.transfer_batch_to_device                                                                                                       	|  9.2442e-05     	|  2510           	|  0.23203        	|  0.14088        	|
|  [Callback]LearningRateMonitor.on_train_batch_start                                                                                                                    	|  7.9226e-05     	|  2250           	|  0.17826        	|  0.10823        	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                   	|  0.16338        	|  1              	|  0.16338        	|  0.099199       	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                     	|  0.00016719     	|  257            	|  0.042967       	|  0.026088       	|
|  [LightningModule]ImageClassifierModule.lr_scheduler_step                                                                                                              	|  1.7832e-05     	|  2250           	|  0.040123       	|  0.024361       	|
|  [LightningModule]ImageClassifierModule.configure_gradient_clipping                                                                                                    	|  1.6213e-05     	|  2250           	|  0.036479       	|  0.022149       	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_end       	|  1.1885e-05     	|  2250           	|  0.026742       	|  0.016237       	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                        	|  0.00027587     	|  50             	|  0.013793       	|  0.0083748      	|
|  [LightningModule]ImageClassifierModule.on_validation_model_zero_grad                                                                                                  	|  0.00026609     	|  50             	|  0.013305       	|  0.0080781      	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                   	|  4.9952e-05     	|  257            	|  0.012838       	|  0.0077946      	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                           	|  0.00024462     	|  52             	|  0.01272        	|  0.0077232      	|
|  [LightningModule]ImageClassifierModule.on_validation_model_eval                                                                                                       	|  0.00021294     	|  52             	|  0.011073       	|  0.006723       	|
|  [LightningModule]ImageClassifierModule.configure_optimizers                                                                                                           	|  0.0099326      	|  1              	|  0.0099326      	|  0.0060308      	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                         	|  0.00016128     	|  52             	|  0.0083863      	|  0.0050919      	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                          	|  0.0001388      	|  50             	|  0.00694        	|  0.0042137      	|
|  [Callback]MacSummaryCallback.on_train_start                                                                                                                           	|  0.0062505      	|  1              	|  0.0062505      	|  0.0037951      	|
|  [Callback]HydraOptCallback.on_validation_end                                                                                                                          	|  0.00011908     	|  52             	|  0.0061924      	|  0.0037598      	|
|  [Callback]LearningRateMonitor.on_before_zero_grad                                                                                                                     	|  1.6118e-06     	|  2250           	|  0.0036264      	|  0.0022019      	|
|  [Callback]ModelSummary.on_train_batch_end                                                                                                                             	|  1.4706e-06     	|  2250           	|  0.0033088      	|  0.002009       	|
|  [Callback]LearningRateMonitor.on_train_batch_end                                                                                                                      	|  1.418e-06      	|  2250           	|  0.0031906      	|  0.0019372      	|
|  [Callback]LearningRateMonitor.on_before_backward                                                                                                                      	|  1.377e-06      	|  2250           	|  0.0030982      	|  0.0018811      	|
|  [Callback]LearningRateMonitor.on_after_backward                                                                                                                       	|  1.2651e-06     	|  2250           	|  0.0028465      	|  0.0017283      	|
|  [Callback]LearningRateMonitor.on_before_optimizer_step                                                                                                                	|  1.2643e-06     	|  2250           	|  0.0028447      	|  0.0017272      	|
|  [LightningModule]ImageClassifierModule.on_before_batch_transfer                                                                                                       	|  1.0942e-06     	|  2510           	|  0.0027464      	|  0.0016675      	|
|  [Callback]MacSummaryCallback.on_train_batch_start                                                                                                                     	|  1.1542e-06     	|  2250           	|  0.002597       	|  0.0015768      	|
|  [Callback]PredictionLogger.on_train_batch_end                                                                                                                         	|  1.0456e-06     	|  2250           	|  0.0023526      	|  0.0014284      	|
|  [Callback]MacSummaryCallback.on_before_zero_grad                                                                                                                      	|  9.4566e-07     	|  2250           	|  0.0021277      	|  0.0012919      	|
|  [Callback]LearningRateMonitor.on_train_epoch_start                                                                                                                    	|  3.8999e-05     	|  50             	|  0.0019499      	|  0.0011839      	|
|  [LightningModule]ImageClassifierModule.on_after_batch_transfer                                                                                                        	|  7.4161e-07     	|  2510           	|  0.0018614      	|  0.0011302      	|
|  [Callback]MacSummaryCallback.on_before_optimizer_step                                                                                                                 	|  8.2162e-07     	|  2250           	|  0.0018486      	|  0.0011224      	|
|  [LightningModule]ImageClassifierModule.on_train_batch_end                                                                                                             	|  7.7625e-07     	|  2250           	|  0.0017466      	|  0.0010605      	|
|  [Callback]MacSummaryCallback.on_train_batch_end                                                                                                                       	|  7.5074e-07     	|  2250           	|  0.0016892      	|  0.0010256      	|
|  [Callback]PredictionLogger.on_before_zero_grad                                                                                                                        	|  7.2797e-07     	|  2250           	|  0.0016379      	|  0.00099449     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_zero_grad      	|  7.1138e-07     	|  2250           	|  0.0016006      	|  0.00097183     	|
|  [LightningModule]ImageClassifierModule.on_before_zero_grad                                                                                                            	|  7.0341e-07     	|  2250           	|  0.0015827      	|  0.00096094     	|
|  [Callback]MacSummaryCallback.on_after_backward                                                                                                                        	|  7.0187e-07     	|  2250           	|  0.0015792      	|  0.00095884     	|
|  [Callback]HydraOptCallback.on_before_zero_grad                                                                                                                        	|  7.0155e-07     	|  2250           	|  0.0015785      	|  0.0009584      	|
|  [Callback]MacSummaryCallback.on_before_backward                                                                                                                       	|  6.8638e-07     	|  2250           	|  0.0015444      	|  0.00093768     	|
|  [LightningModule]ImageClassifierModule.on_train_batch_start                                                                                                           	|  6.7464e-07     	|  2250           	|  0.0015179      	|  0.00092165     	|
|  [Callback]HydraOptCallback.on_before_optimizer_step                                                                                                                   	|  6.5587e-07     	|  2250           	|  0.0014757      	|  0.000896       	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                   	|  6.4976e-07     	|  2250           	|  0.001462       	|  0.00088765     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_start     	|  6.4826e-07     	|  2250           	|  0.0014586      	|  0.0008856      	|
|  [Callback]HydraOptCallback.on_train_batch_start                                                                                                                       	|  6.4582e-07     	|  2250           	|  0.0014531      	|  0.00088227     	|
|  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                        	|  6.4001e-07     	|  2250           	|  0.00144        	|  0.00087433     	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                             	|  6.2682e-07     	|  2250           	|  0.0014103      	|  0.00085631     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_backward       	|  6.2453e-07     	|  2250           	|  0.0014052      	|  0.00085319     	|
|  [Callback]PredictionLogger.on_before_backward                                                                                                                         	|  6.1283e-07     	|  2250           	|  0.0013789      	|  0.00083721     	|
|  [LightningModule]ImageClassifierModule.on_after_backward                                                                                                              	|  6.086e-07      	|  2250           	|  0.0013694      	|  0.00083143     	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                          	|  6.0192e-07     	|  2250           	|  0.0013543      	|  0.00082229     	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                         	|  6.0064e-07     	|  2250           	|  0.0013514      	|  0.00082055     	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                       	|  5.984e-07      	|  2250           	|  0.0013464      	|  0.00081749     	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                           	|  5.7383e-07     	|  2250           	|  0.0012911      	|  0.00078393     	|
|  [Callback]PredictionLogger.on_train_batch_start                                                                                                                       	|  5.7285e-07     	|  2250           	|  0.0012889      	|  0.00078258     	|
|  [Callback]PredictionLogger.on_after_backward                                                                                                                          	|  5.6986e-07     	|  2250           	|  0.0012822      	|  0.0007785      	|
|  [LightningModule]ImageClassifierModule.on_before_backward                                                                                                             	|  5.6911e-07     	|  2250           	|  0.0012805      	|  0.00077748     	|
|  [Callback]HydraOptCallback.on_before_backward                                                                                                                         	|  5.6275e-07     	|  2250           	|  0.0012662      	|  0.00076879     	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                    	|  5.5437e-07     	|  2250           	|  0.0012473      	|  0.00075733     	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                            	|  5.5415e-07     	|  2250           	|  0.0012468      	|  0.00075704     	|
|  [Callback]PredictionLogger.on_before_optimizer_step                                                                                                                   	|  5.5329e-07     	|  2250           	|  0.0012449      	|  0.00075587     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_optimizer_step 	|  5.4089e-07     	|  2250           	|  0.001217       	|  0.00073892     	|
|  [Callback]ModelSummary.on_train_batch_start                                                                                                                           	|  5.3943e-07     	|  2250           	|  0.0012137      	|  0.00073692     	|
|  [LightningModule]ImageClassifierModule.on_before_optimizer_step                                                                                                       	|  5.3531e-07     	|  2250           	|  0.0012045      	|  0.0007313      	|
|  [Callback]HydraOptCallback.on_after_backward                                                                                                                          	|  5.3318e-07     	|  2250           	|  0.0011997      	|  0.00072839     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_after_backward        	|  5.1873e-07     	|  2250           	|  0.0011671      	|  0.00070865     	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                              	|  4.7257e-07     	|  2250           	|  0.0010633      	|  0.00064559     	|
|  [LightningModule]ImageClassifierModule.on_load_checkpoint                                                                                                             	|  0.00082678     	|  1              	|  0.00082678     	|  0.00050199     	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_end                                                                                                        	|  1.3253e-05     	|  52             	|  0.00068914     	|  0.00041842     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end        	|  1.2596e-05     	|  52             	|  0.00065499     	|  0.00039769     	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                       	|  0.0006505      	|  1              	|  0.0006505      	|  0.00039496     	|
|  [Callback]PredictionLogger.on_validation_batch_end                                                                                                                    	|  1.7735e-06     	|  257            	|  0.0004558      	|  0.00027675     	|
|  [Callback]LearningRateMonitor.on_validation_batch_end                                                                                                                 	|  1.5809e-06     	|  257            	|  0.00040629     	|  0.00024669     	|
|  [Callback]LearningRateMonitor.on_validation_batch_start                                                                                                               	|  1.3635e-06     	|  257            	|  0.00035042     	|  0.00021276     	|
|  [LightningModule]ImageClassifierModule.val_dataloader                                                                                                                 	|  0.00016643     	|  2              	|  0.00033286     	|  0.0002021      	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                        	|  1.1507e-06     	|  257            	|  0.00029572     	|  0.00017955     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                    	|  0.00013153     	|  2              	|  0.00026306     	|  0.00015972     	|
|  [LightningModule]ImageClassifierModule.train_dataloader                                                                                                               	|  0.00025343     	|  1              	|  0.00025343     	|  0.00015387     	|
|  [Callback]MacSummaryCallback.on_validation_batch_end                                                                                                                  	|  8.6325e-07     	|  257            	|  0.00022186     	|  0.0001347      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end  	|  8.1667e-07     	|  257            	|  0.00020988     	|  0.00012743     	|
|  [Callback]HydraOptCallback.on_validation_batch_end                                                                                                                    	|  7.9174e-07     	|  257            	|  0.00020348     	|  0.00012354     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_start                                                                                                      	|  7.4532e-07     	|  257            	|  0.00019155     	|  0.0001163      	|
|  [Callback]HydraOptCallback.on_validation_batch_start                                                                                                                  	|  7.2005e-07     	|  257            	|  0.00018505     	|  0.00011236     	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                      	|  7.1957e-07     	|  257            	|  0.00018493     	|  0.00011228     	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                	|  0.00018339     	|  1              	|  0.00018339     	|  0.00011135     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_end                                                                                                        	|  7.1346e-07     	|  257            	|  0.00018336     	|  0.00011133     	|
|  [Callback]MacSummaryCallback.on_validation_batch_start                                                                                                                	|  7.1191e-07     	|  257            	|  0.00018296     	|  0.00011109     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start	|  6.9605e-07     	|  257            	|  0.00017888     	|  0.00010861     	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                              	|  0.00017793     	|  1              	|  0.00017793     	|  0.00010803     	|
|  [LightningModule]ImageClassifierModule.on_save_checkpoint                                                                                                             	|  2.527e-06      	|  66             	|  0.00016678     	|  0.00010127     	|
|  [Callback]PredictionLogger.on_validation_batch_start                                                                                                                  	|  5.7183e-07     	|  257            	|  0.00014696     	|  8.9229e-05     	|
|  [Callback]LearningRateMonitor.on_save_checkpoint                                                                                                                      	|  1.6561e-06     	|  66             	|  0.0001093      	|  6.6364e-05     	|
|  [Callback]PredictionLogger.on_validation_epoch_end                                                                                                                    	|  1.7223e-06     	|  52             	|  8.956e-05      	|  5.4378e-05     	|
|  [Callback]LearningRateMonitor.on_validation_end                                                                                                                       	|  1.5734e-06     	|  52             	|  8.1817e-05     	|  4.9677e-05     	|
|  [Callback]HydraOptCallback.on_validation_epoch_end                                                                                                                    	|  1.5051e-06     	|  52             	|  7.8267e-05     	|  4.7521e-05     	|
|  [Callback]LearningRateMonitor.on_validation_epoch_end                                                                                                                 	|  1.3873e-06     	|  52             	|  7.2138e-05     	|  4.38e-05       	|
|  [Callback]MacSummaryCallback.on_train_epoch_start                                                                                                                     	|  1.3851e-06     	|  50             	|  6.9257e-05     	|  4.205e-05      	|
|  [Callback]LearningRateMonitor.on_validation_start                                                                                                                     	|  1.2021e-06     	|  52             	|  6.2507e-05     	|  3.7952e-05     	|
|  [Callback]LearningRateMonitor.on_train_epoch_end                                                                                                                      	|  1.2294e-06     	|  50             	|  6.1468e-05     	|  3.7322e-05     	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                              	|  1.1812e-06     	|  52             	|  6.1421e-05     	|  3.7293e-05     	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                           	|  1.0959e-06     	|  50             	|  5.4796e-05     	|  3.327e-05      	|
|  [Callback]MacSummaryCallback.on_save_checkpoint                                                                                                                       	|  8.2219e-07     	|  66             	|  5.4264e-05     	|  3.2948e-05     	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                            	|  9.6382e-07     	|  52             	|  5.0118e-05     	|  3.043e-05      	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                             	|  9.6485e-07     	|  50             	|  4.8242e-05     	|  2.9291e-05     	|
|  [Callback]MacSummaryCallback.on_validation_start                                                                                                                      	|  9.1411e-07     	|  52             	|  4.7534e-05     	|  2.8861e-05     	|
|  [Callback]LearningRateMonitor.on_validation_epoch_start                                                                                                               	|  8.7217e-07     	|  52             	|  4.5353e-05     	|  2.7537e-05     	|
|  [Callback]PredictionLogger.on_validation_end                                                                                                                          	|  8.663e-07      	|  52             	|  4.5047e-05     	|  2.7351e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_save_checkpoint       	|  6.5752e-07     	|  66             	|  4.3397e-05     	|  2.6349e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                      	|  7.9506e-07     	|  52             	|  4.1343e-05     	|  2.5102e-05     	|
|  [Callback]HydraOptCallback.on_save_checkpoint                                                                                                                         	|  6.1194e-07     	|  66             	|  4.0388e-05     	|  2.4522e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_end                                                                                                              	|  7.7281e-07     	|  52             	|  4.0186e-05     	|  2.44e-05       	|
|  [Callback]PredictionLogger.on_save_checkpoint                                                                                                                         	|  5.9603e-07     	|  66             	|  3.9338e-05     	|  2.3885e-05     	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_start                                                                                                           	|  7.7828e-07     	|  50             	|  3.8914e-05     	|  2.3627e-05     	|
|  [Callback]HydraOptCallback.on_train_epoch_start                                                                                                                       	|  7.4931e-07     	|  50             	|  3.7466e-05     	|  2.2748e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_start                                                                                                            	|  7.193e-07      	|  52             	|  3.7404e-05     	|  2.271e-05      	|
|  [Callback]MacSummaryCallback.on_validation_end                                                                                                                        	|  7.186e-07      	|  52             	|  3.7367e-05     	|  2.2688e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_start     	|  7.2549e-07     	|  50             	|  3.6275e-05     	|  2.2025e-05     	|
|  [Callback]MacSummaryCallback.on_validation_epoch_start                                                                                                                	|  6.9063e-07     	|  52             	|  3.5913e-05     	|  2.1805e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                     	|  6.3074e-07     	|  52             	|  3.2798e-05     	|  1.9914e-05     	|
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                          	|  4.9426e-07     	|  66             	|  3.2621e-05     	|  1.9807e-05     	|
|  [Callback]HydraOptCallback.on_validation_start                                                                                                                        	|  6.0572e-07     	|  52             	|  3.1498e-05     	|  1.9124e-05     	|
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                             	|  4.7181e-07     	|  66             	|  3.114e-05      	|  1.8907e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start      	|  5.9837e-07     	|  52             	|  3.1115e-05     	|  1.8892e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                    	|  5.8106e-07     	|  52             	|  3.0215e-05     	|  1.8346e-05     	|
|  [Callback]LearningRateMonitor.on_train_start                                                                                                                          	|  2.9544e-05     	|  1              	|  2.9544e-05     	|  1.7938e-05     	|
|  [Callback]MacSummaryCallback.on_train_epoch_end                                                                                                                       	|  5.8646e-07     	|  50             	|  2.9323e-05     	|  1.7804e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end  	|  5.6083e-07     	|  52             	|  2.9163e-05     	|  1.7707e-05     	|
|  [Callback]PredictionLogger.on_train_epoch_end                                                                                                                         	|  5.7569e-07     	|  50             	|  2.8785e-05     	|  1.7477e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                        	|  5.4591e-07     	|  52             	|  2.8387e-05     	|  1.7236e-05     	|
|  [Callback]PredictionLogger.on_validation_start                                                                                                                        	|  5.4543e-07     	|  52             	|  2.8362e-05     	|  1.7221e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                      	|  5.3937e-07     	|  52             	|  2.8047e-05     	|  1.7029e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_start                                                                                                      	|  5.3918e-07     	|  52             	|  2.8037e-05     	|  1.7023e-05     	|
|  [Callback]PredictionLogger.on_train_epoch_start                                                                                                                       	|  5.3237e-07     	|  50             	|  2.6618e-05     	|  1.6162e-05     	|
|  [Callback]HydraOptCallback.on_validation_epoch_start                                                                                                                  	|  5.011e-07      	|  52             	|  2.6057e-05     	|  1.5821e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start	|  4.9832e-07     	|  52             	|  2.5913e-05     	|  1.5733e-05     	|
|  [Callback]HydraOptCallback.on_train_epoch_end                                                                                                                         	|  5.1079e-07     	|  50             	|  2.5539e-05     	|  1.5507e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                   	|  4.7627e-07     	|  52             	|  2.4766e-05     	|  1.5037e-05     	|
|  [Callback]PredictionLogger.on_validation_epoch_start                                                                                                                  	|  4.7145e-07     	|  52             	|  2.4515e-05     	|  1.4885e-05     	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                       	|  2.6835e-06     	|  2              	|  5.367e-06      	|  3.2586e-06     	|
|  [Callback]LearningRateMonitor.setup                                                                                                                                   	|  2.5789e-06     	|  2              	|  5.1579e-06     	|  3.1317e-06     	|
|  [Callback]PredictionLogger.setup                                                                                                                                      	|  2.0935e-06     	|  2              	|  4.187e-06      	|  2.5422e-06     	|
|  [LightningModule]ImageClassifierModule.configure_callbacks                                                                                                            	|  2.043e-06      	|  2              	|  4.0859e-06     	|  2.4808e-06     	|
|  [Callback]LearningRateMonitor.teardown                                                                                                                                	|  1.6725e-06     	|  2              	|  3.3451e-06     	|  2.031e-06      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start             	|  3.265e-06      	|  1              	|  3.265e-06      	|  1.9824e-06     	|
|  [Callback]LearningRateMonitor.on_sanity_check_start                                                                                                                   	|  3.265e-06      	|  1              	|  3.265e-06      	|  1.9824e-06     	|
|  [LightningModule]ImageClassifierModule.on_fit_start                                                                                                                   	|  2.5639e-06     	|  1              	|  2.5639e-06     	|  1.5567e-06     	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                         	|  2.5032e-06     	|  1              	|  2.5032e-06     	|  1.5198e-06     	|
|  [Callback]MacSummaryCallback.setup                                                                                                                                    	|  1.177e-06      	|  2              	|  2.3539e-06     	|  1.4292e-06     	|
|  [Callback]ModelSummary.setup                                                                                                                                          	|  1.0865e-06     	|  2              	|  2.173e-06      	|  1.3194e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_start                                                                                                                 	|  1.973e-06      	|  1              	|  1.973e-06      	|  1.1979e-06     	|
|  [Callback]MacSummaryCallback.teardown                                                                                                                                 	|  9.3144e-07     	|  2              	|  1.8629e-06     	|  1.1311e-06     	|
|  [Callback]HydraOptCallback.on_train_start                                                                                                                             	|  1.8529e-06     	|  1              	|  1.8529e-06     	|  1.125e-06      	|
|  [Callback]LearningRateMonitor.on_train_end                                                                                                                            	|  1.8021e-06     	|  1              	|  1.8021e-06     	|  1.0942e-06     	|
|  [LightningModule]ImageClassifierModule.teardown                                                                                                                       	|  8.9104e-07     	|  2              	|  1.7821e-06     	|  1.082e-06      	|
|  [Callback]LearningRateMonitor.on_fit_end                                                                                                                              	|  1.7129e-06     	|  1              	|  1.7129e-06     	|  1.04e-06       	|
|  [Callback]LearningRateMonitor.on_fit_start                                                                                                                            	|  1.6629e-06     	|  1              	|  1.6629e-06     	|  1.0096e-06     	|
|  [Callback]HydraOptCallback.setup                                                                                                                                      	|  8.3097e-07     	|  2              	|  1.6619e-06     	|  1.0091e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_start           	|  1.5919e-06     	|  1              	|  1.5919e-06     	|  9.6653e-07     	|
|  [Callback]HydraOptCallback.teardown                                                                                                                                   	|  6.7602e-07     	|  2              	|  1.352e-06      	|  8.2092e-07     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                    	|  6.7602e-07     	|  2              	|  1.352e-06      	|  8.2092e-07     	|
|  [Callback]LearningRateMonitor.on_sanity_check_end                                                                                                                     	|  1.322e-06      	|  1              	|  1.322e-06      	|  8.0268e-07     	|
|  [Callback]PredictionLogger.teardown                                                                                                                                   	|  6.56e-07       	|  2              	|  1.312e-06      	|  7.966e-07      	|
|  [Callback]ModelSummary.teardown                                                                                                                                       	|  6.56e-07       	|  2              	|  1.312e-06      	|  7.966e-07      	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                          	|  1.2419e-06     	|  1              	|  1.2419e-06     	|  7.5405e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                 	|  6.1095e-07     	|  2              	|  1.2219e-06     	|  7.4189e-07     	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                 	|  1.0519e-06     	|  1              	|  1.0519e-06     	|  6.387e-07      	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                   	|  1.041e-06      	|  1              	|  1.041e-06      	|  6.3205e-07     	|
|  [Callback]PredictionLogger.on_sanity_check_start                                                                                                                      	|  9.2201e-07     	|  1              	|  9.2201e-07     	|  5.5981e-07     	|
|  [LightningModule]ImageClassifierModule.on_train_end                                                                                                                   	|  9.2178e-07     	|  1              	|  9.2178e-07     	|  5.5967e-07     	|
|  [Callback]MacSummaryCallback.on_fit_start                                                                                                                             	|  8.7102e-07     	|  1              	|  8.7102e-07     	|  5.2885e-07     	|
|  [Callback]MacSummaryCallback.on_fit_end                                                                                                                               	|  8.6194e-07     	|  1              	|  8.6194e-07     	|  5.2334e-07     	|
|  [LightningModule]ImageClassifierModule.on_fit_end                                                                                                                     	|  8.021e-07      	|  1              	|  8.021e-07      	|  4.8701e-07     	|
|  [Callback]MacSummaryCallback.on_train_end                                                                                                                             	|  8.0117e-07     	|  1              	|  8.0117e-07     	|  4.8644e-07     	|
|  [Callback]MacSummaryCallback.on_sanity_check_end                                                                                                                      	|  7.8208e-07     	|  1              	|  7.8208e-07     	|  4.7485e-07     	|
|  [Callback]MacSummaryCallback.on_sanity_check_start                                                                                                                    	|  7.8185e-07     	|  1              	|  7.8185e-07     	|  4.7471e-07     	|
|  [Callback]PredictionLogger.on_train_start                                                                                                                             	|  7.5088e-07     	|  1              	|  7.5088e-07     	|  4.5591e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_end             	|  7.411e-07      	|  1              	|  7.411e-07      	|  4.4997e-07     	|
|  [Callback]HydraOptCallback.on_train_end                                                                                                                               	|  7.1106e-07     	|  1              	|  7.1106e-07     	|  4.3173e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                         	|  7.1083e-07     	|  1              	|  7.1083e-07     	|  4.3159e-07     	|
|  [Callback]HydraOptCallback.on_fit_start                                                                                                                               	|  7.0105e-07     	|  1              	|  7.0105e-07     	|  4.2566e-07     	|
|  [Callback]PredictionLogger.on_fit_end                                                                                                                                 	|  6.9104e-07     	|  1              	|  6.9104e-07     	|  4.1958e-07     	|
|  [Callback]HydraOptCallback.on_fit_end                                                                                                                                 	|  6.5123e-07     	|  1              	|  6.5123e-07     	|  3.954e-07      	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                           	|  6.4098e-07     	|  1              	|  6.4098e-07     	|  3.8918e-07     	|
|  [Callback]PredictionLogger.on_fit_start                                                                                                                               	|  6.3097e-07     	|  1              	|  6.3097e-07     	|  3.831e-07      	|
|  [Callback]PredictionLogger.on_train_end                                                                                                                               	|  6.3097e-07     	|  1              	|  6.3097e-07     	|  3.831e-07      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_end      	|  6.2096e-07     	|  1              	|  6.2096e-07     	|  3.7703e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_start    	|  5.9092e-07     	|  1              	|  5.9092e-07     	|  3.5879e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end               	|  5.6112e-07     	|  1              	|  5.6112e-07     	|  3.4069e-07     	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                	|  5.3109e-07     	|  1              	|  5.3109e-07     	|  3.2246e-07     	|
|  [Callback]HydraOptCallback.on_sanity_check_end                                                                                                                        	|  5.2084e-07     	|  1              	|  5.2084e-07     	|  3.1624e-07     	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                            	|  5.1106e-07     	|  1              	|  5.1106e-07     	|  3.103e-07      	|
|  [Callback]PredictionLogger.on_sanity_check_end                                                                                                                        	|  4.9104e-07     	|  1              	|  4.9104e-07     	|  2.9814e-07     	|
|  [Callback]HydraOptCallback.on_sanity_check_start                                                                                                                      	|  4.9011e-07     	|  1              	|  4.9011e-07     	|  2.9758e-07     	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                  	|  4.61e-07       	|  1              	|  4.61e-07       	|  2.7991e-07     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                     	|  4.6007e-07     	|  1              	|  4.6007e-07     	|  2.7934e-07     	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[2024-05-16 18:49:13,617][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-16 18:49:13,617][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-16 18:49:13,619][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=49-step=2250.ckpt
[2024-05-16 18:49:13,629][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-16 18:49:13,991][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/cifar10/trained_models/test/kakao_resnet8/checkpoints/epoch=49-step=2250.ckpt
[2024-05-16 18:49:13,992][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-16 18:49:14,454][hannah.callbacks.summaries][INFO] - 
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
|    | Name         | Type              | Attrs                                            | IFM              |   IFM volume | OFM              |   OFM volume |   Weights volume |     MACs |
|----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------|
|  0 | 0.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |             1728 |  1769472 |
|  1 | 0.1          | BatchNorm2d       |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  2 | 0.2          | ReLU              |                                                  | (1, 64, 32, 32)  |        65536 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  3 | 0            | Sequential        |                                                  | (1, 3, 32, 32)   |         3072 | (1, 64, 32, 32)  |        65536 |                0 |        0 |
|  4 | 1.0          | Conv2d            | k=(5, 5), s=(2, 2), g=(1), dsc=(False), d=(1, 1) | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |           204800 | 52428800 |
|  5 | 1.1          | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  6 | 1.2          | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  7 | 1            | Sequential        |                                                  | (1, 64, 32, 32)  |        65536 | (1, 128, 16, 16) |        32768 |                0 |        0 |
|  8 | 2.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
|  9 | 2.module.0.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 10 | 2.module.0.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 11 | 2.module.0   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 12 | 2.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |           147456 | 37748736 |
| 13 | 2.module.1.1 | BatchNorm2d       |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 14 | 2.module.1.2 | ReLU              |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 15 | 2.module.1   | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 16 | 2.module     | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 17 | 2            | Residual          |                                                  | (1, 128, 16, 16) |        32768 | (1, 128, 16, 16) |        32768 |                0 |        0 |
| 18 | 3.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |           294912 | 75497472 |
| 19 | 3.1          | BatchNorm2d       |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 20 | 3.2          | ReLU              |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 21 | 3            | Sequential        |                                                  | (1, 128, 16, 16) |        32768 | (1, 256, 16, 16) |        65536 |                0 |        0 |
| 22 | 4            | MaxPool2d         |                                                  | (1, 256, 16, 16) |        65536 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 23 | 5.module.0.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 24 | 5.module.0.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 25 | 5.module.0.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 26 | 5.module.0   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 27 | 5.module.1.0 | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |           589824 | 37748736 |
| 28 | 5.module.1.1 | BatchNorm2d       |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 29 | 5.module.1.2 | ReLU              |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 30 | 5.module.1   | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 31 | 5.module     | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 32 | 5            | Residual          |                                                  | (1, 256, 8, 8)   |        16384 | (1, 256, 8, 8)   |        16384 |                0 |        0 |
| 33 | 6.0          | Conv2d            | k=(3, 3), s=(1, 1), g=(1), dsc=(False), d=(1, 1) | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |           294912 | 10616832 |
| 34 | 6.1          | BatchNorm2d       |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 35 | 6.2          | ReLU              |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 36 | 6            | Sequential        |                                                  | (1, 256, 8, 8)   |        16384 | (1, 128, 6, 6)   |         4608 |                0 |        0 |
| 37 | 7            | AdaptiveMaxPool2d |                                                  | (1, 128, 6, 6)   |         4608 | (1, 128, 1, 1)   |          128 |                0 |        0 |
| 38 | 8            | Flatten           |                                                  | (1, 128, 1, 1)   |          128 | (1, 128)         |          128 |                0 |        0 |
| 39 | 9            | Linear            |                                                  | (1, 128)         |          128 | (1, 10)          |           10 |             1280 |     1280 |
| 40 | 10           | Mul               |                                                  | (1, 10)          |           10 | (1, 10)          |           10 |                0 |        0 |
+----+--------------+-------------------+--------------------------------------------------+------------------+--------------+------------------+--------------+------------------+----------+
[2024-05-16 18:49:14,454][hannah.callbacks.summaries][INFO] - Total MACs: 291,308,800
[2024-05-16 18:49:14,454][hannah.callbacks.summaries][INFO] - Total Weights: 2,272,192
[2024-05-16 18:49:14,454][hannah.callbacks.summaries][INFO] - Total Activations: 1,185,044
[2024-05-16 18:49:14,454][hannah.callbacks.summaries][INFO] - Estimated Activations: 131,072
[2024-05-16 18:49:14,455][hannah.datasets.base][WARNING] - Datasets class names contain classes that are longer than the recommended lenght of 5 characters, consider implementing class_names_abbreviated in your dataset
[2024-05-16 18:49:14,455][hannah.datasets.base][WARNING] - Datasets class names contain classes that are longer than the recommended lenght of 5 characters, consider implementing class_names_abbreviated in your dataset
[2024-05-16 18:49:14,881][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/torchmetrics/utilities/prints.py:43: UserWarning: The ``compute`` method of metric MulticlassROC was called before the ``update`` method which may lead to errors, as metric states have not yet been updated.
  warnings.warn(*args, **kwargs)  # noqa: B028

[2024-05-16 18:49:14,886][hannah.datasets.base][WARNING] - Datasets class names contain classes that are longer than the recommended lenght of 5 characters, consider implementing class_names_abbreviated in your dataset
[2024-05-16 18:49:14,985][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/torchmetrics/utilities/prints.py:43: UserWarning: The ``compute`` method of metric MulticlassPrecisionRecallCurve was called before the ``update`` method which may lead to errors, as metric states have not yet been updated.
  warnings.warn(*args, **kwargs)  # noqa: B028

[2024-05-16 18:49:14,988][hannah.datasets.base][WARNING] - Datasets class names contain classes that are longer than the recommended lenght of 5 characters, consider implementing class_names_abbreviated in your dataset
[2024-05-16 18:49:15,114][pytorch_lightning.profilers.profiler][INFO] - TEST Profiler Report

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                 	|  -              	|  146528         	|  166.2          	|  100 %          	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                    	|  2.9897         	|  50             	|  149.48         	|  89.942         	|
|  [_TrainingEpochLoop].train_dataloader_next                                                                                                                            	|  0.035163       	|  2250           	|  79.117         	|  47.604         	|
|  run_training_batch                                                                                                                                                    	|  0.024454       	|  2250           	|  55.022         	|  33.106         	|
|  [LightningModule]ImageClassifierModule.optimizer_step                                                                                                                 	|  0.024376       	|  2250           	|  54.845         	|  33.0           	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                          	|  0.011087       	|  2250           	|  24.946         	|  15.01          	|
|  [_EvaluationLoop].val_next                                                                                                                                            	|  0.035667       	|  257            	|  9.1665         	|  5.5154         	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_end                                                                                                             	|  0.12167        	|  50             	|  6.0833         	|  3.6602         	|
|  [LightningModule]ImageClassifierModule.prepare_data                                                                                                                   	|  1.4988         	|  3              	|  4.4963         	|  2.7054         	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                               	|  0.0019752      	|  2250           	|  4.4441         	|  2.674          	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                        	|  0.010223       	|  257            	|  2.6274         	|  1.5809         	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_end       	|  0.044675       	|  50             	|  2.2337         	|  1.344          	|
|  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                          	|  0.00034581     	|  2250           	|  0.77806        	|  0.46815        	|
|  [LightningModule]ImageClassifierModule.setup                                                                                                                          	|  0.22206        	|  3              	|  0.66619        	|  0.40084        	|
|  [LightningModule]ImageClassifierModule.on_test_end                                                                                                                    	|  0.63042        	|  1              	|  0.63042        	|  0.37932        	|
|  [LightningModule]ImageClassifierModule.optimizer_zero_grad                                                                                                            	|  0.00016428     	|  2250           	|  0.36962        	|  0.2224         	|
|  [Callback]HydraOptCallback.on_train_batch_end                                                                                                                         	|  0.00015766     	|  2250           	|  0.35474        	|  0.21345        	|
|  [_EvaluationLoop].test_next                                                                                                                                           	|  0.034001       	|  10             	|  0.34001        	|  0.20458        	|
|  [Callback]MacSummaryCallback.on_validation_epoch_end                                                                                                                  	|  0.0063541      	|  52             	|  0.33041        	|  0.19881        	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                        	|  0.00011452     	|  2517           	|  0.28824        	|  0.17343        	|
|  [LightningModule]ImageClassifierModule.transfer_batch_to_device                                                                                                       	|  9.2404e-05     	|  2521           	|  0.23295        	|  0.14016        	|
|  [Callback]LearningRateMonitor.on_train_batch_start                                                                                                                    	|  7.9226e-05     	|  2250           	|  0.17826        	|  0.10726        	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                   	|  0.16338        	|  1              	|  0.16338        	|  0.098304       	|
|  [Strategy]SingleDeviceStrategy.test_step                                                                                                                              	|  0.0099145      	|  10             	|  0.099145       	|  0.059655       	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                     	|  0.00016719     	|  257            	|  0.042967       	|  0.025853       	|
|  [LightningModule]ImageClassifierModule.lr_scheduler_step                                                                                                              	|  1.7832e-05     	|  2250           	|  0.040123       	|  0.024142       	|
|  [LightningModule]ImageClassifierModule.configure_gradient_clipping                                                                                                    	|  1.6213e-05     	|  2250           	|  0.036479       	|  0.021949       	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_end       	|  1.1885e-05     	|  2250           	|  0.026742       	|  0.016091       	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                        	|  0.00027587     	|  50             	|  0.013793       	|  0.0082993      	|
|  [LightningModule]ImageClassifierModule.on_validation_model_zero_grad                                                                                                  	|  0.00026609     	|  50             	|  0.013305       	|  0.0080053      	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                   	|  4.9952e-05     	|  257            	|  0.012838       	|  0.0077243      	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                           	|  0.00024462     	|  52             	|  0.01272        	|  0.0076536      	|
|  [LightningModule]ImageClassifierModule.on_validation_model_eval                                                                                                       	|  0.00021294     	|  52             	|  0.011073       	|  0.0066624      	|
|  [LightningModule]ImageClassifierModule.configure_optimizers                                                                                                           	|  0.0099326      	|  1              	|  0.0099326      	|  0.0059764      	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                         	|  0.00016128     	|  52             	|  0.0083863      	|  0.005046       	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                          	|  0.0001388      	|  50             	|  0.00694        	|  0.0041757      	|
|  [Callback]MacSummaryCallback.on_test_end                                                                                                                              	|  0.006315       	|  1              	|  0.006315       	|  0.0037997      	|
|  [Callback]MacSummaryCallback.on_train_start                                                                                                                           	|  0.0062505      	|  1              	|  0.0062505      	|  0.0037609      	|
|  [Callback]HydraOptCallback.on_validation_end                                                                                                                          	|  0.00011908     	|  52             	|  0.0061924      	|  0.0037259      	|
|  [Callback]LearningRateMonitor.on_before_zero_grad                                                                                                                     	|  1.6118e-06     	|  2250           	|  0.0036264      	|  0.002182       	|
|  [Callback]ModelSummary.on_train_batch_end                                                                                                                             	|  1.4706e-06     	|  2250           	|  0.0033088      	|  0.0019908      	|
|  [Callback]LearningRateMonitor.on_train_batch_end                                                                                                                      	|  1.418e-06      	|  2250           	|  0.0031906      	|  0.0019197      	|
|  [Callback]LearningRateMonitor.on_before_backward                                                                                                                      	|  1.377e-06      	|  2250           	|  0.0030982      	|  0.0018642      	|
|  [Callback]LearningRateMonitor.on_after_backward                                                                                                                       	|  1.2651e-06     	|  2250           	|  0.0028465      	|  0.0017127      	|
|  [Callback]LearningRateMonitor.on_before_optimizer_step                                                                                                                	|  1.2643e-06     	|  2250           	|  0.0028447      	|  0.0017116      	|
|  [LightningModule]ImageClassifierModule.on_before_batch_transfer                                                                                                       	|  1.0941e-06     	|  2521           	|  0.0027581      	|  0.0016595      	|
|  [Callback]MacSummaryCallback.on_train_batch_start                                                                                                                     	|  1.1542e-06     	|  2250           	|  0.002597       	|  0.0015626      	|
|  [Callback]PredictionLogger.on_train_batch_end                                                                                                                         	|  1.0456e-06     	|  2250           	|  0.0023526      	|  0.0014155      	|
|  [Callback]MacSummaryCallback.on_before_zero_grad                                                                                                                      	|  9.4566e-07     	|  2250           	|  0.0021277      	|  0.0012802      	|
|  [Callback]LearningRateMonitor.on_train_epoch_start                                                                                                                    	|  3.8999e-05     	|  50             	|  0.0019499      	|  0.0011733      	|
|  [LightningModule]ImageClassifierModule.on_after_batch_transfer                                                                                                        	|  7.4103e-07     	|  2521           	|  0.0018681      	|  0.001124       	|
|  [Callback]MacSummaryCallback.on_before_optimizer_step                                                                                                                 	|  8.2162e-07     	|  2250           	|  0.0018486      	|  0.0011123      	|
|  [LightningModule]ImageClassifierModule.on_train_batch_end                                                                                                             	|  7.7625e-07     	|  2250           	|  0.0017466      	|  0.0010509      	|
|  [Callback]MacSummaryCallback.on_train_batch_end                                                                                                                       	|  7.5074e-07     	|  2250           	|  0.0016892      	|  0.0010164      	|
|  [LightningModule]ImageClassifierModule.on_load_checkpoint                                                                                                             	|  0.00081987     	|  2              	|  0.0016397      	|  0.00098662     	|
|  [Callback]PredictionLogger.on_before_zero_grad                                                                                                                        	|  7.2797e-07     	|  2250           	|  0.0016379      	|  0.00098552     	|
|  [Callback]TQDMProgressBar.on_test_batch_end                                                                                                                           	|  0.00016043     	|  10             	|  0.0016043      	|  0.00096527     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_zero_grad      	|  7.1138e-07     	|  2250           	|  0.0016006      	|  0.00096306     	|
|  [LightningModule]ImageClassifierModule.on_before_zero_grad                                                                                                            	|  7.0341e-07     	|  2250           	|  0.0015827      	|  0.00095227     	|
|  [Callback]MacSummaryCallback.on_after_backward                                                                                                                        	|  7.0187e-07     	|  2250           	|  0.0015792      	|  0.0009502      	|
|  [Callback]HydraOptCallback.on_before_zero_grad                                                                                                                        	|  7.0155e-07     	|  2250           	|  0.0015785      	|  0.00094975     	|
|  [Callback]MacSummaryCallback.on_before_backward                                                                                                                       	|  6.8638e-07     	|  2250           	|  0.0015444      	|  0.00092922     	|
|  [LightningModule]ImageClassifierModule.on_train_batch_start                                                                                                           	|  6.7464e-07     	|  2250           	|  0.0015179      	|  0.00091333     	|
|  [Callback]HydraOptCallback.on_before_optimizer_step                                                                                                                   	|  6.5587e-07     	|  2250           	|  0.0014757      	|  0.00088792     	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                   	|  6.4976e-07     	|  2250           	|  0.001462       	|  0.00087965     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_start     	|  6.4826e-07     	|  2250           	|  0.0014586      	|  0.00087761     	|
|  [Callback]HydraOptCallback.on_train_batch_start                                                                                                                       	|  6.4582e-07     	|  2250           	|  0.0014531      	|  0.00087432     	|
|  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                        	|  6.4001e-07     	|  2250           	|  0.00144        	|  0.00086644     	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                             	|  6.2682e-07     	|  2250           	|  0.0014103      	|  0.00084859     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_backward       	|  6.2453e-07     	|  2250           	|  0.0014052      	|  0.00084549     	|
|  [Callback]PredictionLogger.on_before_backward                                                                                                                         	|  6.1283e-07     	|  2250           	|  0.0013789      	|  0.00082966     	|
|  [LightningModule]ImageClassifierModule.on_after_backward                                                                                                              	|  6.086e-07      	|  2250           	|  0.0013694      	|  0.00082393     	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                          	|  6.0192e-07     	|  2250           	|  0.0013543      	|  0.00081488     	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                         	|  6.0064e-07     	|  2250           	|  0.0013514      	|  0.00081315     	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                       	|  5.984e-07      	|  2250           	|  0.0013464      	|  0.00081012     	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                           	|  5.7383e-07     	|  2250           	|  0.0012911      	|  0.00077686     	|
|  [Callback]PredictionLogger.on_train_batch_start                                                                                                                       	|  5.7285e-07     	|  2250           	|  0.0012889      	|  0.00077553     	|
|  [Callback]PredictionLogger.on_after_backward                                                                                                                          	|  5.6986e-07     	|  2250           	|  0.0012822      	|  0.00077148     	|
|  [LightningModule]ImageClassifierModule.on_before_backward                                                                                                             	|  5.6911e-07     	|  2250           	|  0.0012805      	|  0.00077047     	|
|  [Callback]HydraOptCallback.on_before_backward                                                                                                                         	|  5.6275e-07     	|  2250           	|  0.0012662      	|  0.00076186     	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                    	|  5.5437e-07     	|  2250           	|  0.0012473      	|  0.0007505      	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                            	|  5.5415e-07     	|  2250           	|  0.0012468      	|  0.00075022     	|
|  [Callback]PredictionLogger.on_before_optimizer_step                                                                                                                   	|  5.5329e-07     	|  2250           	|  0.0012449      	|  0.00074905     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_optimizer_step 	|  5.4089e-07     	|  2250           	|  0.001217       	|  0.00073225     	|
|  [Callback]ModelSummary.on_train_batch_start                                                                                                                           	|  5.3943e-07     	|  2250           	|  0.0012137      	|  0.00073028     	|
|  [LightningModule]ImageClassifierModule.on_before_optimizer_step                                                                                                       	|  5.3531e-07     	|  2250           	|  0.0012045      	|  0.00072471     	|
|  [Callback]HydraOptCallback.on_after_backward                                                                                                                          	|  5.3318e-07     	|  2250           	|  0.0011997      	|  0.00072182     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_after_backward        	|  5.1873e-07     	|  2250           	|  0.0011671      	|  0.00070226     	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                              	|  4.7257e-07     	|  2250           	|  0.0010633      	|  0.00063976     	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_end                                                                                                        	|  1.3253e-05     	|  52             	|  0.00068914     	|  0.00041465     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end        	|  1.2596e-05     	|  52             	|  0.00065499     	|  0.0003941      	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                       	|  0.0006505      	|  1              	|  0.0006505      	|  0.0003914      	|
|  [Callback]PredictionLogger.on_validation_batch_end                                                                                                                    	|  1.7735e-06     	|  257            	|  0.0004558      	|  0.00027425     	|
|  [Callback]LearningRateMonitor.on_validation_batch_end                                                                                                                 	|  1.5809e-06     	|  257            	|  0.00040629     	|  0.00024446     	|
|  [Callback]LearningRateMonitor.on_validation_batch_start                                                                                                               	|  1.3635e-06     	|  257            	|  0.00035042     	|  0.00021084     	|
|  [LightningModule]ImageClassifierModule.val_dataloader                                                                                                                 	|  0.00016643     	|  2              	|  0.00033286     	|  0.00020028     	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                        	|  1.1507e-06     	|  257            	|  0.00029572     	|  0.00017793     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                    	|  9.8074e-05     	|  3              	|  0.00029422     	|  0.00017703     	|
|  [LightningModule]ImageClassifierModule.train_dataloader                                                                                                               	|  0.00025343     	|  1              	|  0.00025343     	|  0.00015249     	|
|  [Callback]TQDMProgressBar.on_test_batch_start                                                                                                                         	|  2.3841e-05     	|  10             	|  0.00023841     	|  0.00014345     	|
|  [Callback]MacSummaryCallback.on_validation_batch_end                                                                                                                  	|  8.6325e-07     	|  257            	|  0.00022186     	|  0.00013349     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end  	|  8.1667e-07     	|  257            	|  0.00020988     	|  0.00012629     	|
|  [Callback]HydraOptCallback.on_validation_batch_end                                                                                                                    	|  7.9174e-07     	|  257            	|  0.00020348     	|  0.00012243     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_start                                                                                                      	|  7.4532e-07     	|  257            	|  0.00019155     	|  0.00011525     	|
|  [LightningModule]ImageClassifierModule.on_test_model_eval                                                                                                             	|  0.0001878      	|  1              	|  0.0001878      	|  0.000113       	|
|  [Callback]HydraOptCallback.on_validation_batch_start                                                                                                                  	|  7.2005e-07     	|  257            	|  0.00018505     	|  0.00011134     	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                      	|  7.1957e-07     	|  257            	|  0.00018493     	|  0.00011127     	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                	|  0.00018339     	|  1              	|  0.00018339     	|  0.00011035     	|
|  [LightningModule]ImageClassifierModule.on_validation_batch_end                                                                                                        	|  7.1346e-07     	|  257            	|  0.00018336     	|  0.00011033     	|
|  [Callback]MacSummaryCallback.on_validation_batch_start                                                                                                                	|  7.1191e-07     	|  257            	|  0.00018296     	|  0.00011009     	|
|  [Callback]TQDMProgressBar.on_test_start                                                                                                                               	|  0.00018281     	|  1              	|  0.00018281     	|  0.00011        	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start	|  6.9605e-07     	|  257            	|  0.00017888     	|  0.00010763     	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                              	|  0.00017793     	|  1              	|  0.00017793     	|  0.00010706     	|
|  [LightningModule]ImageClassifierModule.test_dataloader                                                                                                                	|  0.0001734      	|  1              	|  0.0001734      	|  0.00010433     	|
|  [Callback]HydraOptCallback.on_test_end                                                                                                                                	|  0.00016704     	|  1              	|  0.00016704     	|  0.00010051     	|
|  [LightningModule]ImageClassifierModule.on_save_checkpoint                                                                                                             	|  2.527e-06      	|  66             	|  0.00016678     	|  0.00010035     	|
|  [Callback]PredictionLogger.on_validation_batch_start                                                                                                                  	|  5.7183e-07     	|  257            	|  0.00014696     	|  8.8425e-05     	|
|  [Callback]TQDMProgressBar.on_test_end                                                                                                                                 	|  0.00013754     	|  1              	|  0.00013754     	|  8.2755e-05     	|
|  [Callback]LearningRateMonitor.on_save_checkpoint                                                                                                                      	|  1.6561e-06     	|  66             	|  0.0001093      	|  6.5766e-05     	|
|  [Callback]PredictionLogger.on_validation_epoch_end                                                                                                                    	|  1.7223e-06     	|  52             	|  8.956e-05      	|  5.3888e-05     	|
|  [Callback]LearningRateMonitor.on_validation_end                                                                                                                       	|  1.5734e-06     	|  52             	|  8.1817e-05     	|  4.9229e-05     	|
|  [Callback]HydraOptCallback.on_validation_epoch_end                                                                                                                    	|  1.5051e-06     	|  52             	|  7.8267e-05     	|  4.7093e-05     	|
|  [Callback]LearningRateMonitor.on_validation_epoch_end                                                                                                                 	|  1.3873e-06     	|  52             	|  7.2138e-05     	|  4.3405e-05     	|
|  [Callback]MacSummaryCallback.on_train_epoch_start                                                                                                                     	|  1.3851e-06     	|  50             	|  6.9257e-05     	|  4.1671e-05     	|
|  [Callback]LearningRateMonitor.on_validation_start                                                                                                                     	|  1.2021e-06     	|  52             	|  6.2507e-05     	|  3.761e-05      	|
|  [Callback]LearningRateMonitor.on_train_epoch_end                                                                                                                      	|  1.2294e-06     	|  50             	|  6.1468e-05     	|  3.6985e-05     	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                              	|  1.1812e-06     	|  52             	|  6.1421e-05     	|  3.6956e-05     	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                           	|  1.0959e-06     	|  50             	|  5.4796e-05     	|  3.297e-05      	|
|  [Callback]MacSummaryCallback.on_save_checkpoint                                                                                                                       	|  8.2219e-07     	|  66             	|  5.4264e-05     	|  3.265e-05      	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                            	|  9.6382e-07     	|  52             	|  5.0118e-05     	|  3.0156e-05     	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                             	|  9.6485e-07     	|  50             	|  4.8242e-05     	|  2.9027e-05     	|
|  [Callback]MacSummaryCallback.on_validation_start                                                                                                                      	|  9.1411e-07     	|  52             	|  4.7534e-05     	|  2.8601e-05     	|
|  [Callback]LearningRateMonitor.on_validation_epoch_start                                                                                                               	|  8.7217e-07     	|  52             	|  4.5353e-05     	|  2.7288e-05     	|
|  [Callback]PredictionLogger.on_validation_end                                                                                                                          	|  8.663e-07      	|  52             	|  4.5047e-05     	|  2.7105e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_save_checkpoint       	|  6.5752e-07     	|  66             	|  4.3397e-05     	|  2.6111e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                      	|  7.9506e-07     	|  52             	|  4.1343e-05     	|  2.4876e-05     	|
|  [Callback]HydraOptCallback.on_save_checkpoint                                                                                                                         	|  6.1194e-07     	|  66             	|  4.0388e-05     	|  2.4301e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_end                                                                                                              	|  7.7281e-07     	|  52             	|  4.0186e-05     	|  2.418e-05      	|
|  [Callback]PredictionLogger.on_save_checkpoint                                                                                                                         	|  5.9603e-07     	|  66             	|  3.9338e-05     	|  2.3669e-05     	|
|  [LightningModule]ImageClassifierModule.on_train_epoch_start                                                                                                           	|  7.7828e-07     	|  50             	|  3.8914e-05     	|  2.3414e-05     	|
|  [Callback]HydraOptCallback.on_train_epoch_start                                                                                                                       	|  7.4931e-07     	|  50             	|  3.7466e-05     	|  2.2543e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_start                                                                                                            	|  7.193e-07      	|  52             	|  3.7404e-05     	|  2.2505e-05     	|
|  [Callback]MacSummaryCallback.on_validation_end                                                                                                                        	|  7.186e-07      	|  52             	|  3.7367e-05     	|  2.2483e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_start     	|  7.2549e-07     	|  50             	|  3.6275e-05     	|  2.1826e-05     	|
|  [Callback]MacSummaryCallback.on_validation_epoch_start                                                                                                                	|  6.9063e-07     	|  52             	|  3.5913e-05     	|  2.1608e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                     	|  6.3074e-07     	|  52             	|  3.2798e-05     	|  1.9734e-05     	|
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                          	|  4.9426e-07     	|  66             	|  3.2621e-05     	|  1.9628e-05     	|
|  [Callback]HydraOptCallback.on_validation_start                                                                                                                        	|  6.0572e-07     	|  52             	|  3.1498e-05     	|  1.8952e-05     	|
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                             	|  4.7181e-07     	|  66             	|  3.114e-05      	|  1.8736e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start      	|  5.9837e-07     	|  52             	|  3.1115e-05     	|  1.8722e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                    	|  5.8106e-07     	|  52             	|  3.0215e-05     	|  1.818e-05      	|
|  [Callback]LearningRateMonitor.on_train_start                                                                                                                          	|  2.9544e-05     	|  1              	|  2.9544e-05     	|  1.7776e-05     	|
|  [Callback]MacSummaryCallback.on_train_epoch_end                                                                                                                       	|  5.8646e-07     	|  50             	|  2.9323e-05     	|  1.7643e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end  	|  5.6083e-07     	|  52             	|  2.9163e-05     	|  1.7547e-05     	|
|  [Callback]PredictionLogger.on_train_epoch_end                                                                                                                         	|  5.7569e-07     	|  50             	|  2.8785e-05     	|  1.7319e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                        	|  5.4591e-07     	|  52             	|  2.8387e-05     	|  1.708e-05      	|
|  [Callback]PredictionLogger.on_validation_start                                                                                                                        	|  5.4543e-07     	|  52             	|  2.8362e-05     	|  1.7065e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                      	|  5.3937e-07     	|  52             	|  2.8047e-05     	|  1.6876e-05     	|
|  [LightningModule]ImageClassifierModule.on_validation_epoch_start                                                                                                      	|  5.3918e-07     	|  52             	|  2.8037e-05     	|  1.687e-05      	|
|  [Callback]PredictionLogger.on_train_epoch_start                                                                                                                       	|  5.3237e-07     	|  50             	|  2.6618e-05     	|  1.6016e-05     	|
|  [Callback]HydraOptCallback.on_validation_epoch_start                                                                                                                  	|  5.011e-07      	|  52             	|  2.6057e-05     	|  1.5678e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start	|  4.9832e-07     	|  52             	|  2.5913e-05     	|  1.5591e-05     	|
|  [Callback]HydraOptCallback.on_train_epoch_end                                                                                                                         	|  5.1079e-07     	|  50             	|  2.5539e-05     	|  1.5367e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                   	|  4.7627e-07     	|  52             	|  2.4766e-05     	|  1.4901e-05     	|
|  [Callback]PredictionLogger.on_validation_epoch_start                                                                                                                  	|  4.7145e-07     	|  52             	|  2.4515e-05     	|  1.4751e-05     	|
|  [Callback]PredictionLogger.on_test_batch_end                                                                                                                          	|  2.3204e-06     	|  10             	|  2.3204e-05     	|  1.3962e-05     	|
|  [Callback]LearningRateMonitor.on_test_batch_end                                                                                                                       	|  1.5935e-06     	|  10             	|  1.5935e-05     	|  9.588e-06      	|
|  [Callback]LearningRateMonitor.on_test_batch_start                                                                                                                     	|  1.4661e-06     	|  10             	|  1.4661e-05     	|  8.8216e-06     	|
|  [Callback]ModelSummary.on_test_batch_end                                                                                                                              	|  1.1037e-06     	|  10             	|  1.1037e-05     	|  6.6408e-06     	|
|  [Callback]MacSummaryCallback.on_test_batch_end                                                                                                                        	|  1.0127e-06     	|  10             	|  1.0127e-05     	|  6.0934e-06     	|
|  [LightningModule]ImageClassifierModule.on_test_batch_end                                                                                                              	|  8.0911e-07     	|  10             	|  8.0911e-06     	|  4.8683e-06     	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                       	|  2.647e-06      	|  3              	|  7.9409e-06     	|  4.778e-06      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_test_batch_end        	|  7.801e-07      	|  10             	|  7.801e-06      	|  4.6938e-06     	|
|  [LightningModule]ImageClassifierModule.on_test_batch_start                                                                                                            	|  7.6112e-07     	|  10             	|  7.6112e-06     	|  4.5796e-06     	|
|  [Callback]MacSummaryCallback.on_test_batch_start                                                                                                                      	|  7.1011e-07     	|  10             	|  7.1011e-06     	|  4.2727e-06     	|
|  [Callback]HydraOptCallback.on_test_batch_end                                                                                                                          	|  6.78e-07       	|  10             	|  6.78e-06       	|  4.0795e-06     	|
|  [Callback]LearningRateMonitor.setup                                                                                                                                   	|  2.2503e-06     	|  3              	|  6.7509e-06     	|  4.062e-06      	|
|  [Callback]ModelSummary.on_test_batch_start                                                                                                                            	|  6.539e-07      	|  10             	|  6.539e-06      	|  3.9345e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_test_batch_start      	|  6.1702e-07     	|  10             	|  6.1702e-06     	|  3.7126e-06     	|
|  [Callback]PredictionLogger.setup                                                                                                                                      	|  1.9863e-06     	|  3              	|  5.9588e-06     	|  3.5854e-06     	|
|  [Callback]HydraOptCallback.on_test_batch_start                                                                                                                        	|  5.4883e-07     	|  10             	|  5.4883e-06     	|  3.3022e-06     	|
|  [Callback]LearningRateMonitor.teardown                                                                                                                                	|  1.7927e-06     	|  3              	|  5.3782e-06     	|  3.236e-06      	|
|  [Callback]PredictionLogger.on_test_batch_start                                                                                                                        	|  5.3083e-07     	|  10             	|  5.3083e-06     	|  3.194e-06      	|
|  [LightningModule]ImageClassifierModule.configure_callbacks                                                                                                            	|  1.746e-06      	|  3              	|  5.238e-06      	|  3.1516e-06     	|
|  [Callback]MacSummaryCallback.teardown                                                                                                                                 	|  1.0917e-06     	|  3              	|  3.275e-06      	|  1.9705e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start             	|  3.265e-06      	|  1              	|  3.265e-06      	|  1.9645e-06     	|
|  [Callback]LearningRateMonitor.on_sanity_check_start                                                                                                                   	|  3.265e-06      	|  1              	|  3.265e-06      	|  1.9645e-06     	|
|  [Callback]MacSummaryCallback.setup                                                                                                                                    	|  1.0416e-06     	|  3              	|  3.1248e-06     	|  1.8802e-06     	|
|  [Callback]ModelSummary.setup                                                                                                                                          	|  9.7797e-07     	|  3              	|  2.9339e-06     	|  1.7653e-06     	|
|  [LightningModule]ImageClassifierModule.teardown                                                                                                                       	|  8.9811e-07     	|  3              	|  2.6943e-06     	|  1.6211e-06     	|
|  [LightningModule]ImageClassifierModule.on_fit_start                                                                                                                   	|  2.5639e-06     	|  1              	|  2.5639e-06     	|  1.5427e-06     	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                         	|  2.5032e-06     	|  1              	|  2.5032e-06     	|  1.5061e-06     	|
|  [Callback]HydraOptCallback.setup                                                                                                                                      	|  7.6764e-07     	|  3              	|  2.3029e-06     	|  1.3856e-06     	|
|  [Callback]PredictionLogger.on_test_epoch_end                                                                                                                          	|  2.2028e-06     	|  1              	|  2.2028e-06     	|  1.3254e-06     	|
|  [Callback]HydraOptCallback.teardown                                                                                                                                   	|  7.0105e-07     	|  3              	|  2.1032e-06     	|  1.2655e-06     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                    	|  6.6434e-07     	|  3              	|  1.993e-06      	|  1.1992e-06     	|
|  [Callback]ModelSummary.teardown                                                                                                                                       	|  6.6434e-07     	|  3              	|  1.993e-06      	|  1.1992e-06     	|
|  [LightningModule]ImageClassifierModule.on_train_start                                                                                                                 	|  1.973e-06      	|  1              	|  1.973e-06      	|  1.1871e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                 	|  6.5767e-07     	|  3              	|  1.973e-06      	|  1.1871e-06     	|
|  [Callback]PredictionLogger.teardown                                                                                                                                   	|  6.4098e-07     	|  3              	|  1.9229e-06     	|  1.157e-06      	|
|  [Callback]HydraOptCallback.on_train_start                                                                                                                             	|  1.8529e-06     	|  1              	|  1.8529e-06     	|  1.1149e-06     	|
|  [Callback]LearningRateMonitor.on_train_end                                                                                                                            	|  1.8021e-06     	|  1              	|  1.8021e-06     	|  1.0843e-06     	|
|  [Callback]LearningRateMonitor.on_fit_end                                                                                                                              	|  1.7129e-06     	|  1              	|  1.7129e-06     	|  1.0307e-06     	|
|  [Callback]LearningRateMonitor.on_fit_start                                                                                                                            	|  1.6629e-06     	|  1              	|  1.6629e-06     	|  1.0005e-06     	|
|  [Callback]LearningRateMonitor.on_test_end                                                                                                                             	|  1.6221e-06     	|  1              	|  1.6221e-06     	|  9.7602e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_start           	|  1.5919e-06     	|  1              	|  1.5919e-06     	|  9.5781e-07     	|
|  [Callback]LearningRateMonitor.on_test_start                                                                                                                           	|  1.3818e-06     	|  1              	|  1.3818e-06     	|  8.3145e-07     	|
|  [Callback]LearningRateMonitor.on_sanity_check_end                                                                                                                     	|  1.322e-06      	|  1              	|  1.322e-06      	|  7.9544e-07     	|
|  [Callback]LearningRateMonitor.on_test_epoch_end                                                                                                                       	|  1.322e-06      	|  1              	|  1.322e-06      	|  7.9544e-07     	|
|  [Callback]PredictionLogger.on_test_end                                                                                                                                	|  1.292e-06      	|  1              	|  1.292e-06      	|  7.7737e-07     	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                          	|  1.2419e-06     	|  1              	|  1.2419e-06     	|  7.4725e-07     	|
|  [Strategy]SingleDeviceStrategy.on_test_end                                                                                                                            	|  1.2321e-06     	|  1              	|  1.2321e-06     	|  7.4137e-07     	|
|  [Callback]ModelSummary.on_test_end                                                                                                                                    	|  1.2019e-06     	|  1              	|  1.2019e-06     	|  7.2315e-07     	|
|  [Callback]ModelSummary.on_test_start                                                                                                                                  	|  1.092e-06      	|  1              	|  1.092e-06      	|  6.5703e-07     	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                 	|  1.0519e-06     	|  1              	|  1.0519e-06     	|  6.3294e-07     	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                   	|  1.041e-06      	|  1              	|  1.041e-06      	|  6.2635e-07     	|
|  [Callback]PredictionLogger.on_sanity_check_start                                                                                                                      	|  9.2201e-07     	|  1              	|  9.2201e-07     	|  5.5476e-07     	|
|  [LightningModule]ImageClassifierModule.on_train_end                                                                                                                   	|  9.2178e-07     	|  1              	|  9.2178e-07     	|  5.5462e-07     	|
|  [Callback]MacSummaryCallback.on_fit_start                                                                                                                             	|  8.7102e-07     	|  1              	|  8.7102e-07     	|  5.2408e-07     	|
|  [Callback]MacSummaryCallback.on_fit_end                                                                                                                               	|  8.6194e-07     	|  1              	|  8.6194e-07     	|  5.1862e-07     	|
|  [Callback]LearningRateMonitor.on_test_epoch_start                                                                                                                     	|  8.51e-07       	|  1              	|  8.51e-07       	|  5.1204e-07     	|
|  [LightningModule]ImageClassifierModule.on_test_start                                                                                                                  	|  8.2096e-07     	|  1              	|  8.2096e-07     	|  4.9396e-07     	|
|  [LightningModule]ImageClassifierModule.on_fit_end                                                                                                                     	|  8.021e-07      	|  1              	|  8.021e-07      	|  4.8262e-07     	|
|  [Callback]MacSummaryCallback.on_train_end                                                                                                                             	|  8.0117e-07     	|  1              	|  8.0117e-07     	|  4.8206e-07     	|
|  [Callback]MacSummaryCallback.on_sanity_check_end                                                                                                                      	|  7.8208e-07     	|  1              	|  7.8208e-07     	|  4.7057e-07     	|
|  [Callback]MacSummaryCallback.on_sanity_check_start                                                                                                                    	|  7.8185e-07     	|  1              	|  7.8185e-07     	|  4.7043e-07     	|
|  [Callback]PredictionLogger.on_train_start                                                                                                                             	|  7.5088e-07     	|  1              	|  7.5088e-07     	|  4.518e-07      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_end             	|  7.411e-07      	|  1              	|  7.411e-07      	|  4.4591e-07     	|
|  [Callback]HydraOptCallback.on_train_end                                                                                                                               	|  7.1106e-07     	|  1              	|  7.1106e-07     	|  4.2784e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                         	|  7.1083e-07     	|  1              	|  7.1083e-07     	|  4.277e-07      	|
|  [Callback]HydraOptCallback.on_fit_start                                                                                                                               	|  7.0105e-07     	|  1              	|  7.0105e-07     	|  4.2182e-07     	|
|  [Callback]MacSummaryCallback.on_test_epoch_end                                                                                                                        	|  7.0082e-07     	|  1              	|  7.0082e-07     	|  4.2168e-07     	|
|  [Callback]PredictionLogger.on_fit_end                                                                                                                                 	|  6.9104e-07     	|  1              	|  6.9104e-07     	|  4.1579e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_test_start            	|  6.8103e-07     	|  1              	|  6.8103e-07     	|  4.0977e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_test_end              	|  6.8103e-07     	|  1              	|  6.8103e-07     	|  4.0977e-07     	|
|  [Callback]MacSummaryCallback.on_test_start                                                                                                                            	|  6.7102e-07     	|  1              	|  6.7102e-07     	|  4.0374e-07     	|
|  [Callback]HydraOptCallback.on_fit_end                                                                                                                                 	|  6.5123e-07     	|  1              	|  6.5123e-07     	|  3.9184e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                           	|  6.4098e-07     	|  1              	|  6.4098e-07     	|  3.8567e-07     	|
|  [Callback]PredictionLogger.on_fit_start                                                                                                                               	|  6.3097e-07     	|  1              	|  6.3097e-07     	|  3.7965e-07     	|
|  [Callback]PredictionLogger.on_train_end                                                                                                                               	|  6.3097e-07     	|  1              	|  6.3097e-07     	|  3.7965e-07     	|
|  [Callback]HydraOptCallback.on_test_epoch_end                                                                                                                          	|  6.3097e-07     	|  1              	|  6.3097e-07     	|  3.7965e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_end      	|  6.2096e-07     	|  1              	|  6.2096e-07     	|  3.7363e-07     	|
|  [Callback]TQDMProgressBar.on_test_epoch_end                                                                                                                           	|  6.2096e-07     	|  1              	|  6.2096e-07     	|  3.7363e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_test_epoch_end        	|  6.2096e-07     	|  1              	|  6.2096e-07     	|  3.7363e-07     	|
|  [LightningModule]ImageClassifierModule.on_test_epoch_end                                                                                                              	|  6.2096e-07     	|  1              	|  6.2096e-07     	|  3.7363e-07     	|
|  [Callback]HydraOptCallback.on_test_start                                                                                                                              	|  6.0094e-07     	|  1              	|  6.0094e-07     	|  3.6158e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_start    	|  5.9092e-07     	|  1              	|  5.9092e-07     	|  3.5555e-07     	|
|  [Strategy]SingleDeviceStrategy.on_test_start                                                                                                                          	|  5.7998e-07     	|  1              	|  5.7998e-07     	|  3.4897e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end               	|  5.6112e-07     	|  1              	|  5.6112e-07     	|  3.3762e-07     	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                	|  5.3109e-07     	|  1              	|  5.3109e-07     	|  3.1955e-07     	|
|  [Callback]MacSummaryCallback.on_test_epoch_start                                                                                                                      	|  5.2992e-07     	|  1              	|  5.2992e-07     	|  3.1885e-07     	|
|  [Callback]HydraOptCallback.on_sanity_check_end                                                                                                                        	|  5.2084e-07     	|  1              	|  5.2084e-07     	|  3.1339e-07     	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                            	|  5.1106e-07     	|  1              	|  5.1106e-07     	|  3.075e-07      	|
|  [Callback]ModelCheckpoint{'monitor': 'val_error', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_test_epoch_start      	|  5.1106e-07     	|  1              	|  5.1106e-07     	|  3.075e-07      	|
|  [Callback]ModelSummary.on_test_epoch_end                                                                                                                              	|  5.1106e-07     	|  1              	|  5.1106e-07     	|  3.075e-07      	|
|  [Callback]HydraOptCallback.on_test_epoch_start                                                                                                                        	|  5.099e-07      	|  1              	|  5.099e-07      	|  3.068e-07      	|
|  [Callback]PredictionLogger.on_sanity_check_end                                                                                                                        	|  4.9104e-07     	|  1              	|  4.9104e-07     	|  2.9545e-07     	|
|  [Callback]TQDMProgressBar.on_test_epoch_start                                                                                                                         	|  4.9104e-07     	|  1              	|  4.9104e-07     	|  2.9545e-07     	|
|  [Callback]HydraOptCallback.on_sanity_check_start                                                                                                                      	|  4.9011e-07     	|  1              	|  4.9011e-07     	|  2.9489e-07     	|
|  [Callback]PredictionLogger.on_test_start                                                                                                                              	|  4.8103e-07     	|  1              	|  4.8103e-07     	|  2.8943e-07     	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                  	|  4.61e-07       	|  1              	|  4.61e-07       	|  2.7738e-07     	|
|  [Callback]PredictionLogger.on_test_epoch_start                                                                                                                        	|  4.61e-07       	|  1              	|  4.61e-07       	|  2.7738e-07     	|
|  [LightningModule]ImageClassifierModule.on_test_epoch_start                                                                                                            	|  4.61e-07       	|  1              	|  4.61e-07       	|  2.7738e-07     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                     	|  4.6007e-07     	|  1              	|  4.6007e-07     	|  2.7682e-07     	|
|  [Callback]ModelSummary.on_test_epoch_start                                                                                                                            	|  4.4098e-07     	|  1              	|  4.4098e-07     	|  2.6533e-07     	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[2024-05-16 18:49:15,124][hannah.train][INFO] - Averaged Result Metrics:
| Metric               |     Mean |   Std |   Count |
|----------------------|----------|-------|---------|
| test_classifier_loss | 0.459078 |     0 |       1 |
| test_accuracy        | 0.8669   |     0 |       1 |
| test_error           | 0.1331   |     0 |       1 |
| test_f1              | 0.866595 |     0 |       1 |
| test_precision       | 0.866496 |     0 |       1 |
| test_recall          | 0.8669   |     0 |       1 |
| test_loss            | 0.459078 |     0 |       1 |
[2024-05-16 18:49:15,135][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 0.480742 |     0 |       1 |
| val_accuracy        | 0.869    |     0 |       1 |
| val_error           | 0.131    |     0 |       1 |
| val_f1              | 0.868118 |     0 |       1 |
| val_precision       | 0.868195 |     0 |       1 |
| val_recall          | 0.868469 |     0 |       1 |
| val_loss            | 0.480742 |     0 |       1 |
