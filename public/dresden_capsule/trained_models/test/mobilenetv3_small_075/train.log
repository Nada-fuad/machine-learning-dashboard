[2024-05-17 10:22:14,314][hannah.utils.utils][INFO] - Environment info:
[2024-05-17 10:22:14,402][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-17 10:22:14,403][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-17 10:22:14,405][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-17 10:22:14,405][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-17 10:22:14,406][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-17 10:22:14,406][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-17 10:22:14,406][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-17 10:22:14,406][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-17 10:22:14,406][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-17 10:22:14,407][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-17 10:22:14,407][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data
[2024-05-17 10:22:14,407][hannah.utils.utils][INFO] -   
[2024-05-17 10:22:14,408][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-17 10:22:14,410][root][INFO] - Configuration: 
[2024-05-17 10:22:14,413][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
    pattern:
    - 1
    - 1
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: true
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
  enable_model_summary: false
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-17 10:22:14,413][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-17 10:22:14,943][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-17 10:22:14,943][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-17 10:22:15,027][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-17 10:22:15,027][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-17 10:22:15,027][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-17 10:22:15,028][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-17 10:22:15,028][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-17 10:22:15,028][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-17 10:22:15,028][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-17 10:22:15,028][root][INFO] - Starting training
[2024-05-17 10:22:30,317][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:66: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-17 10:22:30,317][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-17 10:22:30,317][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 29975
[2024-05-17 10:22:30,317][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-17 10:22:30,317][hannah.modules.vision.base][INFO] -   Dev Set: 6737
[2024-05-17 10:22:30,318][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-17 10:22:30,335][hannah.modules.vision.base][INFO] - Setting up model mobilenetv3_small_075
[2024-05-17 10:22:30,446][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:803: UserWarning: Overwriting focalnet_tiny_srf in registry with hannah.models._vendor.focalnet.focalnet_tiny_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-17 10:22:30,447][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:824: UserWarning: Overwriting focalnet_small_srf in registry with hannah.models._vendor.focalnet.focalnet_small_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-17 10:22:30,447][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:843: UserWarning: Overwriting focalnet_base_srf in registry with hannah.models._vendor.focalnet.focalnet_base_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-17 10:22:30,447][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:862: UserWarning: Overwriting focalnet_tiny_lrf in registry with hannah.models._vendor.focalnet.focalnet_tiny_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-17 10:22:30,447][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:885: UserWarning: Overwriting focalnet_small_lrf in registry with hannah.models._vendor.focalnet.focalnet_small_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-17 10:22:30,447][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:906: UserWarning: Overwriting focalnet_base_lrf in registry with hannah.models._vendor.focalnet.focalnet_base_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-17 10:22:30,447][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1010: UserWarning: Overwriting focalnet_large_fl3 in registry with hannah.models._vendor.focalnet.focalnet_large_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-17 10:22:30,447][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1031: UserWarning: Overwriting focalnet_large_fl4 in registry with hannah.models._vendor.focalnet.focalnet_large_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-17 10:22:30,447][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1052: UserWarning: Overwriting focalnet_xlarge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-17 10:22:30,447][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1073: UserWarning: Overwriting focalnet_xlarge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-17 10:22:30,447][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1094: UserWarning: Overwriting focalnet_huge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-17 10:22:30,447][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1115: UserWarning: Overwriting focalnet_huge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-17 10:22:30,476][hannah.models.timm][INFO] - Using default logger for automatic stem creation
[2024-05-17 10:22:30,503][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '

[2024-05-17 10:22:30,689][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.5, 0.5, 0.5), std: (0.5, 0.5, 0.5)
[2024-05-17 10:22:30,689][hannah.modules.vision.base][WARNING] - No data augmentations have been defined, make sure that this is intentional
[2024-05-17 10:22:30,693][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-17 10:22:30,717][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-17 10:22:30,733][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-17 10:22:30,734][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-17 10:22:31,152][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-17 10:22:31,152][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-17 10:22:31,154][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-17 10:22:31,712][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-17 10:22:33,763][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-17 10:22:33,763][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-17 10:22:33,764][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-17 10:22:33,764][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-17 10:22:33,764][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-17 10:24:59,854][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 234: 'val_error' reached 0.29838 (best 0.29838), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=0-step=234.ckpt' as top 1
[2024-05-17 10:27:24,689][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 468: 'val_error' reached 0.28395 (best 0.28395), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=1-step=468.ckpt' as top 1
[2024-05-17 10:29:50,168][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 702: 'val_error' was not in top 1
[2024-05-17 10:32:14,760][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 936: 'val_error' was not in top 1
[2024-05-17 10:34:39,629][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 1170: 'val_error' reached 0.27284 (best 0.27284), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=4-step=1170.ckpt' as top 1
[2024-05-17 10:37:05,260][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 1404: 'val_error' reached 0.26352 (best 0.26352), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=5-step=1404.ckpt' as top 1
[2024-05-17 10:39:31,711][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 1638: 'val_error' reached 0.22566 (best 0.22566), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=6-step=1638.ckpt' as top 1
[2024-05-17 10:41:56,949][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 1872: 'val_error' reached 0.21665 (best 0.21665), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=7-step=1872.ckpt' as top 1
[2024-05-17 10:44:21,435][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 2106: 'val_error' was not in top 1
[2024-05-17 10:46:46,095][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 2340: 'val_error' was not in top 1
[2024-05-17 10:49:10,683][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 2574: 'val_error' was not in top 1
[2024-05-17 10:51:36,612][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 2808: 'val_error' was not in top 1
[2024-05-17 10:54:02,409][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 3042: 'val_error' was not in top 1
[2024-05-17 10:56:28,010][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 3276: 'val_error' was not in top 1
[2024-05-17 10:58:52,992][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 3510: 'val_error' was not in top 1
[2024-05-17 10:58:53,053][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer.fit` stopped: `max_epochs=15` reached.
[2024-05-17 10:58:53,246][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-17 10:58:53,249][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-17 10:58:53,250][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=7-step=1872.ckpt
[2024-05-17 10:58:53,279][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-17 10:58:53,504][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-17 10:58:53,505][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-17 10:58:53,506][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-17 10:58:53,995][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=7-step=1872.ckpt
[2024-05-17 10:58:53,998][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-17 10:59:21,373][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-17 10:59:21,373][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-17 10:59:21,375][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=7-step=1872.ckpt
[2024-05-17 10:59:21,403][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-17 10:59:21,632][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-17 10:59:21,632][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-17 10:59:21,634][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-17 10:59:22,114][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=7-step=1872.ckpt
[2024-05-17 10:59:22,117][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-17 11:22:10,006][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-17 11:22:10,007][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-17 11:22:10,007][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-17 11:22:10,007][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-17 11:22:10,007][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-17 11:22:10,439][hannah.train][INFO] - Averaged Result Metrics:
| Metric               |     Mean |   Std |   Count |
|----------------------|----------|-------|---------|
| test_classifier_loss | 0.837368 |     0 |       1 |
| test_accuracy        | 0.69579  |     0 |       1 |
| test_error           | 0.30421  |     0 |       1 |
| test_f1              | 0.416316 |     0 |       1 |
| test_precision       | 0.382608 |     0 |       1 |
| test_recall          | 0.724076 |     0 |       1 |
| test_loss            | 0.837368 |     0 |       1 |
[2024-05-17 11:22:10,450][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 0.724875 |     0 |       1 |
| val_accuracy        | 0.783353 |     0 |       1 |
| val_error           | 0.216647 |     0 |       1 |
| val_f1              | 0.702384 |     0 |       1 |
| val_precision       | 0.701633 |     0 |       1 |
| val_recall          | 0.708525 |     0 |       1 |
| val_loss            | 0.724875 |     0 |       1 |
[2024-05-22 17:37:44,110][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 17:37:44,211][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 17:37:44,212][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 17:37:44,215][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 17:37:44,215][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 17:37:44,215][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 17:37:44,215][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 17:37:44,215][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 17:37:44,215][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 17:37:44,215][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 17:37:44,216][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 17:37:44,217][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data
[2024-05-22 17:37:44,217][hannah.utils.utils][INFO] -   
[2024-05-22 17:37:44,218][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 17:37:44,226][root][INFO] - Configuration: 
[2024-05-22 17:37:44,229][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: true
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 17:37:44,229][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 17:37:44,970][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 17:37:44,970][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 17:37:45,069][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 17:37:45,069][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 17:37:45,069][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 17:37:45,069][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 17:37:45,069][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 17:37:45,069][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:37:45,069][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:37:45,069][root][INFO] - Starting training
[2024-05-22 17:38:00,138][root][ERROR] - Exception Message: 2 validation errors for InitSchema
mean.float
  Input should be a valid number [type=float_type, input_value={'name': 'naneye-m', 'resolution': [320, 320]}, input_type=DictConfig]
    For further information visit https://errors.pydantic.dev/2.7/v/float_type
mean.json-or-python[json=list[float],python=chain[is-instance[Sequence],function-wrap[sequence_validator()]]]
  Input should be an instance of Sequence [type=is_instance_of, input_value={'name': 'naneye-m', 'resolution': [320, 320]}, input_type=DictConfig]
    For further information visit https://errors.pydantic.dev/2.7/v/is_instance_of
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 949, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 94, in _call_setup_hook
    _call_lightning_module_hook(trainer, "setup", stage=fn)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 60, in setup
    data_splits: Tuple[Any] = dataset_cls.splits(self.hparams.dataset)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/dresden_capsule.py", line 115, in splits
    train_transform = transforms.get_transform(train=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/albumentations.py", line 97, in get_transform
    Normalize(mean=self.mean, std=self.std),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py", line 29, in custom_init
    config = dct["InitSchema"](**full_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 176, in __init__
    self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for InitSchema
mean.float
  Input should be a valid number [type=float_type, input_value={'name': 'naneye-m', 'resolution': [320, 320]}, input_type=DictConfig]
    For further information visit https://errors.pydantic.dev/2.7/v/float_type
mean.json-or-python[json=list[float],python=chain[is-instance[Sequence],function-wrap[sequence_validator()]]]
  Input should be an instance of Sequence [type=is_instance_of, input_value={'name': 'naneye-m', 'resolution': [320, 320]}, input_type=DictConfig]
    For further information visit https://errors.pydantic.dev/2.7/v/is_instance_of
[2024-05-22 17:39:01,619][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 17:39:01,706][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 17:39:01,707][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 17:39:01,710][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 17:39:01,710][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 17:39:01,710][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 17:39:01,710][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 17:39:01,710][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 17:39:01,710][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 17:39:01,710][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 17:39:01,712][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 17:39:01,712][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data
[2024-05-22 17:39:01,712][hannah.utils.utils][INFO] -   
[2024-05-22 17:39:01,713][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 17:39:01,714][root][INFO] - Configuration: 
[2024-05-22 17:39:01,717][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: true
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 17:39:01,718][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 17:39:02,451][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 17:39:02,451][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 17:39:02,550][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 17:39:02,550][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 17:39:02,550][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 17:39:02,550][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 17:39:02,550][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 17:39:02,550][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:39:02,550][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:39:02,550][root][INFO] - Starting training
[2024-05-22 17:39:17,675][root][ERROR] - Exception Message: 2 validation errors for InitSchema
mean.float
  Input should be a valid number [type=float_type, input_value={'name': 'naneye-m', 'resolution': [320, 320]}, input_type=DictConfig]
    For further information visit https://errors.pydantic.dev/2.7/v/float_type
mean.json-or-python[json=list[float],python=chain[is-instance[Sequence],function-wrap[sequence_validator()]]]
  Input should be an instance of Sequence [type=is_instance_of, input_value={'name': 'naneye-m', 'resolution': [320, 320]}, input_type=DictConfig]
    For further information visit https://errors.pydantic.dev/2.7/v/is_instance_of
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 949, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 94, in _call_setup_hook
    _call_lightning_module_hook(trainer, "setup", stage=fn)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 60, in setup
    data_splits: Tuple[Any] = dataset_cls.splits(self.hparams.dataset)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/dresden_capsule.py", line 115, in splits
    train_transform = transforms.get_transform(train=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/albumentations.py", line 97, in get_transform
    Normalize(mean=self.mean, std=self.std),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py", line 29, in custom_init
    config = dct["InitSchema"](**full_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 176, in __init__
    self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for InitSchema
mean.float
  Input should be a valid number [type=float_type, input_value={'name': 'naneye-m', 'resolution': [320, 320]}, input_type=DictConfig]
    For further information visit https://errors.pydantic.dev/2.7/v/float_type
mean.json-or-python[json=list[float],python=chain[is-instance[Sequence],function-wrap[sequence_validator()]]]
  Input should be an instance of Sequence [type=is_instance_of, input_value={'name': 'naneye-m', 'resolution': [320, 320]}, input_type=DictConfig]
    For further information visit https://errors.pydantic.dev/2.7/v/is_instance_of
[2024-05-22 17:40:17,069][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 17:40:17,158][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 17:40:17,158][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 17:40:17,161][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 17:40:17,161][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 17:40:17,161][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 17:40:17,161][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 17:40:17,162][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 17:40:17,162][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 17:40:17,162][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 17:40:17,163][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 17:40:17,163][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data
[2024-05-22 17:40:17,163][hannah.utils.utils][INFO] -   
[2024-05-22 17:40:17,164][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 17:40:17,165][root][INFO] - Configuration: 
[2024-05-22 17:40:17,169][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: true
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 17:40:17,169][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 17:40:17,913][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 17:40:17,913][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 17:40:18,000][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 17:40:18,000][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 17:40:18,000][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 17:40:18,000][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 17:40:18,000][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 17:40:18,000][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:40:18,001][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:40:18,001][root][INFO] - Starting training
[2024-05-22 17:40:39,419][root][ERROR] - Exception Message: 2 validation errors for InitSchema
mean.float
  Input should be a valid number [type=float_type, input_value={'name': 'naneye-m', 'resolution': [320, 320]}, input_type=DictConfig]
    For further information visit https://errors.pydantic.dev/2.7/v/float_type
mean.json-or-python[json=list[float],python=chain[is-instance[Sequence],function-wrap[sequence_validator()]]]
  Input should be an instance of Sequence [type=is_instance_of, input_value={'name': 'naneye-m', 'resolution': [320, 320]}, input_type=DictConfig]
    For further information visit https://errors.pydantic.dev/2.7/v/is_instance_of
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 949, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 94, in _call_setup_hook
    _call_lightning_module_hook(trainer, "setup", stage=fn)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 60, in setup
    data_splits: Tuple[Any] = dataset_cls.splits(self.hparams.dataset)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/dresden_capsule.py", line 117, in splits
    train_transform = transforms.get_transform(train=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/albumentations.py", line 97, in get_transform
    Normalize(mean=self.mean, std=self.std),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py", line 29, in custom_init
    config = dct["InitSchema"](**full_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 176, in __init__
    self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for InitSchema
mean.float
  Input should be a valid number [type=float_type, input_value={'name': 'naneye-m', 'resolution': [320, 320]}, input_type=DictConfig]
    For further information visit https://errors.pydantic.dev/2.7/v/float_type
mean.json-or-python[json=list[float],python=chain[is-instance[Sequence],function-wrap[sequence_validator()]]]
  Input should be an instance of Sequence [type=is_instance_of, input_value={'name': 'naneye-m', 'resolution': [320, 320]}, input_type=DictConfig]
    For further information visit https://errors.pydantic.dev/2.7/v/is_instance_of
[2024-05-22 17:40:46,088][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 17:40:46,194][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 17:40:46,195][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 17:40:46,198][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 17:40:46,198][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 17:40:46,198][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 17:40:46,198][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 17:40:46,198][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 17:40:46,198][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 17:40:46,198][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 17:40:46,200][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 17:40:46,200][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data
[2024-05-22 17:40:46,200][hannah.utils.utils][INFO] -   
[2024-05-22 17:40:46,201][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 17:40:46,202][root][INFO] - Configuration: 
[2024-05-22 17:40:46,205][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: true
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 17:40:46,205][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 17:40:46,940][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 17:40:46,940][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 17:40:47,039][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 17:40:47,040][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 17:40:47,040][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 17:40:47,040][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 17:40:47,040][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 17:40:47,040][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:40:47,040][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:40:47,040][root][INFO] - Starting training
[2024-05-22 17:41:18,534][root][ERROR] - Exception Message: 
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 949, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 94, in _call_setup_hook
    _call_lightning_module_hook(trainer, "setup", stage=fn)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 60, in setup
    data_splits: Tuple[Any] = dataset_cls.splits(self.hparams.dataset)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/dresden_capsule.py", line 116, in splits
    transforms = Albumentations(sensor=config.sensor)
                 ^^^^^^^^^^^^^^
  File "/usr/lib64/python3.11/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib64/python3.11/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
                      ^^^^^^^^^^^^^
bdb.BdbQuit
[2024-05-22 17:41:25,863][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 17:41:25,961][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 17:41:25,962][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 17:41:25,964][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 17:41:25,964][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 17:41:25,964][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 17:41:25,965][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 17:41:25,965][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 17:41:25,965][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 17:41:25,965][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 17:41:25,966][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 17:41:25,966][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data
[2024-05-22 17:41:25,966][hannah.utils.utils][INFO] -   
[2024-05-22 17:41:25,968][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 17:41:25,969][root][INFO] - Configuration: 
[2024-05-22 17:41:25,972][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: true
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 17:41:25,972][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 17:41:26,710][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 17:41:26,710][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 17:41:26,809][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 17:41:26,810][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 17:41:26,810][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 17:41:26,810][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 17:41:26,810][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 17:41:26,810][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:41:26,810][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:41:26,810][root][INFO] - Starting training
[2024-05-22 17:41:45,979][root][ERROR] - Exception Message: name 'transform' is not defined
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 949, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 94, in _call_setup_hook
    _call_lightning_module_hook(trainer, "setup", stage=fn)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 60, in setup
    data_splits: Tuple[Any] = dataset_cls.splits(self.hparams.dataset)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/dresden_capsule.py", line 120, in splits
NameError: name 'transform' is not defined
[2024-05-22 17:42:04,332][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 17:42:04,421][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 17:42:04,422][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 17:42:04,425][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 17:42:04,425][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 17:42:04,425][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 17:42:04,425][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 17:42:04,425][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 17:42:04,425][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 17:42:04,425][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 17:42:04,427][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 17:42:04,427][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data
[2024-05-22 17:42:04,427][hannah.utils.utils][INFO] -   
[2024-05-22 17:42:04,428][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 17:42:04,429][root][INFO] - Configuration: 
[2024-05-22 17:42:04,432][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: true
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 17:42:04,433][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 17:42:05,187][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 17:42:05,187][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 17:42:05,286][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 17:42:05,286][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 17:42:05,286][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 17:42:05,286][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 17:42:05,286][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 17:42:05,287][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:42:05,287][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:42:05,287][root][INFO] - Starting training
[2024-05-22 17:42:20,339][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-22 17:42:20,340][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-22 17:42:20,340][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 29975
[2024-05-22 17:42:20,340][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-22 17:42:20,340][hannah.modules.vision.base][INFO] -   Dev Set: 6737
[2024-05-22 17:42:20,340][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-22 17:42:20,362][root][ERROR] - Exception Message: Key bbox is not in available keys.
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 949, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 94, in _call_setup_hook
    _call_lightning_module_hook(trainer, "setup", stage=fn)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 93, in setup
    example_data = self._decode_batch(self.test_set[0])["data"].unsqueeze(0)
                                      ~~~~~~~~~~~~~^^^
  File "/local/gerum/hannah/hannah/datasets/vision/base.py", line 107, in __getitem__
    transformed = self.transform(image=image, bbox=bbox)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 247, in __call__
    self._check_args(**data)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 316, in _check_args
    raise ValueError(msg)
ValueError: Key bbox is not in available keys.
[2024-05-22 17:43:26,395][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 17:43:26,483][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 17:43:26,484][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 17:43:26,487][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 17:43:26,487][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 17:43:26,487][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 17:43:26,487][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 17:43:26,487][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 17:43:26,487][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 17:43:26,487][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 17:43:26,489][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 17:43:26,489][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data
[2024-05-22 17:43:26,489][hannah.utils.utils][INFO] -   
[2024-05-22 17:43:26,490][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 17:43:26,491][root][INFO] - Configuration: 
[2024-05-22 17:43:26,494][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: true
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 17:43:26,494][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 17:43:27,250][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 17:43:27,250][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 17:43:27,347][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 17:43:27,347][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 17:43:27,347][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 17:43:27,347][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 17:43:27,347][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 17:43:27,348][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:43:27,348][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:43:27,348][root][INFO] - Starting training
[2024-05-22 17:43:42,448][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-22 17:43:42,448][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-22 17:43:42,448][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 29975
[2024-05-22 17:43:42,450][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-22 17:43:42,450][hannah.modules.vision.base][INFO] -   Dev Set: 6737
[2024-05-22 17:43:42,450][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-22 17:43:42,470][root][ERROR] - Exception Message: Key bbox is not in available keys.
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 949, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 94, in _call_setup_hook
    _call_lightning_module_hook(trainer, "setup", stage=fn)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 93, in setup
    example_data = self._decode_batch(self.test_set[0])["data"].unsqueeze(0)
                                      ~~~~~~~~~~~~~^^^
  File "/local/gerum/hannah/hannah/datasets/vision/base.py", line 107, in __getitem__
    transformed = self.transform(image=image, bbox=bbox)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 247, in __call__
    self._check_args(**data)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 316, in _check_args
    raise ValueError(msg)
ValueError: Key bbox is not in available keys.
[2024-05-22 17:45:22,524][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 17:45:22,618][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 17:45:22,618][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 17:45:22,621][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 17:45:22,621][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 17:45:22,621][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 17:45:22,621][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 17:45:22,621][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 17:45:22,621][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 17:45:22,621][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 17:45:22,623][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 17:45:22,623][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data
[2024-05-22 17:45:22,623][hannah.utils.utils][INFO] -   
[2024-05-22 17:45:22,624][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 17:45:22,625][root][INFO] - Configuration: 
[2024-05-22 17:45:22,628][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: true
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 17:45:22,629][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 17:45:23,351][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 17:45:23,351][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 17:45:23,449][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 17:45:23,449][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 17:45:23,449][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 17:45:23,449][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 17:45:23,449][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 17:45:23,449][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:45:23,449][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:45:23,449][root][INFO] - Starting training
[2024-05-22 17:45:24,485][root][ERROR] - Exception Message: Error tokenizing data. C error: Calling read(nbytes) on source failed. Try engine='python'.
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 949, in _run
    call._call_setup_hook(self)  # allow user to set up LightningModule in accelerator environment
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 94, in _call_setup_hook
    _call_lightning_module_hook(trainer, "setup", stage=fn)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/modules/vision/base.py", line 60, in setup
    data_splits: Tuple[Any] = dataset_cls.splits(self.hparams.dataset)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/dresden_capsule.py", line 102, in splits
    train_data = pd.read_csv(split_folder / config.split / "train.csv")
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/pandas/util/_decorators.py", line 211, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/pandas/util/_decorators.py", line 331, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/pandas/io/parsers/readers.py", line 950, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/pandas/io/parsers/readers.py", line 611, in _read
    return parser.read(nrows)
           ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/pandas/io/parsers/readers.py", line 1778, in read
    ) = self._engine.read(  # type: ignore[attr-defined]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 230, in read
    chunks = self._reader.read_low_memory(nrows)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/parsers.pyx", line 808, in pandas._libs.parsers.TextReader.read_low_memory
  File "pandas/_libs/parsers.pyx", line 866, in pandas._libs.parsers.TextReader._read_rows
  File "pandas/_libs/parsers.pyx", line 852, in pandas._libs.parsers.TextReader._tokenize_rows
  File "pandas/_libs/parsers.pyx", line 1973, in pandas._libs.parsers.raise_parser_error
pandas.errors.ParserError: Error tokenizing data. C error: Calling read(nbytes) on source failed. Try engine='python'.
[2024-05-22 17:45:43,263][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 17:45:43,362][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 17:45:43,363][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 17:45:43,365][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 17:45:43,365][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 17:45:43,366][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 17:45:43,366][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 17:45:43,366][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 17:45:43,366][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 17:45:43,366][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 17:45:43,367][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 17:45:43,367][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data
[2024-05-22 17:45:43,367][hannah.utils.utils][INFO] -   
[2024-05-22 17:45:43,368][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 17:45:43,370][root][INFO] - Configuration: 
[2024-05-22 17:45:43,373][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: true
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 17:45:43,373][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 17:45:44,196][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 17:45:44,196][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 17:45:44,282][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 17:45:44,282][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 17:45:44,282][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 17:45:44,282][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 17:45:44,282][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 17:45:44,282][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:45:44,282][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:45:44,282][root][INFO] - Starting training
[2024-05-22 17:45:59,568][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-22 17:45:59,569][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-22 17:45:59,569][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 29975
[2024-05-22 17:45:59,569][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-22 17:45:59,569][hannah.modules.vision.base][INFO] -   Dev Set: 6737
[2024-05-22 17:45:59,569][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-22 17:45:59,586][hannah.modules.vision.base][INFO] - Setting up model mobilenetv3_small_075
[2024-05-22 17:45:59,740][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:803: UserWarning: Overwriting focalnet_tiny_srf in registry with hannah.models._vendor.focalnet.focalnet_tiny_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:45:59,740][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:824: UserWarning: Overwriting focalnet_small_srf in registry with hannah.models._vendor.focalnet.focalnet_small_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:45:59,740][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:843: UserWarning: Overwriting focalnet_base_srf in registry with hannah.models._vendor.focalnet.focalnet_base_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:45:59,740][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:862: UserWarning: Overwriting focalnet_tiny_lrf in registry with hannah.models._vendor.focalnet.focalnet_tiny_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:45:59,741][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:885: UserWarning: Overwriting focalnet_small_lrf in registry with hannah.models._vendor.focalnet.focalnet_small_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:45:59,741][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:906: UserWarning: Overwriting focalnet_base_lrf in registry with hannah.models._vendor.focalnet.focalnet_base_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:45:59,741][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1010: UserWarning: Overwriting focalnet_large_fl3 in registry with hannah.models._vendor.focalnet.focalnet_large_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:45:59,741][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1031: UserWarning: Overwriting focalnet_large_fl4 in registry with hannah.models._vendor.focalnet.focalnet_large_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:45:59,741][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1052: UserWarning: Overwriting focalnet_xlarge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:45:59,741][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1073: UserWarning: Overwriting focalnet_xlarge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:45:59,741][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1094: UserWarning: Overwriting focalnet_huge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:45:59,741][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1115: UserWarning: Overwriting focalnet_huge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:45:59,764][hannah.models.timm][INFO] - Using default logger for automatic stem creation
[2024-05-22 17:45:59,792][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '

[2024-05-22 17:45:59,985][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.5, 0.5, 0.5), std: (0.5, 0.5, 0.5)
[2024-05-22 17:45:59,989][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-22 17:46:00,014][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-22 17:46:00,028][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-22 17:46:00,029][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-22 17:46:00,228][pytorch_lightning.callbacks.model_summary][INFO] - 
  | Name           | Type                           | Params | In sizes         | Out sizes                            
-----------------------------------------------------------------------------------------------------------------------------
0 | val_metrics    | MetricCollection               | 0      | ?                | ?                                    
1 | test_metrics   | MetricCollection               | 0      | ?                | ?                                    
2 | train_metrics  | MetricCollection               | 0      | ?                | ?                                    
3 | model          | TimmModel                      | 1.0 M  | [1, 3, 320, 320] | [[1, 1024, 10, 10], [0], [0], [1, 5]]
4 | test_confusion | MulticlassConfusionMatrix      | 0      | ?                | ?                                    
5 | test_roc       | MulticlassROC                  | 0      | ?                | ?                                    
6 | test_pr_curve  | MulticlassPrecisionRecallCurve | 0      | ?                | ?                                    
7 | metrics        | ModuleDict                     | 0      | ?                | ?                                    
-----------------------------------------------------------------------------------------------------------------------------
1.0 M     Trainable params
0         Non-trainable params
1.0 M     Total params
4.088     Total estimated model params size (MB)
[2024-05-22 17:46:00,499][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-22 17:46:00,500][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-22 17:46:00,501][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-22 17:46:01,044][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-22 17:46:03,002][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-22 17:46:20,199][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-22 17:46:20,199][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-22 17:46:20,199][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-22 17:46:20,199][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-22 17:46:20,229][root][ERROR] - Exception Message: [Errno 32] Broken pipe
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
    self.fit_loop.run()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 201, in run
    self.on_run_start()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 327, in on_run_start
    call._call_callback_hooks(trainer, "on_train_start")
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 208, in _call_callback_hooks
    fn(trainer, trainer.lightning_module, *args, **kwargs)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/callbacks/progress/tqdm_progress.py", line 261, in on_train_start
    self.train_progress_bar = self.init_train_tqdm()
                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/callbacks/progress/tqdm_progress.py", line 199, in init_train_tqdm
    return Tqdm(
           ^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/callbacks/progress/tqdm_progress.py", line 44, in __init__
    super().__init__(*args, **kwargs)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/tqdm/asyncio.py", line 24, in __init__
    super().__init__(iterable, *args, **kwargs)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/tqdm/std.py", line 1098, in __init__
    self.refresh(lock_args=self.lock_args)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/tqdm/std.py", line 1347, in refresh
    self.display()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/tqdm/std.py", line 1495, in display
    self.sp(self.__str__() if msg is None else msg)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/tqdm/std.py", line 459, in print_status
    fp_write('\r' + s + (' ' * max(last_len[0] - len_s, 0)))
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/tqdm/std.py", line 452, in fp_write
    fp.write(str(s))
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/tqdm/utils.py", line 196, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/colorama/ansitowin32.py", line 47, in write
    self.__convertor.write(text)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/colorama/ansitowin32.py", line 177, in write
    self.write_and_convert(text)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/colorama/ansitowin32.py", line 205, in write_and_convert
    self.write_plain_text(text, cursor, len(text))
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/colorama/ansitowin32.py", line 210, in write_plain_text
    self.wrapped.write(text[start:end])
BrokenPipeError: [Errno 32] Broken pipe
[2024-05-22 17:46:29,923][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 17:46:30,016][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 17:46:30,016][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 17:46:30,019][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 17:46:30,019][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 17:46:30,019][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 17:46:30,019][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 17:46:30,020][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 17:46:30,020][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 17:46:30,020][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 17:46:30,021][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 17:46:30,021][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data
[2024-05-22 17:46:30,021][hannah.utils.utils][INFO] -   
[2024-05-22 17:46:30,022][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 17:46:30,024][root][INFO] - Configuration: 
[2024-05-22 17:46:30,027][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: true
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 0
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 17:46:30,027][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 17:46:30,762][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 17:46:30,762][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 17:46:30,862][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 17:46:30,862][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 17:46:30,862][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 17:46:30,862][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 17:46:30,862][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 17:46:30,862][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:46:30,862][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:46:30,862][root][INFO] - Starting training
[2024-05-22 17:46:45,899][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_widht' is not valid and will be ignored.
  warn(

[2024-05-22 17:46:45,899][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_heigh' is not valid and will be ignored.
  warn(

[2024-05-22 17:46:45,945][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-22 17:46:45,945][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-22 17:46:45,945][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 29975
[2024-05-22 17:46:45,945][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-22 17:46:45,945][hannah.modules.vision.base][INFO] -   Dev Set: 6737
[2024-05-22 17:46:45,945][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-22 17:46:45,963][hannah.modules.vision.base][INFO] - Setting up model mobilenetv3_small_075
[2024-05-22 17:46:46,120][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:803: UserWarning: Overwriting focalnet_tiny_srf in registry with hannah.models._vendor.focalnet.focalnet_tiny_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:46:46,120][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:824: UserWarning: Overwriting focalnet_small_srf in registry with hannah.models._vendor.focalnet.focalnet_small_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:46:46,120][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:843: UserWarning: Overwriting focalnet_base_srf in registry with hannah.models._vendor.focalnet.focalnet_base_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:46:46,120][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:862: UserWarning: Overwriting focalnet_tiny_lrf in registry with hannah.models._vendor.focalnet.focalnet_tiny_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:46:46,120][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:885: UserWarning: Overwriting focalnet_small_lrf in registry with hannah.models._vendor.focalnet.focalnet_small_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:46:46,121][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:906: UserWarning: Overwriting focalnet_base_lrf in registry with hannah.models._vendor.focalnet.focalnet_base_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:46:46,121][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1010: UserWarning: Overwriting focalnet_large_fl3 in registry with hannah.models._vendor.focalnet.focalnet_large_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:46:46,121][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1031: UserWarning: Overwriting focalnet_large_fl4 in registry with hannah.models._vendor.focalnet.focalnet_large_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:46:46,121][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1052: UserWarning: Overwriting focalnet_xlarge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:46:46,121][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1073: UserWarning: Overwriting focalnet_xlarge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:46:46,121][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1094: UserWarning: Overwriting focalnet_huge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:46:46,121][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1115: UserWarning: Overwriting focalnet_huge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:46:46,144][hannah.models.timm][INFO] - Using default logger for automatic stem creation
[2024-05-22 17:46:46,172][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '

[2024-05-22 17:46:46,367][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.5, 0.5, 0.5), std: (0.5, 0.5, 0.5)
[2024-05-22 17:46:46,371][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-22 17:46:46,396][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-22 17:46:46,410][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-22 17:46:46,411][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-22 17:46:46,609][pytorch_lightning.callbacks.model_summary][INFO] - 
  | Name           | Type                           | Params | In sizes         | Out sizes                            
-----------------------------------------------------------------------------------------------------------------------------
0 | val_metrics    | MetricCollection               | 0      | ?                | ?                                    
1 | test_metrics   | MetricCollection               | 0      | ?                | ?                                    
2 | train_metrics  | MetricCollection               | 0      | ?                | ?                                    
3 | model          | TimmModel                      | 1.0 M  | [1, 3, 320, 320] | [[1, 1024, 10, 10], [0], [0], [1, 5]]
4 | test_confusion | MulticlassConfusionMatrix      | 0      | ?                | ?                                    
5 | test_roc       | MulticlassROC                  | 0      | ?                | ?                                    
6 | test_pr_curve  | MulticlassPrecisionRecallCurve | 0      | ?                | ?                                    
7 | metrics        | ModuleDict                     | 0      | ?                | ?                                    
-----------------------------------------------------------------------------------------------------------------------------
1.0 M     Trainable params
0         Non-trainable params
1.0 M     Total params
4.088     Total estimated model params size (MB)
[2024-05-22 17:46:46,836][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-22 17:46:46,836][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-22 17:46:46,838][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-22 17:46:47,380][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=191` in the `DataLoader` to improve performance.

[2024-05-22 17:46:49,368][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-22 17:46:49,369][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-22 17:46:49,369][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-22 17:46:49,369][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-22 17:46:49,369][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-22 17:47:04,887][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-22 17:47:04,894][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 17:47:04,895][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-22 17:47:04,944][root][ERROR] - Exception Message: `.validate(ckpt_path="best")` is set but `ModelCheckpoint` is not configured to save the best model.
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 183, in train
    lit_trainer.validate(ckpt_path=ckpt_path, verbose=validate_output)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 645, in validate
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 682, in _validate_impl
    ckpt_path = self._checkpoint_connector._select_ckpt_path(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py", line 104, in _select_ckpt_path
    ckpt_path = self._parse_ckpt_path(
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py", line 171, in _parse_ckpt_path
    raise ValueError(
ValueError: `.validate(ckpt_path="best")` is set but `ModelCheckpoint` is not configured to save the best model.
[2024-05-22 17:47:20,762][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 17:47:20,850][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 17:47:20,850][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 17:47:20,853][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 17:47:20,853][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 17:47:20,853][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 17:47:20,853][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 17:47:20,854][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 17:47:20,854][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 17:47:20,854][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 17:47:20,855][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 17:47:20,855][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data module.num_workers=32
[2024-05-22 17:47:20,855][hannah.utils.utils][INFO] -   
[2024-05-22 17:47:20,856][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 17:47:20,858][root][INFO] - Configuration: 
[2024-05-22 17:47:20,861][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: true
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 32
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 17:47:20,861][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 17:47:21,587][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 17:47:21,587][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 17:47:21,687][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 17:47:21,687][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 17:47:21,687][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 17:47:21,687][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 17:47:21,687][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 17:47:21,687][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:47:21,687][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 17:47:21,687][root][INFO] - Starting training
[2024-05-22 17:47:36,712][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_widht' is not valid and will be ignored.
  warn(

[2024-05-22 17:47:36,712][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_heigh' is not valid and will be ignored.
  warn(

[2024-05-22 17:47:36,757][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-22 17:47:36,757][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-22 17:47:36,757][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 29975
[2024-05-22 17:47:36,758][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-22 17:47:36,758][hannah.modules.vision.base][INFO] -   Dev Set: 6737
[2024-05-22 17:47:36,758][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-22 17:47:36,775][hannah.modules.vision.base][INFO] - Setting up model mobilenetv3_small_075
[2024-05-22 17:47:36,932][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:803: UserWarning: Overwriting focalnet_tiny_srf in registry with hannah.models._vendor.focalnet.focalnet_tiny_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:47:36,932][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:824: UserWarning: Overwriting focalnet_small_srf in registry with hannah.models._vendor.focalnet.focalnet_small_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:47:36,932][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:843: UserWarning: Overwriting focalnet_base_srf in registry with hannah.models._vendor.focalnet.focalnet_base_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:47:36,932][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:862: UserWarning: Overwriting focalnet_tiny_lrf in registry with hannah.models._vendor.focalnet.focalnet_tiny_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:47:36,932][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:885: UserWarning: Overwriting focalnet_small_lrf in registry with hannah.models._vendor.focalnet.focalnet_small_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:47:36,932][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:906: UserWarning: Overwriting focalnet_base_lrf in registry with hannah.models._vendor.focalnet.focalnet_base_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:47:36,932][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1010: UserWarning: Overwriting focalnet_large_fl3 in registry with hannah.models._vendor.focalnet.focalnet_large_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:47:36,932][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1031: UserWarning: Overwriting focalnet_large_fl4 in registry with hannah.models._vendor.focalnet.focalnet_large_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:47:36,932][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1052: UserWarning: Overwriting focalnet_xlarge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:47:36,932][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1073: UserWarning: Overwriting focalnet_xlarge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:47:36,933][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1094: UserWarning: Overwriting focalnet_huge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:47:36,933][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1115: UserWarning: Overwriting focalnet_huge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 17:47:36,956][hannah.models.timm][INFO] - Using default logger for automatic stem creation
[2024-05-22 17:47:36,985][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '

[2024-05-22 17:47:37,164][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.5, 0.5, 0.5), std: (0.5, 0.5, 0.5)
[2024-05-22 17:47:37,169][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-22 17:47:37,193][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-22 17:47:37,208][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-22 17:47:38,257][pytorch_lightning.callbacks.model_summary][INFO] - 
  | Name           | Type                           | Params | In sizes         | Out sizes                            
-----------------------------------------------------------------------------------------------------------------------------
0 | val_metrics    | MetricCollection               | 0      | ?                | ?                                    
1 | test_metrics   | MetricCollection               | 0      | ?                | ?                                    
2 | train_metrics  | MetricCollection               | 0      | ?                | ?                                    
3 | model          | TimmModel                      | 1.0 M  | [1, 3, 320, 320] | [[1, 1024, 10, 10], [0], [0], [1, 5]]
4 | test_confusion | MulticlassConfusionMatrix      | 0      | ?                | ?                                    
5 | test_roc       | MulticlassROC                  | 0      | ?                | ?                                    
6 | test_pr_curve  | MulticlassPrecisionRecallCurve | 0      | ?                | ?                                    
7 | metrics        | ModuleDict                     | 0      | ?                | ?                                    
-----------------------------------------------------------------------------------------------------------------------------
1.0 M     Trainable params
0         Non-trainable params
1.0 M     Total params
4.088     Total estimated model params size (MB)
[2024-05-22 17:47:38,514][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-22 17:47:38,514][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-22 17:47:38,516][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-22 17:47:49,281][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-22 17:47:49,283][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-22 17:47:49,283][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-22 17:47:49,283][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-22 17:47:49,283][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-22 17:48:12,005][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 234: 'val_error' reached 0.34180 (best 0.34180), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=0-step=234.ckpt' as top 1
[2024-05-22 17:48:34,117][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 468: 'val_error' reached 0.32903 (best 0.32903), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=1-step=468.ckpt' as top 1
[2024-05-22 17:48:56,035][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 702: 'val_error' reached 0.28696 (best 0.28696), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=2-step=702.ckpt' as top 1
[2024-05-22 17:49:17,764][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 936: 'val_error' was not in top 1
[2024-05-22 17:49:39,453][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 1170: 'val_error' was not in top 1
[2024-05-22 17:50:01,258][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 1404: 'val_error' reached 0.27479 (best 0.27479), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=5-step=1404.ckpt' as top 1
[2024-05-22 17:50:22,918][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 1638: 'val_error' reached 0.26187 (best 0.26187), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=6-step=1638.ckpt' as top 1
[2024-05-22 17:50:44,727][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 1872: 'val_error' was not in top 1
[2024-05-22 17:51:06,536][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 2106: 'val_error' reached 0.23347 (best 0.23347), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=8-step=2106.ckpt' as top 1
[2024-05-22 17:51:28,310][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 2340: 'val_error' was not in top 1
[2024-05-22 17:51:50,009][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 2574: 'val_error' was not in top 1
[2024-05-22 17:52:11,586][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 2808: 'val_error' was not in top 1
[2024-05-22 17:52:33,408][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 3042: 'val_error' reached 0.22806 (best 0.22806), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=12-step=3042.ckpt' as top 1
[2024-05-22 17:52:54,866][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 3276: 'val_error' was not in top 1
[2024-05-22 17:53:16,311][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 3510: 'val_error' was not in top 1
[2024-05-22 17:53:16,355][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer.fit` stopped: `max_epochs=15` reached.
[2024-05-22 17:53:16,865][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 17:53:16,865][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-22 17:53:16,867][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=12-step=3042.ckpt
[2024-05-22 17:53:16,897][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-22 17:53:17,130][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-22 17:53:17,131][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-22 17:53:17,132][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-22 17:53:17,629][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=12-step=3042.ckpt
[2024-05-22 17:53:23,034][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 17:53:23,035][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-22 17:53:23,036][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=12-step=3042.ckpt
[2024-05-22 17:53:23,069][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-22 17:53:23,304][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-22 17:53:23,304][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-22 17:53:23,306][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-22 17:53:23,809][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=12-step=3042.ckpt
[2024-05-22 17:55:18,341][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-22 17:55:18,342][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-22 17:55:18,342][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-22 17:55:18,342][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-22 17:55:18,342][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-22 17:55:18,990][hannah.train][INFO] - Averaged Result Metrics:
| Metric               |     Mean |   Std |   Count |
|----------------------|----------|-------|---------|
| test_classifier_loss | 0.791142 |     0 |       1 |
| test_accuracy        | 0.723607 |     0 |       1 |
| test_error           | 0.276393 |     0 |       1 |
| test_f1              | 0.450662 |     0 |       1 |
| test_precision       | 0.409652 |     0 |       1 |
| test_recall          | 0.742952 |     0 |       1 |
| test_loss            | 0.791142 |     0 |       1 |
[2024-05-22 17:55:19,002][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 0.726594 |     0 |       1 |
| val_accuracy        | 0.771935 |     0 |       1 |
| val_error           | 0.228065 |     0 |       1 |
| val_f1              | 0.692029 |     0 |       1 |
| val_precision       | 0.691066 |     0 |       1 |
| val_recall          | 0.705371 |     0 |       1 |
| val_loss            | 0.726594 |     0 |       1 |
[2024-05-22 18:03:36,647][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 18:03:36,739][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 18:03:36,740][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 18:03:36,743][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 18:03:36,743][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 18:03:36,743][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 18:03:36,743][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 18:03:36,743][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 18:03:36,744][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 18:03:36,744][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 18:03:36,745][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 18:03:36,745][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data module.num_workers=64 trainer.max_epochs=100 module.batch_size=128
[2024-05-22 18:03:36,745][hannah.utils.utils][INFO] -   
[2024-05-22 18:03:36,746][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 18:03:36,755][root][INFO] - Configuration: 
[2024-05-22 18:03:36,758][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: true
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 64
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 100
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 18:03:36,758][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 18:03:37,485][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 18:03:37,485][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 18:03:37,585][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 18:03:37,585][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 18:03:37,585][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 18:03:37,585][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 18:03:37,585][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 18:03:37,585][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 18:03:37,585][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 18:03:37,586][root][INFO] - Starting training
[2024-05-22 18:03:52,447][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_widht' is not valid and will be ignored.
  warn(

[2024-05-22 18:03:52,447][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_heigh' is not valid and will be ignored.
  warn(

[2024-05-22 18:03:52,493][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-22 18:03:52,493][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-22 18:03:52,493][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 29975
[2024-05-22 18:03:52,493][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-22 18:03:52,493][hannah.modules.vision.base][INFO] -   Dev Set: 6737
[2024-05-22 18:03:52,493][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-22 18:03:52,511][hannah.modules.vision.base][INFO] - Setting up model mobilenetv3_small_075
[2024-05-22 18:03:52,665][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:803: UserWarning: Overwriting focalnet_tiny_srf in registry with hannah.models._vendor.focalnet.focalnet_tiny_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:03:52,665][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:824: UserWarning: Overwriting focalnet_small_srf in registry with hannah.models._vendor.focalnet.focalnet_small_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:03:52,666][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:843: UserWarning: Overwriting focalnet_base_srf in registry with hannah.models._vendor.focalnet.focalnet_base_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:03:52,666][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:862: UserWarning: Overwriting focalnet_tiny_lrf in registry with hannah.models._vendor.focalnet.focalnet_tiny_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:03:52,666][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:885: UserWarning: Overwriting focalnet_small_lrf in registry with hannah.models._vendor.focalnet.focalnet_small_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:03:52,666][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:906: UserWarning: Overwriting focalnet_base_lrf in registry with hannah.models._vendor.focalnet.focalnet_base_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:03:52,666][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1010: UserWarning: Overwriting focalnet_large_fl3 in registry with hannah.models._vendor.focalnet.focalnet_large_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:03:52,666][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1031: UserWarning: Overwriting focalnet_large_fl4 in registry with hannah.models._vendor.focalnet.focalnet_large_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:03:52,666][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1052: UserWarning: Overwriting focalnet_xlarge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:03:52,666][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1073: UserWarning: Overwriting focalnet_xlarge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:03:52,666][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1094: UserWarning: Overwriting focalnet_huge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:03:52,666][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1115: UserWarning: Overwriting focalnet_huge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:03:52,689][hannah.models.timm][INFO] - Using default logger for automatic stem creation
[2024-05-22 18:03:52,717][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '

[2024-05-22 18:03:52,896][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.5, 0.5, 0.5), std: (0.5, 0.5, 0.5)
[2024-05-22 18:03:52,901][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-22 18:03:52,925][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-22 18:03:52,939][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-22 18:03:54,895][pytorch_lightning.callbacks.model_summary][INFO] - 
  | Name           | Type                           | Params | In sizes         | Out sizes                            
-----------------------------------------------------------------------------------------------------------------------------
0 | val_metrics    | MetricCollection               | 0      | ?                | ?                                    
1 | test_metrics   | MetricCollection               | 0      | ?                | ?                                    
2 | train_metrics  | MetricCollection               | 0      | ?                | ?                                    
3 | model          | TimmModel                      | 1.0 M  | [1, 3, 320, 320] | [[1, 1024, 10, 10], [0], [0], [1, 5]]
4 | test_confusion | MulticlassConfusionMatrix      | 0      | ?                | ?                                    
5 | test_roc       | MulticlassROC                  | 0      | ?                | ?                                    
6 | test_pr_curve  | MulticlassPrecisionRecallCurve | 0      | ?                | ?                                    
7 | metrics        | ModuleDict                     | 0      | ?                | ?                                    
-----------------------------------------------------------------------------------------------------------------------------
1.0 M     Trainable params
0         Non-trainable params
1.0 M     Total params
4.088     Total estimated model params size (MB)
[2024-05-22 18:03:55,189][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-22 18:03:55,190][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-22 18:03:55,193][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-22 18:04:16,268][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-22 18:04:16,269][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-22 18:04:16,269][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-22 18:04:16,269][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-22 18:04:16,269][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-22 18:04:36,179][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 234: 'val_error' reached 0.36403 (best 0.36403), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=0-step=234.ckpt' as top 1
[2024-05-22 18:05:03,093][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 468: 'val_error' reached 0.31896 (best 0.31896), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=1-step=468.ckpt' as top 1
[2024-05-22 18:05:29,395][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 702: 'val_error' reached 0.31430 (best 0.31430), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=2-step=702.ckpt' as top 1
[2024-05-22 18:05:55,355][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 936: 'val_error' reached 0.30198 (best 0.30198), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=3-step=936.ckpt' as top 1
[2024-05-22 18:05:58,802][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-22 18:05:58,820][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 18:05:58,825][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-22 18:05:58,834][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=3-step=936.ckpt
[2024-05-22 18:05:58,929][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-22 18:05:59,370][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 18:05:59,371][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-22 18:05:59,373][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=3-step=936.ckpt
[2024-05-22 18:05:59,427][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 0.740471 |     0 |       1 |
| val_accuracy        | 0.698017 |     0 |       1 |
| val_error           | 0.301983 |     0 |       1 |
| val_f1              | 0.577533 |     0 |       1 |
| val_precision       | 0.571691 |     0 |       1 |
| val_recall          | 0.588604 |     0 |       1 |
| val_loss            | 0.740471 |     0 |       1 |
[2024-05-22 18:06:31,946][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 18:06:32,032][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 18:06:32,032][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 18:06:32,036][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 18:06:32,036][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 18:06:32,036][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 18:06:32,036][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 18:06:32,036][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 18:06:32,036][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 18:06:32,036][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 18:06:32,038][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 18:06:32,038][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data module.num_workers=64 trainer.max_epochs=100 module.batch_size=128 dataset.downsampling.enabled=False
[2024-05-22 18:06:32,038][hannah.utils.utils][INFO] -   
[2024-05-22 18:06:32,039][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 18:06:32,045][root][INFO] - Configuration: 
[2024-05-22 18:06:32,048][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: false
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 64
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 100
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 18:06:32,049][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 18:06:32,811][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 18:06:32,811][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 18:06:32,908][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 18:06:32,909][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 18:06:32,909][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 18:06:32,909][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 18:06:32,909][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 18:06:32,909][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 18:06:32,909][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 18:06:32,909][root][INFO] - Starting training
[2024-05-22 18:06:45,149][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_widht' is not valid and will be ignored.
  warn(

[2024-05-22 18:06:45,149][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_heigh' is not valid and will be ignored.
  warn(

[2024-05-22 18:06:45,196][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-22 18:06:45,197][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-22 18:06:45,197][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 2616647
[2024-05-22 18:06:45,197][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-22 18:06:45,197][hannah.modules.vision.base][INFO] -   Dev Set: 662338
[2024-05-22 18:06:45,197][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-22 18:06:45,215][hannah.modules.vision.base][INFO] - Setting up model mobilenetv3_small_075
[2024-05-22 18:06:45,373][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:803: UserWarning: Overwriting focalnet_tiny_srf in registry with hannah.models._vendor.focalnet.focalnet_tiny_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:06:45,373][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:824: UserWarning: Overwriting focalnet_small_srf in registry with hannah.models._vendor.focalnet.focalnet_small_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:06:45,373][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:843: UserWarning: Overwriting focalnet_base_srf in registry with hannah.models._vendor.focalnet.focalnet_base_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:06:45,373][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:862: UserWarning: Overwriting focalnet_tiny_lrf in registry with hannah.models._vendor.focalnet.focalnet_tiny_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:06:45,374][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:885: UserWarning: Overwriting focalnet_small_lrf in registry with hannah.models._vendor.focalnet.focalnet_small_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:06:45,374][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:906: UserWarning: Overwriting focalnet_base_lrf in registry with hannah.models._vendor.focalnet.focalnet_base_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:06:45,374][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1010: UserWarning: Overwriting focalnet_large_fl3 in registry with hannah.models._vendor.focalnet.focalnet_large_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:06:45,374][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1031: UserWarning: Overwriting focalnet_large_fl4 in registry with hannah.models._vendor.focalnet.focalnet_large_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:06:45,374][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1052: UserWarning: Overwriting focalnet_xlarge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:06:45,374][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1073: UserWarning: Overwriting focalnet_xlarge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:06:45,374][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1094: UserWarning: Overwriting focalnet_huge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:06:45,374][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1115: UserWarning: Overwriting focalnet_huge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:06:45,398][hannah.models.timm][INFO] - Using default logger for automatic stem creation
[2024-05-22 18:06:45,426][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '

[2024-05-22 18:06:45,609][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.5, 0.5, 0.5), std: (0.5, 0.5, 0.5)
[2024-05-22 18:06:45,614][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-22 18:06:45,638][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-22 18:06:45,653][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-22 18:06:47,816][pytorch_lightning.callbacks.model_summary][INFO] - 
  | Name           | Type                           | Params | In sizes         | Out sizes                            
-----------------------------------------------------------------------------------------------------------------------------
0 | val_metrics    | MetricCollection               | 0      | ?                | ?                                    
1 | test_metrics   | MetricCollection               | 0      | ?                | ?                                    
2 | train_metrics  | MetricCollection               | 0      | ?                | ?                                    
3 | model          | TimmModel                      | 1.0 M  | [1, 3, 320, 320] | [[1, 1024, 10, 10], [0], [0], [1, 5]]
4 | test_confusion | MulticlassConfusionMatrix      | 0      | ?                | ?                                    
5 | test_roc       | MulticlassROC                  | 0      | ?                | ?                                    
6 | test_pr_curve  | MulticlassPrecisionRecallCurve | 0      | ?                | ?                                    
7 | metrics        | ModuleDict                     | 0      | ?                | ?                                    
-----------------------------------------------------------------------------------------------------------------------------
1.0 M     Trainable params
0         Non-trainable params
1.0 M     Total params
4.088     Total estimated model params size (MB)
[2024-05-22 18:06:48,158][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-22 18:06:48,158][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-22 18:06:48,161][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-22 18:06:59,689][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-22 18:06:59,691][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-22 18:06:59,691][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-22 18:06:59,691][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-22 18:06:59,691][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-22 18:48:41,198][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 20442: 'val_error' reached 0.22225 (best 0.22225), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=0-step=20442.ckpt' as top 1
[2024-05-22 18:59:04,230][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-22 18:59:04,241][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 18:59:04,243][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-22 18:59:04,248][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=0-step=20442.ckpt
[2024-05-22 18:59:04,372][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-22 18:59:04,679][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-22 18:59:04,680][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-22 18:59:04,682][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-22 18:59:04,720][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 18:59:04,721][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-22 18:59:04,722][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=0-step=20442.ckpt
[2024-05-22 18:59:04,815][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 0.633402 |     0 |       1 |
| val_accuracy        | 0.777754 |     0 |       1 |
| val_error           | 0.222246 |     0 |       1 |
| val_f1              | 0.480053 |     0 |       1 |
| val_precision       | 0.46116  |     0 |       1 |
| val_recall          | 0.523246 |     0 |       1 |
| val_loss            | 0.633402 |     0 |       1 |
[2024-05-22 18:59:41,417][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 18:59:41,503][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 18:59:41,504][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 18:59:41,507][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 18:59:41,507][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 18:59:41,507][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 18:59:41,508][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 18:59:41,508][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 18:59:41,508][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 18:59:41,508][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 18:59:41,509][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 18:59:41,509][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data module.num_workers=64 trainer.max_epochs=100 module.batch_size=512 dataset.downsampling.enabled=False
[2024-05-22 18:59:41,509][hannah.utils.utils][INFO] -   
[2024-05-22 18:59:41,510][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 18:59:41,516][root][INFO] - Configuration: 
[2024-05-22 18:59:41,519][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: false
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 64
  batch_size: 512
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 100
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 18:59:41,520][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 18:59:42,314][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 18:59:42,314][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 18:59:42,412][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 18:59:42,412][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 18:59:42,412][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 18:59:42,412][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 18:59:42,412][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 18:59:42,412][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 18:59:42,412][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 18:59:42,413][root][INFO] - Starting training
[2024-05-22 18:59:54,490][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_widht' is not valid and will be ignored.
  warn(

[2024-05-22 18:59:54,490][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_heigh' is not valid and will be ignored.
  warn(

[2024-05-22 18:59:54,532][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-22 18:59:54,532][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-22 18:59:54,532][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 2616647
[2024-05-22 18:59:54,532][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-22 18:59:54,532][hannah.modules.vision.base][INFO] -   Dev Set: 662338
[2024-05-22 18:59:54,532][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-22 18:59:54,551][hannah.modules.vision.base][INFO] - Setting up model mobilenetv3_small_075
[2024-05-22 18:59:54,716][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:803: UserWarning: Overwriting focalnet_tiny_srf in registry with hannah.models._vendor.focalnet.focalnet_tiny_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:59:54,717][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:824: UserWarning: Overwriting focalnet_small_srf in registry with hannah.models._vendor.focalnet.focalnet_small_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:59:54,717][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:843: UserWarning: Overwriting focalnet_base_srf in registry with hannah.models._vendor.focalnet.focalnet_base_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:59:54,717][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:862: UserWarning: Overwriting focalnet_tiny_lrf in registry with hannah.models._vendor.focalnet.focalnet_tiny_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:59:54,717][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:885: UserWarning: Overwriting focalnet_small_lrf in registry with hannah.models._vendor.focalnet.focalnet_small_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:59:54,717][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:906: UserWarning: Overwriting focalnet_base_lrf in registry with hannah.models._vendor.focalnet.focalnet_base_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:59:54,717][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1010: UserWarning: Overwriting focalnet_large_fl3 in registry with hannah.models._vendor.focalnet.focalnet_large_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:59:54,717][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1031: UserWarning: Overwriting focalnet_large_fl4 in registry with hannah.models._vendor.focalnet.focalnet_large_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:59:54,717][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1052: UserWarning: Overwriting focalnet_xlarge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:59:54,717][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1073: UserWarning: Overwriting focalnet_xlarge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:59:54,717][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1094: UserWarning: Overwriting focalnet_huge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:59:54,717][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1115: UserWarning: Overwriting focalnet_huge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 18:59:54,740][hannah.models.timm][INFO] - Using default logger for automatic stem creation
[2024-05-22 18:59:54,769][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '

[2024-05-22 18:59:54,950][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.5, 0.5, 0.5), std: (0.5, 0.5, 0.5)
[2024-05-22 18:59:54,955][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-22 18:59:54,979][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-22 18:59:54,994][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-22 18:59:57,103][pytorch_lightning.callbacks.model_summary][INFO] - 
  | Name           | Type                           | Params | In sizes         | Out sizes                            
-----------------------------------------------------------------------------------------------------------------------------
0 | val_metrics    | MetricCollection               | 0      | ?                | ?                                    
1 | test_metrics   | MetricCollection               | 0      | ?                | ?                                    
2 | train_metrics  | MetricCollection               | 0      | ?                | ?                                    
3 | model          | TimmModel                      | 1.0 M  | [1, 3, 320, 320] | [[1, 1024, 10, 10], [0], [0], [1, 5]]
4 | test_confusion | MulticlassConfusionMatrix      | 0      | ?                | ?                                    
5 | test_roc       | MulticlassROC                  | 0      | ?                | ?                                    
6 | test_pr_curve  | MulticlassPrecisionRecallCurve | 0      | ?                | ?                                    
7 | metrics        | ModuleDict                     | 0      | ?                | ?                                    
-----------------------------------------------------------------------------------------------------------------------------
1.0 M     Trainable params
0         Non-trainable params
1.0 M     Total params
4.088     Total estimated model params size (MB)
[2024-05-22 18:59:57,400][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-22 18:59:57,401][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-22 18:59:57,403][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-22 19:01:25,198][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-22 19:01:25,199][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-22 19:01:25,199][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-22 19:01:25,199][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-22 19:01:25,199][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-22 19:02:33,782][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-22 19:03:50,214][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 19:03:50,310][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 19:03:50,311][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 19:03:50,314][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 19:03:50,314][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 19:03:50,314][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 19:03:50,314][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 19:03:50,314][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 19:03:50,314][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 19:03:50,314][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 19:03:50,316][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 19:03:50,316][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data module.num_workers=64 trainer.max_epochs=100 module.batch_size=256 dataset.downsampling.enabled=False
[2024-05-22 19:03:50,316][hannah.utils.utils][INFO] -   
[2024-05-22 19:03:50,317][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 19:03:50,318][root][INFO] - Configuration: 
[2024-05-22 19:03:50,322][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: false
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 64
  batch_size: 256
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 100
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 19:03:50,322][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 19:03:51,096][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 19:03:51,096][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 19:03:51,182][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 19:03:51,182][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 19:03:51,182][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 19:03:51,182][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 19:03:51,182][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 19:03:51,182][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 19:03:51,182][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 19:03:51,183][root][INFO] - Starting training
[2024-05-22 19:04:03,593][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_widht' is not valid and will be ignored.
  warn(

[2024-05-22 19:04:03,593][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_heigh' is not valid and will be ignored.
  warn(

[2024-05-22 19:04:03,639][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-22 19:04:03,639][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-22 19:04:03,640][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 2616647
[2024-05-22 19:04:03,640][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-22 19:04:03,640][hannah.modules.vision.base][INFO] -   Dev Set: 662338
[2024-05-22 19:04:03,640][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-22 19:04:03,673][hannah.modules.vision.base][INFO] - Setting up model mobilenetv3_small_075
[2024-05-22 19:04:03,831][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:803: UserWarning: Overwriting focalnet_tiny_srf in registry with hannah.models._vendor.focalnet.focalnet_tiny_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:04:03,832][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:824: UserWarning: Overwriting focalnet_small_srf in registry with hannah.models._vendor.focalnet.focalnet_small_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:04:03,832][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:843: UserWarning: Overwriting focalnet_base_srf in registry with hannah.models._vendor.focalnet.focalnet_base_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:04:03,832][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:862: UserWarning: Overwriting focalnet_tiny_lrf in registry with hannah.models._vendor.focalnet.focalnet_tiny_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:04:03,832][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:885: UserWarning: Overwriting focalnet_small_lrf in registry with hannah.models._vendor.focalnet.focalnet_small_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:04:03,832][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:906: UserWarning: Overwriting focalnet_base_lrf in registry with hannah.models._vendor.focalnet.focalnet_base_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:04:03,832][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1010: UserWarning: Overwriting focalnet_large_fl3 in registry with hannah.models._vendor.focalnet.focalnet_large_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:04:03,832][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1031: UserWarning: Overwriting focalnet_large_fl4 in registry with hannah.models._vendor.focalnet.focalnet_large_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:04:03,832][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1052: UserWarning: Overwriting focalnet_xlarge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:04:03,832][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1073: UserWarning: Overwriting focalnet_xlarge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:04:03,832][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1094: UserWarning: Overwriting focalnet_huge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:04:03,832][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1115: UserWarning: Overwriting focalnet_huge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:04:03,853][hannah.models.timm][INFO] - Using default logger for automatic stem creation
[2024-05-22 19:04:03,885][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '

[2024-05-22 19:04:04,065][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.5, 0.5, 0.5), std: (0.5, 0.5, 0.5)
[2024-05-22 19:04:04,069][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-22 19:04:04,093][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-22 19:04:04,109][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-22 19:04:06,426][pytorch_lightning.callbacks.model_summary][INFO] - 
  | Name           | Type                           | Params | In sizes         | Out sizes                            
-----------------------------------------------------------------------------------------------------------------------------
0 | val_metrics    | MetricCollection               | 0      | ?                | ?                                    
1 | test_metrics   | MetricCollection               | 0      | ?                | ?                                    
2 | train_metrics  | MetricCollection               | 0      | ?                | ?                                    
3 | model          | TimmModel                      | 1.0 M  | [1, 3, 320, 320] | [[1, 1024, 10, 10], [0], [0], [1, 5]]
4 | test_confusion | MulticlassConfusionMatrix      | 0      | ?                | ?                                    
5 | test_roc       | MulticlassROC                  | 0      | ?                | ?                                    
6 | test_pr_curve  | MulticlassPrecisionRecallCurve | 0      | ?                | ?                                    
7 | metrics        | ModuleDict                     | 0      | ?                | ?                                    
-----------------------------------------------------------------------------------------------------------------------------
1.0 M     Trainable params
0         Non-trainable params
1.0 M     Total params
4.088     Total estimated model params size (MB)
[2024-05-22 19:04:06,770][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-22 19:04:06,771][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-22 19:04:06,773][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-22 19:04:28,291][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-22 19:04:28,291][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-22 19:04:28,292][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-22 19:04:28,292][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-22 19:04:28,292][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-22 19:06:18,119][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-22 19:06:18,134][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 19:06:18,136][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-22 19:06:18,393][root][ERROR] - Exception Message: `.validate(ckpt_path="best")` is set but `ModelCheckpoint` is not configured to save the best model.
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 183, in train
    lit_trainer.validate(ckpt_path=ckpt_path, verbose=validate_output)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 645, in validate
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 682, in _validate_impl
    ckpt_path = self._checkpoint_connector._select_ckpt_path(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py", line 104, in _select_ckpt_path
    ckpt_path = self._parse_ckpt_path(
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py", line 171, in _parse_ckpt_path
    raise ValueError(
ValueError: `.validate(ckpt_path="best")` is set but `ModelCheckpoint` is not configured to save the best model.
[2024-05-22 19:08:43,880][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 19:08:43,985][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 19:08:43,986][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 19:08:43,989][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 19:08:43,989][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 19:08:43,989][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 19:08:43,989][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 19:08:43,990][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 19:08:43,990][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 19:08:43,990][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 19:08:43,991][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 19:08:43,991][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data module.num_workers=64 trainer.max_epochs=100 module.batch_size=64 dataset.downsampling.enabled=False
[2024-05-22 19:08:43,991][hannah.utils.utils][INFO] -   
[2024-05-22 19:08:43,992][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 19:08:43,994][root][INFO] - Configuration: 
[2024-05-22 19:08:43,997][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: false
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 64
  batch_size: 64
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 100
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 19:08:43,997][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 19:08:44,738][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 19:08:44,738][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 19:08:44,836][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 19:08:44,836][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 19:08:44,836][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 19:08:44,836][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 19:08:44,836][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 19:08:44,836][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 19:08:44,836][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 19:08:44,837][root][INFO] - Starting training
[2024-05-22 19:08:57,316][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_widht' is not valid and will be ignored.
  warn(

[2024-05-22 19:08:57,316][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_heigh' is not valid and will be ignored.
  warn(

[2024-05-22 19:08:57,373][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-22 19:08:57,373][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-22 19:08:57,373][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 2616647
[2024-05-22 19:08:57,373][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-22 19:08:57,373][hannah.modules.vision.base][INFO] -   Dev Set: 662338
[2024-05-22 19:08:57,373][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-22 19:08:57,398][hannah.modules.vision.base][INFO] - Setting up model mobilenetv3_small_075
[2024-05-22 19:08:57,558][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:803: UserWarning: Overwriting focalnet_tiny_srf in registry with hannah.models._vendor.focalnet.focalnet_tiny_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:08:57,558][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:824: UserWarning: Overwriting focalnet_small_srf in registry with hannah.models._vendor.focalnet.focalnet_small_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:08:57,558][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:843: UserWarning: Overwriting focalnet_base_srf in registry with hannah.models._vendor.focalnet.focalnet_base_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:08:57,558][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:862: UserWarning: Overwriting focalnet_tiny_lrf in registry with hannah.models._vendor.focalnet.focalnet_tiny_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:08:57,558][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:885: UserWarning: Overwriting focalnet_small_lrf in registry with hannah.models._vendor.focalnet.focalnet_small_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:08:57,558][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:906: UserWarning: Overwriting focalnet_base_lrf in registry with hannah.models._vendor.focalnet.focalnet_base_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:08:57,558][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1010: UserWarning: Overwriting focalnet_large_fl3 in registry with hannah.models._vendor.focalnet.focalnet_large_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:08:57,559][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1031: UserWarning: Overwriting focalnet_large_fl4 in registry with hannah.models._vendor.focalnet.focalnet_large_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:08:57,559][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1052: UserWarning: Overwriting focalnet_xlarge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:08:57,559][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1073: UserWarning: Overwriting focalnet_xlarge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:08:57,559][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1094: UserWarning: Overwriting focalnet_huge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:08:57,559][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1115: UserWarning: Overwriting focalnet_huge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:08:57,582][hannah.models.timm][INFO] - Using default logger for automatic stem creation
[2024-05-22 19:08:57,611][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '

[2024-05-22 19:08:57,792][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.5, 0.5, 0.5), std: (0.5, 0.5, 0.5)
[2024-05-22 19:08:57,800][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-22 19:08:57,835][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-22 19:08:57,849][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-22 19:08:59,998][pytorch_lightning.callbacks.model_summary][INFO] - 
  | Name           | Type                           | Params | In sizes         | Out sizes                            
-----------------------------------------------------------------------------------------------------------------------------
0 | val_metrics    | MetricCollection               | 0      | ?                | ?                                    
1 | test_metrics   | MetricCollection               | 0      | ?                | ?                                    
2 | train_metrics  | MetricCollection               | 0      | ?                | ?                                    
3 | model          | TimmModel                      | 1.0 M  | [1, 3, 320, 320] | [[1, 1024, 10, 10], [0], [0], [1, 5]]
4 | test_confusion | MulticlassConfusionMatrix      | 0      | ?                | ?                                    
5 | test_roc       | MulticlassROC                  | 0      | ?                | ?                                    
6 | test_pr_curve  | MulticlassPrecisionRecallCurve | 0      | ?                | ?                                    
7 | metrics        | ModuleDict                     | 0      | ?                | ?                                    
-----------------------------------------------------------------------------------------------------------------------------
1.0 M     Trainable params
0         Non-trainable params
1.0 M     Total params
4.088     Total estimated model params size (MB)
[2024-05-22 19:09:00,868][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-22 19:09:00,869][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-22 19:09:00,872][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-22 19:09:15,180][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-22 19:09:15,183][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-22 19:09:15,183][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-22 19:09:15,183][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-22 19:09:15,183][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-22 19:10:17,661][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-22 19:10:17,733][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 19:10:17,741][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-22 19:10:18,080][root][ERROR] - Exception Message: `.validate(ckpt_path="best")` is set but `ModelCheckpoint` is not configured to save the best model.
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 183, in train
    lit_trainer.validate(ckpt_path=ckpt_path, verbose=validate_output)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 645, in validate
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 682, in _validate_impl
    ckpt_path = self._checkpoint_connector._select_ckpt_path(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py", line 104, in _select_ckpt_path
    ckpt_path = self._parse_ckpt_path(
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py", line 171, in _parse_ckpt_path
    raise ValueError(
ValueError: `.validate(ckpt_path="best")` is set but `ModelCheckpoint` is not configured to save the best model.
[2024-05-22 19:10:45,913][hannah.utils.utils][INFO] - Environment info:
[2024-05-22 19:10:46,000][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-22 19:10:46,001][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-22 19:10:46,004][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-22 19:10:46,004][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-22 19:10:46,004][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-22 19:10:46,004][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-22 19:10:46,004][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-22 19:10:46,004][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-22 19:10:46,004][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-22 19:10:46,006][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-22 19:10:46,006][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data module.num_workers=64 trainer.max_epochs=100 module.batch_size=64 dataset.downsampling.enabled=False dataset.sampler=weighted
[2024-05-22 19:10:46,006][hannah.utils.utils][INFO] -   
[2024-05-22 19:10:46,007][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-22 19:10:46,009][root][INFO] - Configuration: 
[2024-05-22 19:10:46,012][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: weighted
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: false
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 64
  batch_size: 64
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 100
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-22 19:10:46,012][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-22 19:10:46,775][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-22 19:10:46,775][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-22 19:10:46,879][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-22 19:10:46,879][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-22 19:10:46,879][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-22 19:10:46,880][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-22 19:10:46,880][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-22 19:10:46,880][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 19:10:46,880][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-22 19:10:46,880][root][INFO] - Starting training
[2024-05-22 19:10:59,480][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_widht' is not valid and will be ignored.
  warn(

[2024-05-22 19:10:59,480][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_heigh' is not valid and will be ignored.
  warn(

[2024-05-22 19:10:59,522][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-22 19:10:59,522][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-22 19:10:59,522][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 2616647
[2024-05-22 19:10:59,522][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-22 19:10:59,522][hannah.modules.vision.base][INFO] -   Dev Set: 662338
[2024-05-22 19:10:59,522][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-22 19:10:59,540][hannah.modules.vision.base][INFO] - Setting up model mobilenetv3_small_075
[2024-05-22 19:10:59,699][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:803: UserWarning: Overwriting focalnet_tiny_srf in registry with hannah.models._vendor.focalnet.focalnet_tiny_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:10:59,699][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:824: UserWarning: Overwriting focalnet_small_srf in registry with hannah.models._vendor.focalnet.focalnet_small_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:10:59,699][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:843: UserWarning: Overwriting focalnet_base_srf in registry with hannah.models._vendor.focalnet.focalnet_base_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:10:59,699][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:862: UserWarning: Overwriting focalnet_tiny_lrf in registry with hannah.models._vendor.focalnet.focalnet_tiny_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:10:59,699][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:885: UserWarning: Overwriting focalnet_small_lrf in registry with hannah.models._vendor.focalnet.focalnet_small_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:10:59,699][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:906: UserWarning: Overwriting focalnet_base_lrf in registry with hannah.models._vendor.focalnet.focalnet_base_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:10:59,699][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1010: UserWarning: Overwriting focalnet_large_fl3 in registry with hannah.models._vendor.focalnet.focalnet_large_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:10:59,700][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1031: UserWarning: Overwriting focalnet_large_fl4 in registry with hannah.models._vendor.focalnet.focalnet_large_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:10:59,700][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1052: UserWarning: Overwriting focalnet_xlarge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:10:59,700][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1073: UserWarning: Overwriting focalnet_xlarge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:10:59,700][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1094: UserWarning: Overwriting focalnet_huge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:10:59,700][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1115: UserWarning: Overwriting focalnet_huge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-22 19:10:59,723][hannah.models.timm][INFO] - Using default logger for automatic stem creation
[2024-05-22 19:10:59,752][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '

[2024-05-22 19:10:59,936][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.5, 0.5, 0.5), std: (0.5, 0.5, 0.5)
[2024-05-22 19:10:59,940][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-22 19:10:59,965][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-22 19:10:59,979][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-22 19:11:02,878][pytorch_lightning.callbacks.model_summary][INFO] - 
  | Name           | Type                           | Params | In sizes         | Out sizes                            
-----------------------------------------------------------------------------------------------------------------------------
0 | val_metrics    | MetricCollection               | 0      | ?                | ?                                    
1 | test_metrics   | MetricCollection               | 0      | ?                | ?                                    
2 | train_metrics  | MetricCollection               | 0      | ?                | ?                                    
3 | model          | TimmModel                      | 1.0 M  | [1, 3, 320, 320] | [[1, 1024, 10, 10], [0], [0], [1, 5]]
4 | test_confusion | MulticlassConfusionMatrix      | 0      | ?                | ?                                    
5 | test_roc       | MulticlassROC                  | 0      | ?                | ?                                    
6 | test_pr_curve  | MulticlassPrecisionRecallCurve | 0      | ?                | ?                                    
7 | metrics        | ModuleDict                     | 0      | ?                | ?                                    
-----------------------------------------------------------------------------------------------------------------------------
1.0 M     Trainable params
0         Non-trainable params
1.0 M     Total params
4.088     Total estimated model params size (MB)
[2024-05-22 19:11:03,748][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-22 19:11:03,749][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-22 19:11:03,750][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-22 19:11:11,885][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-22 19:11:11,887][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-22 19:11:11,888][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-22 19:11:11,888][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-22 19:11:11,888][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-22 19:39:33,480][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 40885: 'val_error' reached 0.25402 (best 0.25402), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=0-step=40885.ckpt' as top 1
[2024-05-22 20:07:44,953][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 81770: 'val_error' reached 0.24486 (best 0.24486), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=1-step=81770.ckpt' as top 1
[2024-05-22 20:35:53,852][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 122655: 'val_error' reached 0.23998 (best 0.23998), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=2-step=122655.ckpt' as top 1
[2024-05-22 21:03:53,253][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 163540: 'val_error' reached 0.20633 (best 0.20633), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=3-step=163540.ckpt' as top 1
[2024-05-22 21:32:05,678][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 204425: 'val_error' was not in top 1
[2024-05-22 21:59:52,989][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 245310: 'val_error' was not in top 1
[2024-05-22 22:27:55,337][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 286195: 'val_error' reached 0.18812 (best 0.18812), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=6-step=286195.ckpt' as top 1
[2024-05-22 22:56:01,805][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 327080: 'val_error' was not in top 1
[2024-05-22 23:24:05,462][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 367965: 'val_error' was not in top 1
[2024-05-22 23:52:13,923][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 408850: 'val_error' reached 0.16573 (best 0.16573), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=9-step=408850.ckpt' as top 1
[2024-05-23 00:20:20,009][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 449735: 'val_error' reached 0.16487 (best 0.16487), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=10-step=449735.ckpt' as top 1
[2024-05-23 00:48:35,393][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 490620: 'val_error' was not in top 1
[2024-05-23 01:16:55,181][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 531505: 'val_error' reached 0.15526 (best 0.15526), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=12-step=531505.ckpt' as top 1
[2024-05-23 01:45:14,704][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 572390: 'val_error' was not in top 1
[2024-05-23 02:13:36,263][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 613275: 'val_error' was not in top 1
[2024-05-23 02:41:59,178][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 654160: 'val_error' reached 0.13268 (best 0.13268), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=15-step=654160.ckpt' as top 1
[2024-05-23 03:10:16,668][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 695045: 'val_error' was not in top 1
[2024-05-23 03:38:28,193][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 735930: 'val_error' was not in top 1
[2024-05-23 04:06:49,608][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 776815: 'val_error' was not in top 1
[2024-05-23 04:35:11,536][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 817700: 'val_error' was not in top 1
[2024-05-23 05:03:35,024][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 858585: 'val_error' was not in top 1
[2024-05-23 05:31:56,903][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 899470: 'val_error' was not in top 1
[2024-05-23 05:59:57,731][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 940355: 'val_error' was not in top 1
[2024-05-23 06:28:06,665][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 981240: 'val_error' was not in top 1
[2024-05-23 06:56:17,154][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 1022125: 'val_error' was not in top 1
[2024-05-23 07:24:25,906][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 1063010: 'val_error' was not in top 1
[2024-05-23 07:52:34,603][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 1103895: 'val_error' was not in top 1
[2024-05-23 08:20:31,268][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 1144780: 'val_error' was not in top 1
[2024-05-23 08:48:48,262][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 1185665: 'val_error' was not in top 1
[2024-05-23 09:17:04,789][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 1226550: 'val_error' was not in top 1
[2024-05-23 09:45:45,715][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 1267435: 'val_error' was not in top 1
[2024-05-23 10:14:06,196][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 1308320: 'val_error' was not in top 1
[2024-05-23 10:45:10,560][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 1349205: 'val_error' was not in top 1
[2024-05-23 11:16:28,171][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 1390090: 'val_error' was not in top 1
[2024-05-23 11:47:42,733][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 1430975: 'val_error' was not in top 1
[2024-05-23 12:05:00,454][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-23 12:05:00,470][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-23 12:05:00,472][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-23 12:05:00,476][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=15-step=654160.ckpt
[2024-05-23 12:05:00,619][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-23 12:05:01,178][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-23 12:05:01,198][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-23 12:05:01,201][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-23 12:05:01,814][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-23 12:05:01,814][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-23 12:05:01,816][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=15-step=654160.ckpt
[2024-05-23 12:05:01,917][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-23 12:05:02,667][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 1.33721  |     0 |       1 |
| val_accuracy        | 0.806983 |     0 |       1 |
| val_error           | 0.193017 |     0 |       1 |
| val_f1              | 0.638958 |     0 |       1 |
| val_precision       | 0.594079 |     0 |       1 |
| val_recall          | 0.767946 |     0 |       1 |
| val_loss            | 1.33721  |     0 |       1 |
[2024-05-23 12:06:31,137][hannah.utils.utils][INFO] - Environment info:
[2024-05-23 12:06:31,241][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-23 12:06:31,242][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-23 12:06:31,245][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-23 12:06:31,245][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-23 12:06:31,245][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-23 12:06:31,245][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-23 12:06:31,246][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-23 12:06:31,246][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-23 12:06:31,246][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-23 12:06:31,247][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-23 12:06:31,247][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data module.num_workers=64 module.batch_size=128 dataset.downsampling.enabled=False
[2024-05-23 12:06:31,247][hannah.utils.utils][INFO] -   
[2024-05-23 12:06:31,248][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-23 12:06:31,258][root][INFO] - Configuration: 
[2024-05-23 12:06:31,261][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: false
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 64
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-23 12:06:31,262][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-23 12:06:32,226][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-23 12:06:32,226][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-23 12:06:32,322][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-23 12:06:32,322][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-23 12:06:32,322][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-23 12:06:32,322][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-23 12:06:32,322][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-23 12:06:32,322][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-23 12:06:32,322][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-23 12:06:32,323][root][INFO] - Starting training
[2024-05-23 12:06:44,600][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_widht' is not valid and will be ignored.
  warn(

[2024-05-23 12:06:44,600][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'max_heigh' is not valid and will be ignored.
  warn(

[2024-05-23 12:06:44,644][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-23 12:06:44,644][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-23 12:06:44,645][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 2616647
[2024-05-23 12:06:44,645][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-23 12:06:44,645][hannah.modules.vision.base][INFO] -   Dev Set: 662338
[2024-05-23 12:06:44,645][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-23 12:06:44,666][hannah.modules.vision.base][INFO] - Setting up model mobilenetv3_small_075
[2024-05-23 12:06:44,858][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:803: UserWarning: Overwriting focalnet_tiny_srf in registry with hannah.models._vendor.focalnet.focalnet_tiny_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 12:06:44,858][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:824: UserWarning: Overwriting focalnet_small_srf in registry with hannah.models._vendor.focalnet.focalnet_small_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 12:06:44,858][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:843: UserWarning: Overwriting focalnet_base_srf in registry with hannah.models._vendor.focalnet.focalnet_base_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 12:06:44,858][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:862: UserWarning: Overwriting focalnet_tiny_lrf in registry with hannah.models._vendor.focalnet.focalnet_tiny_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 12:06:44,858][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:885: UserWarning: Overwriting focalnet_small_lrf in registry with hannah.models._vendor.focalnet.focalnet_small_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 12:06:44,859][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:906: UserWarning: Overwriting focalnet_base_lrf in registry with hannah.models._vendor.focalnet.focalnet_base_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 12:06:44,859][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1010: UserWarning: Overwriting focalnet_large_fl3 in registry with hannah.models._vendor.focalnet.focalnet_large_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 12:06:44,859][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1031: UserWarning: Overwriting focalnet_large_fl4 in registry with hannah.models._vendor.focalnet.focalnet_large_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 12:06:44,859][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1052: UserWarning: Overwriting focalnet_xlarge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 12:06:44,859][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1073: UserWarning: Overwriting focalnet_xlarge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 12:06:44,859][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1094: UserWarning: Overwriting focalnet_huge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 12:06:44,859][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1115: UserWarning: Overwriting focalnet_huge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 12:06:44,882][hannah.models.timm][INFO] - Using default logger for automatic stem creation
[2024-05-23 12:06:44,922][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '

[2024-05-23 12:06:45,105][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.5, 0.5, 0.5), std: (0.5, 0.5, 0.5)
[2024-05-23 12:06:45,111][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-23 12:06:45,135][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-23 12:06:45,151][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-23 12:06:47,425][pytorch_lightning.callbacks.model_summary][INFO] - 
  | Name           | Type                           | Params | In sizes         | Out sizes                            
-----------------------------------------------------------------------------------------------------------------------------
0 | val_metrics    | MetricCollection               | 0      | ?                | ?                                    
1 | test_metrics   | MetricCollection               | 0      | ?                | ?                                    
2 | train_metrics  | MetricCollection               | 0      | ?                | ?                                    
3 | model          | TimmModel                      | 1.0 M  | [1, 3, 320, 320] | [[1, 1024, 10, 10], [0], [0], [1, 5]]
4 | test_confusion | MulticlassConfusionMatrix      | 0      | ?                | ?                                    
5 | test_roc       | MulticlassROC                  | 0      | ?                | ?                                    
6 | test_pr_curve  | MulticlassPrecisionRecallCurve | 0      | ?                | ?                                    
7 | metrics        | ModuleDict                     | 0      | ?                | ?                                    
-----------------------------------------------------------------------------------------------------------------------------
1.0 M     Trainable params
0         Non-trainable params
1.0 M     Total params
4.088     Total estimated model params size (MB)
[2024-05-23 12:06:47,727][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-23 12:06:47,728][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-23 12:06:47,729][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-23 12:07:11,538][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-23 12:07:11,539][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-23 12:07:11,540][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-23 12:07:11,540][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-23 12:07:11,540][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-23 12:34:44,758][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 20442: 'val_error' reached 0.24672 (best 0.24672), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=0-step=20442.ckpt' as top 1
[2024-05-23 13:02:13,847][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 40884: 'val_error' reached 0.20834 (best 0.20834), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=1-step=40884.ckpt' as top 1
[2024-05-23 13:29:45,568][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 61326: 'val_error' reached 0.17550 (best 0.17550), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=2-step=61326.ckpt' as top 1
[2024-05-23 13:57:07,197][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 81768: 'val_error' reached 0.14418 (best 0.14418), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=3-step=81768.ckpt' as top 1
[2024-05-23 14:24:38,169][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 102210: 'val_error' was not in top 1
[2024-05-23 14:51:44,971][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 122652: 'val_error' was not in top 1
[2024-05-23 15:21:10,644][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 143094: 'val_error' was not in top 1
[2024-05-23 15:52:19,339][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 163536: 'val_error' was not in top 1
[2024-05-23 16:23:34,277][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 183978: 'val_error' was not in top 1
[2024-05-23 16:55:33,318][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 204420: 'val_error' reached 0.14097 (best 0.14097), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=9-step=204420.ckpt' as top 1
[2024-05-23 17:07:28,556][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py:54: Detected KeyboardInterrupt, attempting graceful shutdown...

[2024-05-23 17:07:28,563][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-23 17:07:28,566][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-23 17:07:28,574][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=9-step=204420.ckpt
[2024-05-23 17:07:29,066][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-23 17:07:29,282][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-23 17:07:29,282][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-23 17:07:29,284][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=9-step=204420.ckpt
[2024-05-23 17:07:29,377][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-23 17:07:29,692][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-23 17:07:29,713][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-23 17:07:29,716][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-23 17:07:30,300][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 0.755834 |     0 |       1 |
| val_accuracy        | 0.859029 |     0 |       1 |
| val_error           | 0.140971 |     0 |       1 |
| val_f1              | 0.57877  |     0 |       1 |
| val_precision       | 0.547106 |     0 |       1 |
| val_recall          | 0.745979 |     0 |       1 |
| val_loss            | 0.755834 |     0 |       1 |
[2024-05-23 17:09:00,628][hannah.utils.utils][INFO] - Environment info:
[2024-05-23 17:09:00,734][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-23 17:09:00,735][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-23 17:09:00,739][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-23 17:09:00,739][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-23 17:09:00,739][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-23 17:09:00,739][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-23 17:09:00,739][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-23 17:09:00,739][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-23 17:09:00,739][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-23 17:09:00,741][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-23 17:09:00,741][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data module.num_workers=64 module.batch_size=128 dataset.downsampling.enabled=False
[2024-05-23 17:09:00,741][hannah.utils.utils][INFO] -   
[2024-05-23 17:09:00,742][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-23 17:09:00,751][root][INFO] - Configuration: 
[2024-05-23 17:09:00,754][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: false
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 64
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-23 17:09:00,755][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-23 17:09:01,515][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-23 17:09:01,515][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-23 17:09:01,616][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-23 17:09:01,617][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-23 17:09:01,617][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-23 17:09:01,617][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-23 17:09:01,617][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-23 17:09:01,617][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-23 17:09:01,617][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-23 17:09:01,617][root][INFO] - Starting training
[2024-05-23 17:09:14,276][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'limit' is not valid and will be ignored.
  warn(

[2024-05-23 17:09:14,325][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-23 17:09:14,325][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-23 17:09:14,325][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 2616647
[2024-05-23 17:09:14,325][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-23 17:09:14,325][hannah.modules.vision.base][INFO] -   Dev Set: 662338
[2024-05-23 17:09:14,325][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-23 17:09:14,346][hannah.modules.vision.base][INFO] - Setting up model mobilenetv3_small_075
[2024-05-23 17:09:14,550][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:803: UserWarning: Overwriting focalnet_tiny_srf in registry with hannah.models._vendor.focalnet.focalnet_tiny_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:09:14,550][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:824: UserWarning: Overwriting focalnet_small_srf in registry with hannah.models._vendor.focalnet.focalnet_small_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:09:14,550][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:843: UserWarning: Overwriting focalnet_base_srf in registry with hannah.models._vendor.focalnet.focalnet_base_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:09:14,550][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:862: UserWarning: Overwriting focalnet_tiny_lrf in registry with hannah.models._vendor.focalnet.focalnet_tiny_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:09:14,551][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:885: UserWarning: Overwriting focalnet_small_lrf in registry with hannah.models._vendor.focalnet.focalnet_small_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:09:14,551][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:906: UserWarning: Overwriting focalnet_base_lrf in registry with hannah.models._vendor.focalnet.focalnet_base_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:09:14,551][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1010: UserWarning: Overwriting focalnet_large_fl3 in registry with hannah.models._vendor.focalnet.focalnet_large_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:09:14,551][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1031: UserWarning: Overwriting focalnet_large_fl4 in registry with hannah.models._vendor.focalnet.focalnet_large_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:09:14,551][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1052: UserWarning: Overwriting focalnet_xlarge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:09:14,551][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1073: UserWarning: Overwriting focalnet_xlarge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:09:14,551][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1094: UserWarning: Overwriting focalnet_huge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:09:14,551][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1115: UserWarning: Overwriting focalnet_huge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:09:14,577][hannah.models.timm][INFO] - Using default logger for automatic stem creation
[2024-05-23 17:09:14,615][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '

[2024-05-23 17:09:14,803][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.5, 0.5, 0.5), std: (0.5, 0.5, 0.5)
[2024-05-23 17:09:14,808][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-23 17:09:14,833][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-23 17:09:14,849][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-23 17:09:17,124][pytorch_lightning.callbacks.model_summary][INFO] - 
  | Name           | Type                           | Params | In sizes         | Out sizes                            
-----------------------------------------------------------------------------------------------------------------------------
0 | val_metrics    | MetricCollection               | 0      | ?                | ?                                    
1 | test_metrics   | MetricCollection               | 0      | ?                | ?                                    
2 | train_metrics  | MetricCollection               | 0      | ?                | ?                                    
3 | model          | TimmModel                      | 1.0 M  | [1, 3, 320, 320] | [[1, 1024, 10, 10], [0], [0], [1, 5]]
4 | test_confusion | MulticlassConfusionMatrix      | 0      | ?                | ?                                    
5 | test_roc       | MulticlassROC                  | 0      | ?                | ?                                    
6 | test_pr_curve  | MulticlassPrecisionRecallCurve | 0      | ?                | ?                                    
7 | metrics        | ModuleDict                     | 0      | ?                | ?                                    
-----------------------------------------------------------------------------------------------------------------------------
1.0 M     Trainable params
0         Non-trainable params
1.0 M     Total params
4.088     Total estimated model params size (MB)
[2024-05-23 17:09:17,372][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-23 17:09:17,373][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-23 17:09:17,374][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-23 17:09:32,366][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-23 17:09:32,367][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-23 17:09:32,367][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-23 17:09:32,368][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-23 17:09:32,368][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-23 17:09:33,296][root][ERROR] - Exception Message: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
           ^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/base.py", line 107, in __getitem__
    transformed = self.transform(image=image)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 256, in __call__
    data = t(**data)
           ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 256, in __call__
    data = t(**data)
           ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/transforms_interface.py", line 97, in __call__
    return self.apply_with_params(params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/transforms_interface.py", line 108, in apply_with_params
    res[key] = target_function(arg, **params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/transforms.py", line 1567, in apply
    return F.iso_noise(img, color_shift, intensity, np.random.RandomState(random_seed))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/utils.py", line 86, in wrapped_function
    return clip(func(img, *args, **kwargs), dtype, maxval)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/functional.py", line 998, in iso_noise
    raise TypeError(msg)
TypeError: Image must have uint8 channel type
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
    self.fit_loop.run()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
    self.advance()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
    self.advance(data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 212, in advance
    batch, _, __ = next(data_fetcher)
                   ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fetchers.py", line 133, in __next__
    batch = super().__next__()
            ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fetchers.py", line 60, in __next__
    batch = next(self.iterator)
            ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/utilities/combined_loader.py", line 341, in __next__
    out = next(self._iterator)
          ^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/utilities/combined_loader.py", line 78, in __next__
    out[i] = next(self.iterators[i])
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/_utils.py", line 722, in reraise
    raise exception
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
           ^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/base.py", line 107, in __getitem__
    transformed = self.transform(image=image)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 256, in __call__
    data = t(**data)
           ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 256, in __call__
    data = t(**data)
           ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/transforms_interface.py", line 97, in __call__
    return self.apply_with_params(params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/transforms_interface.py", line 108, in apply_with_params
    res[key] = target_function(arg, **params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/transforms.py", line 1567, in apply
    return F.iso_noise(img, color_shift, intensity, np.random.RandomState(random_seed))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/utils.py", line 86, in wrapped_function
    return clip(func(img, *args, **kwargs), dtype, maxval)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/functional.py", line 998, in iso_noise
    raise TypeError(msg)
TypeError: Image must have uint8 channel type

[2024-05-23 17:11:08,405][hannah.utils.utils][INFO] - Environment info:
[2024-05-23 17:11:08,513][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-23 17:11:08,514][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-23 17:11:08,517][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-23 17:11:08,517][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-23 17:11:08,517][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-23 17:11:08,517][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-23 17:11:08,517][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-23 17:11:08,517][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-23 17:11:08,517][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-23 17:11:08,519][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-23 17:11:08,519][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data module.num_workers=64 module.batch_size=128 dataset.downsampling.enabled=False
[2024-05-23 17:11:08,519][hannah.utils.utils][INFO] -   
[2024-05-23 17:11:08,520][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-23 17:11:08,521][root][INFO] - Configuration: 
[2024-05-23 17:11:08,525][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: false
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 64
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-23 17:11:08,525][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-23 17:11:09,297][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-23 17:11:09,297][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-23 17:11:09,396][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-23 17:11:09,397][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-23 17:11:09,397][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-23 17:11:09,397][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-23 17:11:09,397][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-23 17:11:09,397][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-23 17:11:09,397][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-23 17:11:09,397][root][INFO] - Starting training
[2024-05-23 17:11:22,024][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'limit' is not valid and will be ignored.
  warn(

[2024-05-23 17:11:22,072][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-23 17:11:22,072][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-23 17:11:22,072][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 2616647
[2024-05-23 17:11:22,072][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-23 17:11:22,072][hannah.modules.vision.base][INFO] -   Dev Set: 662338
[2024-05-23 17:11:22,072][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-23 17:11:22,091][hannah.modules.vision.base][INFO] - Setting up model mobilenetv3_small_075
[2024-05-23 17:11:22,262][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:803: UserWarning: Overwriting focalnet_tiny_srf in registry with hannah.models._vendor.focalnet.focalnet_tiny_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:11:22,262][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:824: UserWarning: Overwriting focalnet_small_srf in registry with hannah.models._vendor.focalnet.focalnet_small_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:11:22,262][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:843: UserWarning: Overwriting focalnet_base_srf in registry with hannah.models._vendor.focalnet.focalnet_base_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:11:22,262][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:862: UserWarning: Overwriting focalnet_tiny_lrf in registry with hannah.models._vendor.focalnet.focalnet_tiny_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:11:22,262][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:885: UserWarning: Overwriting focalnet_small_lrf in registry with hannah.models._vendor.focalnet.focalnet_small_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:11:22,262][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:906: UserWarning: Overwriting focalnet_base_lrf in registry with hannah.models._vendor.focalnet.focalnet_base_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:11:22,262][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1010: UserWarning: Overwriting focalnet_large_fl3 in registry with hannah.models._vendor.focalnet.focalnet_large_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:11:22,262][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1031: UserWarning: Overwriting focalnet_large_fl4 in registry with hannah.models._vendor.focalnet.focalnet_large_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:11:22,262][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1052: UserWarning: Overwriting focalnet_xlarge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:11:22,263][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1073: UserWarning: Overwriting focalnet_xlarge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:11:22,263][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1094: UserWarning: Overwriting focalnet_huge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:11:22,263][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1115: UserWarning: Overwriting focalnet_huge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:11:22,285][hannah.models.timm][INFO] - Using default logger for automatic stem creation
[2024-05-23 17:11:22,312][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '

[2024-05-23 17:11:22,505][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.5, 0.5, 0.5), std: (0.5, 0.5, 0.5)
[2024-05-23 17:11:22,509][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-23 17:11:22,532][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-23 17:11:22,546][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-23 17:11:24,820][pytorch_lightning.callbacks.model_summary][INFO] - 
  | Name           | Type                           | Params | In sizes         | Out sizes                            
-----------------------------------------------------------------------------------------------------------------------------
0 | val_metrics    | MetricCollection               | 0      | ?                | ?                                    
1 | test_metrics   | MetricCollection               | 0      | ?                | ?                                    
2 | train_metrics  | MetricCollection               | 0      | ?                | ?                                    
3 | model          | TimmModel                      | 1.0 M  | [1, 3, 320, 320] | [[1, 1024, 10, 10], [0], [0], [1, 5]]
4 | test_confusion | MulticlassConfusionMatrix      | 0      | ?                | ?                                    
5 | test_roc       | MulticlassROC                  | 0      | ?                | ?                                    
6 | test_pr_curve  | MulticlassPrecisionRecallCurve | 0      | ?                | ?                                    
7 | metrics        | ModuleDict                     | 0      | ?                | ?                                    
-----------------------------------------------------------------------------------------------------------------------------
1.0 M     Trainable params
0         Non-trainable params
1.0 M     Total params
4.088     Total estimated model params size (MB)
[2024-05-23 17:11:25,069][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-23 17:11:25,070][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-23 17:11:25,071][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-23 17:11:42,043][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-23 17:11:42,044][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-23 17:11:42,044][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-23 17:11:42,044][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-23 17:11:42,044][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-23 17:11:42,912][root][ERROR] - Exception Message: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
           ^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/base.py", line 107, in __getitem__
    transformed = self.transform(image=image)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 256, in __call__
    data = t(**data)
           ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 256, in __call__
    data = t(**data)
           ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/transforms_interface.py", line 97, in __call__
    return self.apply_with_params(params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/transforms_interface.py", line 108, in apply_with_params
    res[key] = target_function(arg, **params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/transforms.py", line 1567, in apply
    return F.iso_noise(img, color_shift, intensity, np.random.RandomState(random_seed))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/utils.py", line 86, in wrapped_function
    return clip(func(img, *args, **kwargs), dtype, maxval)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/functional.py", line 998, in iso_noise
    raise TypeError(msg)
TypeError: Image must have uint8 channel type
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
    self.fit_loop.run()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
    self.advance()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
    self.advance(data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 212, in advance
    batch, _, __ = next(data_fetcher)
                   ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fetchers.py", line 133, in __next__
    batch = super().__next__()
            ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fetchers.py", line 60, in __next__
    batch = next(self.iterator)
            ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/utilities/combined_loader.py", line 341, in __next__
    out = next(self._iterator)
          ^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/utilities/combined_loader.py", line 78, in __next__
    out[i] = next(self.iterators[i])
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/_utils.py", line 722, in reraise
    raise exception
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
           ^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/base.py", line 107, in __getitem__
    transformed = self.transform(image=image)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 256, in __call__
    data = t(**data)
           ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 256, in __call__
    data = t(**data)
           ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/transforms_interface.py", line 97, in __call__
    return self.apply_with_params(params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/transforms_interface.py", line 108, in apply_with_params
    res[key] = target_function(arg, **params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/transforms.py", line 1567, in apply
    return F.iso_noise(img, color_shift, intensity, np.random.RandomState(random_seed))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/utils.py", line 86, in wrapped_function
    return clip(func(img, *args, **kwargs), dtype, maxval)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/functional.py", line 998, in iso_noise
    raise TypeError(msg)
TypeError: Image must have uint8 channel type

[2024-05-23 17:12:10,002][hannah.utils.utils][INFO] - Environment info:
[2024-05-23 17:12:10,111][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-23 17:12:10,112][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-23 17:12:10,115][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-23 17:12:10,115][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-23 17:12:10,115][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-23 17:12:10,115][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-23 17:12:10,115][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-23 17:12:10,115][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-23 17:12:10,115][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-23 17:12:10,117][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-23 17:12:10,117][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data module.num_workers=64 module.batch_size=128 dataset.downsampling.enabled=False
[2024-05-23 17:12:10,117][hannah.utils.utils][INFO] -   
[2024-05-23 17:12:10,118][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-23 17:12:10,119][root][INFO] - Configuration: 
[2024-05-23 17:12:10,123][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: false
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 64
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-23 17:12:10,123][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-23 17:12:10,877][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-23 17:12:10,877][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-23 17:12:10,976][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-23 17:12:10,976][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-23 17:12:10,976][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-23 17:12:10,976][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-23 17:12:10,976][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-23 17:12:10,976][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-23 17:12:10,977][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-23 17:12:10,977][root][INFO] - Starting training
[2024-05-23 17:12:27,184][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'limit' is not valid and will be ignored.
  warn(

[2024-05-23 17:12:27,236][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-23 17:12:27,236][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-23 17:12:27,236][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 2616647
[2024-05-23 17:12:27,236][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-23 17:12:27,236][hannah.modules.vision.base][INFO] -   Dev Set: 662338
[2024-05-23 17:12:27,236][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-23 17:12:27,255][hannah.modules.vision.base][INFO] - Setting up model mobilenetv3_small_075
[2024-05-23 17:12:27,416][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:803: UserWarning: Overwriting focalnet_tiny_srf in registry with hannah.models._vendor.focalnet.focalnet_tiny_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:12:27,416][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:824: UserWarning: Overwriting focalnet_small_srf in registry with hannah.models._vendor.focalnet.focalnet_small_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:12:27,416][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:843: UserWarning: Overwriting focalnet_base_srf in registry with hannah.models._vendor.focalnet.focalnet_base_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:12:27,416][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:862: UserWarning: Overwriting focalnet_tiny_lrf in registry with hannah.models._vendor.focalnet.focalnet_tiny_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:12:27,416][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:885: UserWarning: Overwriting focalnet_small_lrf in registry with hannah.models._vendor.focalnet.focalnet_small_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:12:27,416][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:906: UserWarning: Overwriting focalnet_base_lrf in registry with hannah.models._vendor.focalnet.focalnet_base_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:12:27,416][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1010: UserWarning: Overwriting focalnet_large_fl3 in registry with hannah.models._vendor.focalnet.focalnet_large_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:12:27,416][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1031: UserWarning: Overwriting focalnet_large_fl4 in registry with hannah.models._vendor.focalnet.focalnet_large_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:12:27,417][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1052: UserWarning: Overwriting focalnet_xlarge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:12:27,417][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1073: UserWarning: Overwriting focalnet_xlarge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:12:27,417][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1094: UserWarning: Overwriting focalnet_huge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:12:27,417][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1115: UserWarning: Overwriting focalnet_huge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:12:27,440][hannah.models.timm][INFO] - Using default logger for automatic stem creation
[2024-05-23 17:12:27,468][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '

[2024-05-23 17:12:27,660][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.5, 0.5, 0.5), std: (0.5, 0.5, 0.5)
[2024-05-23 17:12:27,664][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-23 17:12:27,687][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-23 17:12:27,701][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-23 17:12:29,906][pytorch_lightning.callbacks.model_summary][INFO] - 
  | Name           | Type                           | Params | In sizes         | Out sizes                            
-----------------------------------------------------------------------------------------------------------------------------
0 | val_metrics    | MetricCollection               | 0      | ?                | ?                                    
1 | test_metrics   | MetricCollection               | 0      | ?                | ?                                    
2 | train_metrics  | MetricCollection               | 0      | ?                | ?                                    
3 | model          | TimmModel                      | 1.0 M  | [1, 3, 320, 320] | [[1, 1024, 10, 10], [0], [0], [1, 5]]
4 | test_confusion | MulticlassConfusionMatrix      | 0      | ?                | ?                                    
5 | test_roc       | MulticlassROC                  | 0      | ?                | ?                                    
6 | test_pr_curve  | MulticlassPrecisionRecallCurve | 0      | ?                | ?                                    
7 | metrics        | ModuleDict                     | 0      | ?                | ?                                    
-----------------------------------------------------------------------------------------------------------------------------
1.0 M     Trainable params
0         Non-trainable params
1.0 M     Total params
4.088     Total estimated model params size (MB)
[2024-05-23 17:12:30,159][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-23 17:12:30,159][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-23 17:12:30,161][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-23 17:12:44,617][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-23 17:12:44,619][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-23 17:12:44,619][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-23 17:12:44,619][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-23 17:12:44,619][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-23 17:12:45,562][root][ERROR] - Exception Message: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
           ^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/base.py", line 107, in __getitem__
    transformed = self.transform(image=image)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 256, in __call__
    data = t(**data)
           ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 256, in __call__
    data = t(**data)
           ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/transforms_interface.py", line 97, in __call__
    return self.apply_with_params(params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/transforms_interface.py", line 108, in apply_with_params
    res[key] = target_function(arg, **params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/transforms.py", line 1334, in apply
    return F.equalize(img, mode=self.mode, by_channels=self.by_channels, mask=mask)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/utils.py", line 124, in wrapped_function
    result = func(img, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/functional.py", line 423, in equalize
    _check_preconditions(img, mask, by_channels)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/functional.py", line 391, in _check_preconditions
    raise TypeError(msg)
TypeError: Image must have uint8 channel type
Traceback (most recent call last):
  File "/local/gerum/hannah/hannah/tools/train.py", line 44, in main
    return train(config)
           ^^^^^^^^^^^^^
  File "/local/gerum/hannah/hannah/train.py", line 175, in train
    lit_trainer.fit(lit_module, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
    self.fit_loop.run()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
    self.advance()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
    self.advance(data_fetcher)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 212, in advance
    batch, _, __ = next(data_fetcher)
                   ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fetchers.py", line 133, in __next__
    batch = super().__next__()
            ^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/loops/fetchers.py", line 60, in __next__
    batch = next(self.iterator)
            ^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/utilities/combined_loader.py", line 341, in __next__
    out = next(self._iterator)
          ^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/utilities/combined_loader.py", line 78, in __next__
    out[i] = next(self.iterators[i])
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/_utils.py", line 722, in reraise
    raise exception
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
           ^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/local/gerum/hannah/hannah/datasets/vision/base.py", line 107, in __getitem__
    transformed = self.transform(image=image)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 256, in __call__
    data = t(**data)
           ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/composition.py", line 256, in __call__
    data = t(**data)
           ^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/transforms_interface.py", line 97, in __call__
    return self.apply_with_params(params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/transforms_interface.py", line 108, in apply_with_params
    res[key] = target_function(arg, **params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/transforms.py", line 1334, in apply
    return F.equalize(img, mode=self.mode, by_channels=self.by_channels, mask=mask)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/utils.py", line 124, in wrapped_function
    result = func(img, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/functional.py", line 423, in equalize
    _check_preconditions(img, mask, by_channels)
  File "/local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/augmentations/functional.py", line 391, in _check_preconditions
    raise TypeError(msg)
TypeError: Image must have uint8 channel type

[2024-05-23 17:14:25,983][hannah.utils.utils][INFO] - Environment info:
[2024-05-23 17:14:26,092][hannah.utils.utils][INFO] -   Number of GPUs: 2
[2024-05-23 17:14:26,093][hannah.utils.utils][INFO] -   CUDA version: 12.1
[2024-05-23 17:14:26,096][hannah.utils.utils][INFO] -   CUDNN version: 8907
[2024-05-23 17:14:26,096][hannah.utils.utils][INFO] -   Kernel: 4.18.0-513.24.1.el8_9.x86_64
[2024-05-23 17:14:26,096][hannah.utils.utils][INFO] -   Python: 3.11.5 (main, Nov 15 2023, 03:52:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)]
[2024-05-23 17:14:26,096][hannah.utils.utils][INFO] -   PyTorch: 2.2.2+cu121
[2024-05-23 17:14:26,097][hannah.utils.utils][INFO] -   Pytorch Lightning: 2.2.4
[2024-05-23 17:14:26,097][hannah.utils.utils][INFO] -   Numpy: 1.26.4
[2024-05-23 17:14:26,097][hannah.utils.utils][INFO] -   Hannah version info:
[2024-05-23 17:14:26,098][hannah.utils.utils][INFO] -     Cannot find a Git repository.  You probably downloaded an archive
[2024-05-23 17:14:26,098][hannah.utils.utils][INFO] -   Command line: /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/bin/hannah-train dataset.data_folder=/data module.num_workers=64 module.batch_size=128 dataset.downsampling.enabled=False
[2024-05-23 17:14:26,098][hannah.utils.utils][INFO] -   
[2024-05-23 17:14:26,099][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-23 17:14:26,101][root][INFO] - Configuration: 
[2024-05-23 17:14:26,104][root][INFO] - dataset:
  sensor:
    name: naneye-m
    resolution:
    - 320
    - 320
  cls: hannah.datasets.vision.DresdenCapsuleDataset
  data_folder: /data
  download_folder: MISSING
  dataset: dresden_capsule
  sampler: random
  weighted_loss: false
  task: sections
  split: split_0
  downsampling:
    enabled: false
    ratio:
      binary: 1
      sections:
      - 1
      - 1
      - 0.05
      - 0.01
      - 0.005
      technical_multilabel_bubbles_dirt:
      - 1
      - 1
      technical_multiclass_view:
      - 1
      - 1
      - 1
    anomalies_fraction: 0.3
  seed: 1234
features:
  _target_: torch.nn.Identity
model:
  _target_: hannah.models.timm.TimmModel
  name: mobilenetv3_small_075
  drop_rate: 0.3
  drop_path_rate: 0.2
scheduler:
  _target_: torch.optim.lr_scheduler.OneCycleLR
  max_lr: 0.001
  pct_start: 0.3
  anneal_strategy: cos
  cycle_momentum: true
  base_momentum: 0.85
  max_momentum: 0.95
  div_factor: 25.0
  final_div_factor: 10000.0
  last_epoch: -1
optimizer:
  _target_: torch.optim.adamw.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  weight_decay: 1.0e-05
  amsgrad: false
module:
  _target_: hannah.modules.vision.ImageClassifierModule
  num_workers: 64
  batch_size: 128
  shuffle_all_dataloaders: false
trainer:
  _target_: pytorch_lightning.trainer.Trainer
  accelerator: auto
  devices: 1
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  max_epochs: 15
  default_root_dir: .
  fast_dev_run: false
  overfit_batches: 0.0
  benchmark: false
  deterministic: warn
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  plugins: null
  strategy: auto
  reload_dataloaders_every_n_epochs: 0
  precision: 32
checkpoint:
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: checkpoints
  save_top_k: 1
  verbose: true
  monitor: val_error
  mode: min
  save_last: true
experiment_id: test
output_dir: trained_models
auto_lr: false
resume: false
fx_mac_summary: false
skip_test: false
skip_val: false
seed:
- 1234
validate_output: false

[2024-05-23 17:14:26,104][root][INFO] - Current working directory /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075
[2024-05-23 17:14:26,834][hannah.callbacks.optimization][INFO] - Monitoring the following values for optimization
[2024-05-23 17:14:26,834][hannah.callbacks.optimization][INFO] -   - val_error direction: minimize(1)
[2024-05-23 17:14:26,933][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-05-23 17:14:26,933][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-05-23 17:14:26,934][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-05-23 17:14:26,934][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-05-23 17:14:26,934][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
[2024-05-23 17:14:26,934][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-23 17:14:26,934][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
[2024-05-23 17:14:26,934][root][INFO] - Starting training
[2024-05-23 17:14:49,011][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/albumentations/core/validation.py:34: UserWarning: Argument 'limit' is not valid and will be ignored.
  warn(

[2024-05-23 17:14:49,059][py.warnings][WARNING] - /local/gerum/hannah/hannah/modules/vision/base.py:63: UserWarning: Vision datasets should return a length 4 tuple, will assume unlabeled data is None
  warnings.warn(

[2024-05-23 17:14:49,059][hannah.modules.vision.base][INFO] - Dataset lengths:
[2024-05-23 17:14:49,059][hannah.modules.vision.base][INFO] -   Train Set (Labeled): 2616647
[2024-05-23 17:14:49,059][hannah.modules.vision.base][INFO] -   Train Set (Unlabled): 0
[2024-05-23 17:14:49,059][hannah.modules.vision.base][INFO] -   Dev Set: 662338
[2024-05-23 17:14:49,059][hannah.modules.vision.base][INFO] -   Test Set: 234555
[2024-05-23 17:14:49,077][hannah.modules.vision.base][INFO] - Setting up model mobilenetv3_small_075
[2024-05-23 17:14:49,240][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:803: UserWarning: Overwriting focalnet_tiny_srf in registry with hannah.models._vendor.focalnet.focalnet_tiny_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:14:49,240][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:824: UserWarning: Overwriting focalnet_small_srf in registry with hannah.models._vendor.focalnet.focalnet_small_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:14:49,240][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:843: UserWarning: Overwriting focalnet_base_srf in registry with hannah.models._vendor.focalnet.focalnet_base_srf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:14:49,241][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:862: UserWarning: Overwriting focalnet_tiny_lrf in registry with hannah.models._vendor.focalnet.focalnet_tiny_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:14:49,241][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:885: UserWarning: Overwriting focalnet_small_lrf in registry with hannah.models._vendor.focalnet.focalnet_small_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:14:49,241][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:906: UserWarning: Overwriting focalnet_base_lrf in registry with hannah.models._vendor.focalnet.focalnet_base_lrf. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:14:49,241][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1010: UserWarning: Overwriting focalnet_large_fl3 in registry with hannah.models._vendor.focalnet.focalnet_large_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:14:49,241][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1031: UserWarning: Overwriting focalnet_large_fl4 in registry with hannah.models._vendor.focalnet.focalnet_large_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:14:49,241][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1052: UserWarning: Overwriting focalnet_xlarge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:14:49,241][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1073: UserWarning: Overwriting focalnet_xlarge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_xlarge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:14:49,241][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1094: UserWarning: Overwriting focalnet_huge_fl3 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl3. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:14:49,241][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/_vendor/focalnet.py:1115: UserWarning: Overwriting focalnet_huge_fl4 in registry with hannah.models._vendor.focalnet.focalnet_huge_fl4. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  @register_model

[2024-05-23 17:14:49,265][hannah.models.timm][INFO] - Using default logger for automatic stem creation
[2024-05-23 17:14:49,294][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib64/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '

[2024-05-23 17:14:49,484][hannah.modules.vision.base][INFO] - Instantiating input Normalizer with mean: (0.5, 0.5, 0.5), std: (0.5, 0.5, 0.5)
[2024-05-23 17:14:49,488][hannah.modules.vision.base][INFO] - Running dummy forward to initialize lazy modules
[2024-05-23 17:14:49,513][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-23 17:14:49,528][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-05-23 17:14:51,646][pytorch_lightning.callbacks.model_summary][INFO] - 
  | Name           | Type                           | Params | In sizes         | Out sizes                            
-----------------------------------------------------------------------------------------------------------------------------
0 | val_metrics    | MetricCollection               | 0      | ?                | ?                                    
1 | test_metrics   | MetricCollection               | 0      | ?                | ?                                    
2 | train_metrics  | MetricCollection               | 0      | ?                | ?                                    
3 | model          | TimmModel                      | 1.0 M  | [1, 3, 320, 320] | [[1, 1024, 10, 10], [0], [0], [1, 5]]
4 | test_confusion | MulticlassConfusionMatrix      | 0      | ?                | ?                                    
5 | test_roc       | MulticlassROC                  | 0      | ?                | ?                                    
6 | test_pr_curve  | MulticlassPrecisionRecallCurve | 0      | ?                | ?                                    
7 | metrics        | ModuleDict                     | 0      | ?                | ?                                    
-----------------------------------------------------------------------------------------------------------------------------
1.0 M     Trainable params
0         Non-trainable params
1.0 M     Total params
4.088     Total estimated model params size (MB)
[2024-05-23 17:14:51,944][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-23 17:14:51,944][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-23 17:14:51,946][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-23 17:15:17,448][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-23 17:15:17,450][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-23 17:15:17,450][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-23 17:15:17,450][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-23 17:15:17,450][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-23 17:44:32,494][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 20442: 'val_error' reached 0.22296 (best 0.22296), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=0-step=20442.ckpt' as top 1
[2024-05-23 18:16:51,861][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 40884: 'val_error' reached 0.16428 (best 0.16428), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=1-step=40884.ckpt' as top 1
[2024-05-23 18:48:50,906][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 61326: 'val_error' reached 0.12792 (best 0.12792), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=2-step=61326.ckpt' as top 1
[2024-05-23 19:21:35,763][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 81768: 'val_error' was not in top 1
[2024-05-23 19:55:15,294][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 102210: 'val_error' was not in top 1
[2024-05-23 20:27:59,028][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 122652: 'val_error' was not in top 1
[2024-05-23 21:01:01,640][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 143094: 'val_error' reached 0.12524 (best 0.12524), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=6-step=143094.ckpt' as top 1
[2024-05-23 21:34:37,582][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 163536: 'val_error' was not in top 1
[2024-05-23 22:07:22,921][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 183978: 'val_error' was not in top 1
[2024-05-23 22:41:20,361][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 204420: 'val_error' reached 0.11986 (best 0.11986), saving model to '/local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=9-step=204420.ckpt' as top 1
[2024-05-23 23:14:07,136][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 224862: 'val_error' was not in top 1
[2024-05-23 23:47:56,024][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 245304: 'val_error' was not in top 1
[2024-05-24 00:20:45,390][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 265746: 'val_error' was not in top 1
[2024-05-24 00:54:04,289][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 286188: 'val_error' was not in top 1
[2024-05-24 01:27:23,670][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 306630: 'val_error' was not in top 1
[2024-05-24 01:27:23,729][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer.fit` stopped: `max_epochs=15` reached.
[2024-05-24 01:27:26,253][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-24 01:27:26,262][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.validate(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.validate(ckpt_path='best')` to use the best model or `.validate(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-24 01:27:26,264][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=9-step=204420.ckpt
[2024-05-24 01:27:26,301][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-24 01:27:26,527][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-24 01:27:26,528][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-24 01:27:26,529][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-24 01:27:27,027][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=9-step=204420.ckpt
[2024-05-24 01:33:27,274][lightning.fabric.utilities.seed][INFO] - Seed set to 1234
[2024-05-24 01:33:27,275][py.warnings][WARNING] - /local/gerum/.cache/pypoetry/virtualenvs/hannah-8Yp6PnCx-py3.11/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/checkpoint_connector.py:145: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `.test(ckpt_path='best')` to use the best model or `.test(ckpt_path='last')` to use the last model. If you pass a value, this warning will be silenced.

[2024-05-24 01:33:27,276][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=9-step=204420.ckpt
[2024-05-24 01:33:27,309][pytorch_lightning.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[2024-05-24 01:33:27,543][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  decoded = torch.tensor([])

[2024-05-24 01:33:27,543][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:316: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  logits = torch.tensor([])

[2024-05-24 01:33:27,545][py.warnings][WARNING] - /local/gerum/hannah/hannah/models/timm.py:320: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  projection = torch.tensor([])

[2024-05-24 01:33:28,045][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /local/gerum/hannah/experiments/dresden_capsule/trained_models/test/mobilenetv3_small_075/checkpoints/epoch=9-step=204420.ckpt
[2024-05-24 01:35:42,666][hannah.callbacks.summaries][INFO] - 
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
|     | Name                              | Type                   | Attrs                                             | IFM               |   IFM volume | OFM               |   OFM volume |   Weights volume |     MACs |
|-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------|
|   0 | encoder.conv_stem                 | Conv2d                 | k=(3, 3), s=(2, 2), g=(1), dsc=(False), d=(1, 1)  | (1, 3, 320, 320)  |       307200 | (1, 16, 160, 160) |       409600 |              432 | 11059200 |
|   1 | encoder.bn1.drop                  | Identity               |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   2 | encoder.bn1.act                   | Hardswish              |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   3 | encoder.bn1                       | BatchNormAct2d         |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 160, 160) |       409600 |                0 |        0 |
|   4 | encoder.blocks.0.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(16), dsc=(True), d=(1, 1)  | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |              144 |   921600 |
|   5 | encoder.blocks.0.0.bn1.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   6 | encoder.blocks.0.0.bn1.act        | ReLU                   |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   7 | encoder.blocks.0.0.bn1            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|   8 | encoder.blocks.0.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 1, 1)     |           16 | (1, 8, 1, 1)      |            8 |              128 |      128 |
|   9 | encoder.blocks.0.0.se.act1        | ReLU                   |                                                   | (1, 8, 1, 1)      |            8 | (1, 8, 1, 1)      |            8 |                0 |        0 |
|  10 | encoder.blocks.0.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 8, 1, 1)      |            8 | (1, 16, 1, 1)     |           16 |              128 |      128 |
|  11 | encoder.blocks.0.0.se.gate        | Hardsigmoid            |                                                   | (1, 16, 1, 1)     |           16 | (1, 16, 1, 1)     |           16 |                0 |        0 |
|  12 | encoder.blocks.0.0.se             | SqueezeExcite          |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  13 | encoder.blocks.0.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |              256 |  1638400 |
|  14 | encoder.blocks.0.0.bn2.drop       | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  15 | encoder.blocks.0.0.bn2.act        | Identity               |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  16 | encoder.blocks.0.0.bn2            | BatchNormAct2d         |                                                   | (1, 16, 80, 80)   |       102400 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  17 | encoder.blocks.0.0                | DepthwiseSeparableConv |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  18 | encoder.blocks.0                  | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 16, 80, 80)   |       102400 |                0 |        0 |
|  19 | encoder.blocks.1.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 16, 80, 80)   |       102400 | (1, 72, 80, 80)   |       460800 |             1152 |  7372800 |
|  20 | encoder.blocks.1.0.bn1.drop       | Identity               |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  21 | encoder.blocks.1.0.bn1.act        | ReLU                   |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  22 | encoder.blocks.1.0.bn1            | BatchNormAct2d         |                                                   | (1, 72, 80, 80)   |       460800 | (1, 72, 80, 80)   |       460800 |                0 |        0 |
|  23 | encoder.blocks.1.0.conv_dw        | Conv2d                 | k=(3, 3), s=(2, 2), g=(72), dsc=(True), d=(1, 1)  | (1, 72, 80, 80)   |       460800 | (1, 72, 40, 40)   |       115200 |              648 |  1036800 |
|  24 | encoder.blocks.1.0.bn2.drop       | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  25 | encoder.blocks.1.0.bn2.act        | ReLU                   |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  26 | encoder.blocks.1.0.bn2            | BatchNormAct2d         |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  27 | encoder.blocks.1.0.se             | Identity               |                                                   | (1, 72, 40, 40)   |       115200 | (1, 72, 40, 40)   |       115200 |                0 |        0 |
|  28 | encoder.blocks.1.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 40, 40)   |       115200 | (1, 24, 40, 40)   |        38400 |             1728 |  2764800 |
|  29 | encoder.blocks.1.0.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  30 | encoder.blocks.1.0.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  31 | encoder.blocks.1.0.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  32 | encoder.blocks.1.0                | InvertedResidual       |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  33 | encoder.blocks.1.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 88, 40, 40)   |       140800 |             2112 |  3379200 |
|  34 | encoder.blocks.1.1.bn1.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  35 | encoder.blocks.1.1.bn1.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  36 | encoder.blocks.1.1.bn1            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  37 | encoder.blocks.1.1.conv_dw        | Conv2d                 | k=(3, 3), s=(1, 1), g=(88), dsc=(True), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |              792 |  1267200 |
|  38 | encoder.blocks.1.1.bn2.drop       | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  39 | encoder.blocks.1.1.bn2.act        | ReLU                   |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  40 | encoder.blocks.1.1.bn2            | BatchNormAct2d         |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  41 | encoder.blocks.1.1.se             | Identity               |                                                   | (1, 88, 40, 40)   |       140800 | (1, 88, 40, 40)   |       140800 |                0 |        0 |
|  42 | encoder.blocks.1.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 88, 40, 40)   |       140800 | (1, 24, 40, 40)   |        38400 |             2112 |  3379200 |
|  43 | encoder.blocks.1.1.bn3.drop       | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  44 | encoder.blocks.1.1.bn3.act        | Identity               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  45 | encoder.blocks.1.1.bn3            | BatchNormAct2d         |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  46 | encoder.blocks.1.1.drop_path      | DropPath               |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  47 | encoder.blocks.1.1                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  48 | encoder.blocks.1                  | Sequential             |                                                   | (1, 16, 80, 80)   |       102400 | (1, 24, 40, 40)   |        38400 |                0 |        0 |
|  49 | encoder.blocks.2.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 40, 40)   |        38400 | (1, 96, 40, 40)   |       153600 |             2304 |  3686400 |
|  50 | encoder.blocks.2.0.bn1.drop       | Identity               |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  51 | encoder.blocks.2.0.bn1.act        | Hardswish              |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  52 | encoder.blocks.2.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 40, 40)   |       153600 | (1, 96, 40, 40)   |       153600 |                0 |        0 |
|  53 | encoder.blocks.2.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 40, 40)   |       153600 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
|  54 | encoder.blocks.2.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  55 | encoder.blocks.2.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  56 | encoder.blocks.2.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  57 | encoder.blocks.2.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
|  58 | encoder.blocks.2.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
|  59 | encoder.blocks.2.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
|  60 | encoder.blocks.2.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
|  61 | encoder.blocks.2.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
|  62 | encoder.blocks.2.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 32, 20, 20)   |        12800 |             3072 |  1228800 |
|  63 | encoder.blocks.2.0.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  64 | encoder.blocks.2.0.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  65 | encoder.blocks.2.0.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  66 | encoder.blocks.2.0                | InvertedResidual       |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  67 | encoder.blocks.2.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  68 | encoder.blocks.2.1.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  69 | encoder.blocks.2.1.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  70 | encoder.blocks.2.1.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  71 | encoder.blocks.2.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  72 | encoder.blocks.2.1.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  73 | encoder.blocks.2.1.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  74 | encoder.blocks.2.1.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  75 | encoder.blocks.2.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  76 | encoder.blocks.2.1.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  77 | encoder.blocks.2.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  78 | encoder.blocks.2.1.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  79 | encoder.blocks.2.1.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  80 | encoder.blocks.2.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
|  81 | encoder.blocks.2.1.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  82 | encoder.blocks.2.1.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  83 | encoder.blocks.2.1.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  84 | encoder.blocks.2.1.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  85 | encoder.blocks.2.1                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
|  86 | encoder.blocks.2.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 192, 20, 20)  |        76800 |             6144 |  2457600 |
|  87 | encoder.blocks.2.2.bn1.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  88 | encoder.blocks.2.2.bn1.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  89 | encoder.blocks.2.2.bn1            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  90 | encoder.blocks.2.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(192), dsc=(True), d=(1, 1) | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |             4800 |  1920000 |
|  91 | encoder.blocks.2.2.bn2.drop       | Identity               |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  92 | encoder.blocks.2.2.bn2.act        | Hardswish              |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  93 | encoder.blocks.2.2.bn2            | BatchNormAct2d         |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  94 | encoder.blocks.2.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 1, 1)    |          192 | (1, 48, 1, 1)     |           48 |             9216 |     9216 |
|  95 | encoder.blocks.2.2.se.act1        | ReLU                   |                                                   | (1, 48, 1, 1)     |           48 | (1, 48, 1, 1)     |           48 |                0 |        0 |
|  96 | encoder.blocks.2.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 48, 1, 1)     |           48 | (1, 192, 1, 1)    |          192 |             9216 |     9216 |
|  97 | encoder.blocks.2.2.se.gate        | Hardsigmoid            |                                                   | (1, 192, 1, 1)    |          192 | (1, 192, 1, 1)    |          192 |                0 |        0 |
|  98 | encoder.blocks.2.2.se             | SqueezeExcite          |                                                   | (1, 192, 20, 20)  |        76800 | (1, 192, 20, 20)  |        76800 |                0 |        0 |
|  99 | encoder.blocks.2.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 192, 20, 20)  |        76800 | (1, 32, 20, 20)   |        12800 |             6144 |  2457600 |
| 100 | encoder.blocks.2.2.bn3.drop       | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 101 | encoder.blocks.2.2.bn3.act        | Identity               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 102 | encoder.blocks.2.2.bn3            | BatchNormAct2d         |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 103 | encoder.blocks.2.2.drop_path      | DropPath               |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 104 | encoder.blocks.2.2                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 105 | encoder.blocks.2                  | Sequential             |                                                   | (1, 24, 40, 40)   |        38400 | (1, 32, 20, 20)   |        12800 |                0 |        0 |
| 106 | encoder.blocks.3.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 20, 20)   |        12800 | (1, 96, 20, 20)   |        38400 |             3072 |  1228800 |
| 107 | encoder.blocks.3.0.bn1.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 108 | encoder.blocks.3.0.bn1.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 109 | encoder.blocks.3.0.bn1            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 110 | encoder.blocks.3.0.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(96), dsc=(True), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |             2400 |   960000 |
| 111 | encoder.blocks.3.0.bn2.drop       | Identity               |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 112 | encoder.blocks.3.0.bn2.act        | Hardswish              |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 113 | encoder.blocks.3.0.bn2            | BatchNormAct2d         |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 114 | encoder.blocks.3.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 1, 1)     |           96 | (1, 24, 1, 1)     |           24 |             2304 |     2304 |
| 115 | encoder.blocks.3.0.se.act1        | ReLU                   |                                                   | (1, 24, 1, 1)     |           24 | (1, 24, 1, 1)     |           24 |                0 |        0 |
| 116 | encoder.blocks.3.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 24, 1, 1)     |           24 | (1, 96, 1, 1)     |           96 |             2304 |     2304 |
| 117 | encoder.blocks.3.0.se.gate        | Hardsigmoid            |                                                   | (1, 96, 1, 1)     |           96 | (1, 96, 1, 1)     |           96 |                0 |        0 |
| 118 | encoder.blocks.3.0.se             | SqueezeExcite          |                                                   | (1, 96, 20, 20)   |        38400 | (1, 96, 20, 20)   |        38400 |                0 |        0 |
| 119 | encoder.blocks.3.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 96, 20, 20)   |        38400 | (1, 40, 20, 20)   |        16000 |             3840 |  1536000 |
| 120 | encoder.blocks.3.0.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 121 | encoder.blocks.3.0.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 122 | encoder.blocks.3.0.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 123 | encoder.blocks.3.0                | InvertedResidual       |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 124 | encoder.blocks.3.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 120, 20, 20)  |        48000 |             4800 |  1920000 |
| 125 | encoder.blocks.3.1.bn1.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 126 | encoder.blocks.3.1.bn1.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 127 | encoder.blocks.3.1.bn1            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 128 | encoder.blocks.3.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(120), dsc=(True), d=(1, 1) | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |             3000 |  1200000 |
| 129 | encoder.blocks.3.1.bn2.drop       | Identity               |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 130 | encoder.blocks.3.1.bn2.act        | Hardswish              |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 131 | encoder.blocks.3.1.bn2            | BatchNormAct2d         |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 132 | encoder.blocks.3.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 1, 1)    |          120 | (1, 32, 1, 1)     |           32 |             3840 |     3840 |
| 133 | encoder.blocks.3.1.se.act1        | ReLU                   |                                                   | (1, 32, 1, 1)     |           32 | (1, 32, 1, 1)     |           32 |                0 |        0 |
| 134 | encoder.blocks.3.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 32, 1, 1)     |           32 | (1, 120, 1, 1)    |          120 |             3840 |     3840 |
| 135 | encoder.blocks.3.1.se.gate        | Hardsigmoid            |                                                   | (1, 120, 1, 1)    |          120 | (1, 120, 1, 1)    |          120 |                0 |        0 |
| 136 | encoder.blocks.3.1.se             | SqueezeExcite          |                                                   | (1, 120, 20, 20)  |        48000 | (1, 120, 20, 20)  |        48000 |                0 |        0 |
| 137 | encoder.blocks.3.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 120, 20, 20)  |        48000 | (1, 40, 20, 20)   |        16000 |             4800 |  1920000 |
| 138 | encoder.blocks.3.1.bn3.drop       | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 139 | encoder.blocks.3.1.bn3.act        | Identity               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 140 | encoder.blocks.3.1.bn3            | BatchNormAct2d         |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 141 | encoder.blocks.3.1.drop_path      | DropPath               |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 142 | encoder.blocks.3.1                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 143 | encoder.blocks.3                  | Sequential             |                                                   | (1, 32, 20, 20)   |        12800 | (1, 40, 20, 20)   |        16000 |                0 |        0 |
| 144 | encoder.blocks.4.0.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 40, 20, 20)   |        16000 | (1, 240, 20, 20)  |        96000 |             9600 |  3840000 |
| 145 | encoder.blocks.4.0.bn1.drop       | Identity               |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 146 | encoder.blocks.4.0.bn1.act        | Hardswish              |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 147 | encoder.blocks.4.0.bn1            | BatchNormAct2d         |                                                   | (1, 240, 20, 20)  |        96000 | (1, 240, 20, 20)  |        96000 |                0 |        0 |
| 148 | encoder.blocks.4.0.conv_dw        | Conv2d                 | k=(5, 5), s=(2, 2), g=(240), dsc=(True), d=(1, 1) | (1, 240, 20, 20)  |        96000 | (1, 240, 10, 10)  |        24000 |             6000 |   600000 |
| 149 | encoder.blocks.4.0.bn2.drop       | Identity               |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 150 | encoder.blocks.4.0.bn2.act        | Hardswish              |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 151 | encoder.blocks.4.0.bn2            | BatchNormAct2d         |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 152 | encoder.blocks.4.0.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 1, 1)    |          240 | (1, 64, 1, 1)     |           64 |            15360 |    15360 |
| 153 | encoder.blocks.4.0.se.act1        | ReLU                   |                                                   | (1, 64, 1, 1)     |           64 | (1, 64, 1, 1)     |           64 |                0 |        0 |
| 154 | encoder.blocks.4.0.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 64, 1, 1)     |           64 | (1, 240, 1, 1)    |          240 |            15360 |    15360 |
| 155 | encoder.blocks.4.0.se.gate        | Hardsigmoid            |                                                   | (1, 240, 1, 1)    |          240 | (1, 240, 1, 1)    |          240 |                0 |        0 |
| 156 | encoder.blocks.4.0.se             | SqueezeExcite          |                                                   | (1, 240, 10, 10)  |        24000 | (1, 240, 10, 10)  |        24000 |                0 |        0 |
| 157 | encoder.blocks.4.0.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 240, 10, 10)  |        24000 | (1, 72, 10, 10)   |         7200 |            17280 |  1728000 |
| 158 | encoder.blocks.4.0.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 159 | encoder.blocks.4.0.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 160 | encoder.blocks.4.0.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 161 | encoder.blocks.4.0                | InvertedResidual       |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 162 | encoder.blocks.4.1.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 163 | encoder.blocks.4.1.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 164 | encoder.blocks.4.1.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 165 | encoder.blocks.4.1.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 166 | encoder.blocks.4.1.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 167 | encoder.blocks.4.1.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 168 | encoder.blocks.4.1.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 169 | encoder.blocks.4.1.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 170 | encoder.blocks.4.1.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 171 | encoder.blocks.4.1.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 172 | encoder.blocks.4.1.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 173 | encoder.blocks.4.1.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 174 | encoder.blocks.4.1.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 175 | encoder.blocks.4.1.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 176 | encoder.blocks.4.1.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 177 | encoder.blocks.4.1.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 178 | encoder.blocks.4.1.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 179 | encoder.blocks.4.1.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 180 | encoder.blocks.4.1                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 181 | encoder.blocks.4.2.conv_pw        | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 182 | encoder.blocks.4.2.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 183 | encoder.blocks.4.2.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 184 | encoder.blocks.4.2.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 185 | encoder.blocks.4.2.conv_dw        | Conv2d                 | k=(5, 5), s=(1, 1), g=(432), dsc=(True), d=(1, 1) | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |            10800 |  1080000 |
| 186 | encoder.blocks.4.2.bn2.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 187 | encoder.blocks.4.2.bn2.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 188 | encoder.blocks.4.2.bn2            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 189 | encoder.blocks.4.2.se.conv_reduce | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 1, 1)    |          432 | (1, 112, 1, 1)    |          112 |            48384 |    48384 |
| 190 | encoder.blocks.4.2.se.act1        | ReLU                   |                                                   | (1, 112, 1, 1)    |          112 | (1, 112, 1, 1)    |          112 |                0 |        0 |
| 191 | encoder.blocks.4.2.se.conv_expand | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 112, 1, 1)    |          112 | (1, 432, 1, 1)    |          432 |            48384 |    48384 |
| 192 | encoder.blocks.4.2.se.gate        | Hardsigmoid            |                                                   | (1, 432, 1, 1)    |          432 | (1, 432, 1, 1)    |          432 |                0 |        0 |
| 193 | encoder.blocks.4.2.se             | SqueezeExcite          |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 194 | encoder.blocks.4.2.conv_pwl       | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 72, 10, 10)   |         7200 |            31104 |  3110400 |
| 195 | encoder.blocks.4.2.bn3.drop       | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 196 | encoder.blocks.4.2.bn3.act        | Identity               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 197 | encoder.blocks.4.2.bn3            | BatchNormAct2d         |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 198 | encoder.blocks.4.2.drop_path      | DropPath               |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 199 | encoder.blocks.4.2                | InvertedResidual       |                                                   | (1, 72, 10, 10)   |         7200 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 200 | encoder.blocks.4                  | Sequential             |                                                   | (1, 40, 20, 20)   |        16000 | (1, 72, 10, 10)   |         7200 |                0 |        0 |
| 201 | encoder.blocks.5.0.conv           | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |            31104 |  3110400 |
| 202 | encoder.blocks.5.0.bn1.drop       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 203 | encoder.blocks.5.0.bn1.act        | Hardswish              |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 204 | encoder.blocks.5.0.bn1            | BatchNormAct2d         |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 205 | encoder.blocks.5.0                | ConvBnAct              |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 206 | encoder.blocks.5                  | Sequential             |                                                   | (1, 72, 10, 10)   |         7200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 207 | encoder.blocks                    | Sequential             |                                                   | (1, 16, 160, 160) |       409600 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 208 | encoder.global_pool.pool          | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 209 | encoder.global_pool.flatten       | Identity               |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 210 | encoder.global_pool               | SelectAdaptivePool2d   |                                                   | (1, 432, 10, 10)  |        43200 | (1, 432, 10, 10)  |        43200 |                0 |        0 |
| 211 | encoder.conv_head                 | Conv2d                 | k=(1, 1), s=(1, 1), g=(1), dsc=(False), d=(1, 1)  | (1, 432, 10, 10)  |        43200 | (1, 1024, 10, 10) |       102400 |           442368 | 44236800 |
| 212 | encoder.act2                      | Hardswish              |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 213 | encoder.flatten                   | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 214 | encoder.classifier                | Identity               |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 215 | encoder                           | MobileNetV3            |                                                   | (1, 3, 320, 320)  |       307200 | (1, 1024, 10, 10) |       102400 |                0 |        0 |
| 216 | classifier.pooling                | AdaptiveAvgPool2d      |                                                   | (1, 1024, 10, 10) |       102400 | (1, 1024, 1, 1)   |         1024 |                0 |        0 |
| 217 | classifier.flatten                | Flatten                |                                                   | (1, 1024, 1, 1)   |         1024 | (1, 1024)         |         1024 |                0 |        0 |
| 218 | classifier.linear                 | Linear                 |                                                   | (1, 1024)         |         1024 | (1, 5)            |            5 |             5120 |     5120 |
| 219 | classifier                        | DefaultClassifierHead  |                                                   | (1, 1024, 10, 10) |       102400 | (1, 5)            |            5 |                0 |        0 |
+-----+-----------------------------------+------------------------+---------------------------------------------------+-------------------+--------------+-------------------+--------------+------------------+----------+
[2024-05-24 01:35:42,667][hannah.callbacks.summaries][INFO] - Total MACs: 129,529,792
[2024-05-24 01:35:42,667][hannah.callbacks.summaries][INFO] - Total Weights: 1,009,000
[2024-05-24 01:35:42,667][hannah.callbacks.summaries][INFO] - Total Activations: 12,969,834
[2024-05-24 01:35:42,667][hannah.callbacks.summaries][INFO] - Estimated Activations: 921,600
[2024-05-24 01:35:43,427][hannah.train][INFO] - Averaged Result Metrics:
| Metric               |     Mean |   Std |   Count |
|----------------------|----------|-------|---------|
| test_classifier_loss | 0.58621  |     0 |       1 |
| test_accuracy        | 0.8699   |     0 |       1 |
| test_error           | 0.1301   |     0 |       1 |
| test_f1              | 0.666668 |     0 |       1 |
| test_precision       | 0.610315 |     0 |       1 |
| test_recall          | 0.779647 |     0 |       1 |
| test_loss            | 0.58621  |     0 |       1 |
[2024-05-24 01:35:43,443][hannah.train][INFO] - Averaged Result Metrics:
| Metric              |     Mean |   Std |   Count |
|---------------------|----------|-------|---------|
| val_classifier_loss | 0.752724 |     0 |       1 |
| val_accuracy        | 0.880137 |     0 |       1 |
| val_error           | 0.119863 |     0 |       1 |
| val_f1              | 0.701935 |     0 |       1 |
| val_precision       | 0.697302 |     0 |       1 |
| val_recall          | 0.718438 |     0 |       1 |
| val_loss            | 0.752724 |     0 |       1 |
